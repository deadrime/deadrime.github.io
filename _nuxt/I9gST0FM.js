import{e as L,aq as b,ad as N,J as A,R as O,at as R,ac as F,ar as U,c as M,o as C,a as B}from"./Dic0N_Gf.js";const q=500,H=20,K=300,V="https://stackblitz.com",S=["angular-cli","create-react-app","html","javascript","node","polymer","typescript","vue"],k=["project","search","ports","settings"],x=["light","dark"],W=["editor","preview"],j={clickToLoad:e=>u("ctl",e),devToolsHeight:e=>v("devtoolsheight",e),forceEmbedLayout:e=>u("embed",e),hideDevTools:e=>u("hidedevtools",e),hideExplorer:e=>u("hideExplorer",e),hideNavigation:e=>u("hideNavigation",e),openFile:e=>h("file",e),showSidebar:e=>G("showSidebar",e),sidebarView:e=>f("sidebarView",e,k),startScript:e=>h("startScript",e),terminalHeight:e=>v("terminalHeight",e),theme:e=>f("theme",e,x),view:e=>f("view",e,W),zenMode:e=>u("zenMode",e),organization:e=>`${h("orgName",e==null?void 0:e.name)}&${h("orgProvider",e==null?void 0:e.provider)}`,crossOriginIsolated:e=>u("corp",e)};function I(e={}){const t=Object.entries(e).map(([n,r])=>r!=null&&j.hasOwnProperty(n)?j[n](r):"").filter(Boolean);return t.length?`?${t.join("&")}`:""}function u(e,t){return t===!0?`${e}=1`:""}function G(e,t){return typeof t=="boolean"?`${e}=${t?"1":"0"}`:""}function v(e,t){if(typeof t=="number"&&!Number.isNaN(t)){const n=Math.min(100,Math.max(0,t));return`${e}=${encodeURIComponent(Math.round(n))}`}return""}function f(e,t="",n=[]){return n.includes(t)?`${e}=${encodeURIComponent(t)}`:""}function h(e,t){return(Array.isArray(t)?t:[t]).filter(r=>typeof r=="string"&&r.trim()!=="").map(r=>`${e}=${encodeURIComponent(r)}`).join("&")}function T(){return Math.random().toString(36).slice(2,6)+Math.random().toString(36).slice(2,6)}function g(e,t){return`${P(t)}${e}${I(t)}`}function w(e,t){const n={forceEmbedLayout:!0};return t&&typeof t=="object"&&Object.assign(n,t),`${P(n)}${e}${I(n)}`}function P(e={}){return(typeof e.origin=="string"?e.origin:V).replace(/\/$/,"")}function y(e,t,n){if(!t||!e||!e.parentNode)throw new Error("Invalid Element");e.id&&(t.id=e.id),e.className&&(t.className=e.className),z(t,n),J(e,t,n),e.replaceWith(t)}function _(e){if(typeof e=="string"){const t=document.getElementById(e);if(!t)throw new Error(`Could not find element with id '${e}'`);return t}else if(e instanceof HTMLElement)return e;throw new Error(`Invalid element: ${e}`)}function E(e){return e&&e.newWindow===!1?"_self":"_blank"}function z(e,t={}){const n=Object.hasOwnProperty.call(t,"height")?`${t.height}`:`${K}`,r=Object.hasOwnProperty.call(t,"width")?`${t.width}`:void 0;e.setAttribute("height",n),r?e.setAttribute("width",r):e.setAttribute("style","width:100%;")}function J(e,t,n={}){var o,i;const r=((i=(o=e.allow)==null?void 0:o.split(";"))==null?void 0:i.map(s=>s.trim()))??[];n.crossOriginIsolated&&!r.includes("cross-origin-isolated")&&r.push("cross-origin-isolated"),r.length>0&&(t.allow=r.join("; "))}class X{constructor(t){this.pending={},this.port=t,this.port.onmessage=this.messageListener.bind(this)}request({type:t,payload:n}){return new Promise((r,o)=>{const i=T();this.pending[i]={resolve:r,reject:o},this.port.postMessage({type:t,payload:{...n,__reqid:i}})})}messageListener(t){var c;if(typeof((c=t.data.payload)==null?void 0:c.__reqid)!="string")return;const{type:n,payload:r}=t.data,{__reqid:o,__success:i,__error:s}=r;this.pending[o]&&(i?this.pending[o].resolve(this.cleanResult(r)):this.pending[o].reject(s?`${n}: ${s}`:n),delete this.pending[o])}cleanResult(t){const n={...t};return delete n.__reqid,delete n.__success,delete n.__error,Object.keys(n).length?n:null}}class Y{constructor(t,n){this.editor={openFile:r=>this._rdc.request({type:"SDK_OPEN_FILE",payload:{path:r}}),setCurrentFile:r=>this._rdc.request({type:"SDK_SET_CURRENT_FILE",payload:{path:r}}),setTheme:r=>this._rdc.request({type:"SDK_SET_UI_THEME",payload:{theme:r}}),setView:r=>this._rdc.request({type:"SDK_SET_UI_VIEW",payload:{view:r}}),showSidebar:(r=!0)=>this._rdc.request({type:"SDK_TOGGLE_SIDEBAR",payload:{visible:r}})},this.preview={origin:"",getUrl:()=>this._rdc.request({type:"SDK_GET_PREVIEW_URL",payload:{}}).then(r=>(r==null?void 0:r.url)??null),setUrl:(r="/")=>{if(typeof r!="string"||!r.startsWith("/"))throw new Error(`Invalid argument: expected a path starting with '/', got '${r}'`);return this._rdc.request({type:"SDK_SET_PREVIEW_URL",payload:{path:r}})}},this._rdc=new X(t),Object.defineProperty(this.preview,"origin",{value:typeof n.previewOrigin=="string"?n.previewOrigin:null,writable:!1})}applyFsDiff(t){const n=r=>r!==null&&typeof r=="object";if(!n(t)||!n(t.create))throw new Error("Invalid diff object: expected diff.create to be an object.");if(!Array.isArray(t.destroy))throw new Error("Invalid diff object: expected diff.destroy to be an array.");return this._rdc.request({type:"SDK_APPLY_FS_DIFF",payload:t})}getDependencies(){return this._rdc.request({type:"SDK_GET_DEPS_SNAPSHOT",payload:{}})}getFsSnapshot(){return this._rdc.request({type:"SDK_GET_FS_SNAPSHOT",payload:{}})}}const p=[];class Q{constructor(t){this.id=T(),this.element=t,this.pending=new Promise((n,r)=>{const o=({data:a,ports:d})=>{(a==null?void 0:a.action)==="SDK_INIT_SUCCESS"&&a.id===this.id&&(this.vm=new Y(d[0],a.payload),n(this.vm),s())},i=()=>{var a;(a=this.element.contentWindow)==null||a.postMessage({action:"SDK_INIT",id:this.id},"*")};function s(){window.clearInterval(l),window.removeEventListener("message",o)}window.addEventListener("message",o),i();let c=0;const l=window.setInterval(()=>{if(this.vm){s();return}if(c>=H){s(),r("Timeout: Unable to establish a connection with the StackBlitz VM"),p.forEach((a,d)=>{a.id===this.id&&p.splice(d,1)});return}c++,i()},q)}),p.push(this)}}const Z=e=>{const t=e instanceof Element?"element":"id";return p.find(n=>n[t]===e)??null};function ee(e,t){const n=document.createElement("input");return n.type="hidden",n.name=e,n.value=t,n}function te(e){return e.replace(/\[/g,"%5B").replace(/\]/g,"%5D")}function $({template:e,title:t,description:n,dependencies:r,files:o,settings:i}){if(!S.includes(e)){const a=S.map(d=>`'${d}'`).join(", ");console.warn(`Unsupported project.template: must be one of ${a}`)}const s=[],c=(a,d,D="")=>{s.push(ee(a,typeof d=="string"?d:D))};c("project[title]",t),typeof n=="string"&&n.length>0&&c("project[description]",n),c("project[template]",e,"javascript"),r&&(e==="node"?console.warn("Invalid project.dependencies: dependencies must be provided as a 'package.json' file when using the 'node' template."):c("project[dependencies]",JSON.stringify(r))),i&&c("project[settings]",JSON.stringify(i)),Object.entries(o).forEach(([a,d])=>{c(`project[files][${te(a)}]`,d)});const l=document.createElement("form");return l.method="POST",l.setAttribute("style","display:none!important;"),l.append(...s),l}function ne(e,t){const n=$(e);return n.action=w("/run",t),n.id="sb_run",`<!doctype html>
<html>
<head><title></title></head>
<body>
  ${n.outerHTML}
  <script>document.getElementById('${n.id}').submit();<\/script>
</body>
</html>`}function re(e,t){const n=$(e);n.action=g("/run",t),n.target=E(t),document.body.appendChild(n),n.submit(),document.body.removeChild(n)}function m(e){return e!=null&&e.contentWindow?(Z(e)??new Q(e)).pending:Promise.reject("Provided element is not an iframe.")}function oe(e,t){re(e,t)}function ie(e,t){const n=g(`/edit/${e}`,t),r=E(t);window.open(n,r)}function se(e,t){const n=g(`/github/${e}`,t),r=E(t);window.open(n,r)}function ce(e,t,n){var s;const r=_(e),o=ne(t,n),i=document.createElement("iframe");return y(r,i,n),(s=i.contentDocument)==null||s.write(o),m(i)}function ae(e,t,n){const r=_(e),o=document.createElement("iframe");return o.src=w(`/edit/${t}`,n),y(r,o,n),m(o)}function de(e,t,n){const r=_(e),o=document.createElement("iframe");return o.src=w(`/github/${t}`,n),y(r,o,n),m(o)}const le={connect:m,embedGithubProject:de,embedProject:ce,embedProjectId:ae,openGithubProject:se,openProject:oe,openProjectId:ie},ue={ref:"wrapper",class:"w-full rounded-md overflow-hidden mt-3"},he={ref:"iframe"},me=L({__name:"CodeExample",props:{projectId:{},height:{default:400},width:{default:"100%"},hideNavigation:{type:Boolean},crossOriginIsolated:{type:Boolean},clickToLoad:{type:Boolean},devToolsHeight:{},forceEmbedLayout:{type:Boolean,default:!0},hideDevTools:{type:Boolean},hideExplorer:{type:Boolean},openFile:{},origin:{},organization:{},showSidebar:{type:Boolean},sidebarView:{},startScript:{},terminalHeight:{},theme:{},view:{default:"default"}},setup(e){const t=b("iframe"),n=b("wrapper"),{theme:r}=N("theme"),o=R(e,["projectId","forceEmbedLayout","view","height","width"]),i=A(null),s=()=>{if(!t.value||!n.value)return;n.value.querySelectorAll("iframe").forEach(l=>l.remove())};return O(async()=>{!t.value||!n.value||(s(),i.value=await le.embedProjectId(t.value,e.projectId,{...o,forceEmbedLayout:e.forceEmbedLayout,view:e.view,height:e.height,width:e.width,theme:r.value}))}),F(()=>{s()}),U(()=>{var c;i.value&&((c=i.value)==null||c.editor.setTheme(r.value))}),(c,l)=>(C(),M("div",ue,[B("div",he,null,512)],512))}});export{me as default};
