[{"data":1,"prerenderedAt":6015},["ShallowReactive",2],{"post_/blog/implementing-own-redux-toolkit":3,"surround/blog/implementing-own-redux-toolkit":6006},{"id":4,"title":5,"body":6,"date":5992,"description":5993,"extension":5994,"meta":5995,"navigation":91,"path":5996,"previewImg":5997,"seo":5998,"stem":5999,"topics":6000,"__hash__":6005},"articles/blog/implementing-own-redux-toolkit.md","Пишем свой redux-toolkit",{"type":7,"value":8,"toc":5982},"minimark",[9,14,38,67,71,74,629,633,639,1144,1147,1151,1160,1227,1230,1356,1359,1362,1365,1457,1460,1470,1476,1485,2201,2204,2213,2233,2236,2455,2462,2466,2478,2527,2545,2552,2632,2636,2643,2650,2653,2717,2724,2727,2758,2761,2772,2778,3000,3004,3011,3569,3614,3618,5324,5615,5692,5978],[10,11,13],"h2",{"id":12},"motivation","Мотивация",[15,16,17,18,22,23,26,27,30,31,26,34,37],"p",{},"Как правило мы задумываемся о глобальном стейте, когда приложение обрастает какой-то сложной бизнес логикой и прокидывать пропсы становится больно.\nВ случае с более менее легкой бизнес логикой можно обойтись ",[19,20,21],"code",{},"React Context",". Но когда уже не хватает и его - на помощь приходит стейт менеджер,\nнапример редакс. Обычно в качестве примера использования редакса показывают TODO лист, что на мой взгляд тупо - мне трудно представить\nсебе туду лист, который был бы достаточно сложен, что для него бы мог потребоваться глобальный стейт.\nСкорее вы будете хранить в стейте профиль авторизованного юзера или какие-то сложные структуры,\nкоторые нужно уметь находить разными способами, скажем ",[19,24,25],{},"profileById",", ",[19,28,29],{},"profileByUsername"," или ",[19,32,33],{},"noteIdsByWeekTs",[19,35,36],{},"noteIdsByDayTs",".",[15,39,40,41,49,50,54,55,58,59,62,63,66],{},"Глобальный стейт решает 3 основный задачи - хранить, записывать и доставать данные. Чем удобнее, тем лучше.\nRedux предлагает редьюсеры, экшены и селекторы для этих задач.\nЕсли говорить про ",[42,43,48],"a",{"href":44,"rel":45,"target":47},"https://redux.js.org/tutorials/fundamentals/part-3-state-actions-reducers",[46],"nofollow","_blank","стандартную реализацию",",\nто про про удобство говорить не приходится, switch case конструкция для экшенов - это боль.\nРазработчики редакса тоже так подумали и изобрели красивую обертку под названием ",[51,52,53],"strong",{},"Redux Toolkit.","\nОднако они умудрились превратить ",[51,56,57],{},"3.33 kB"," в ",[51,60,61],{},"37 kB"," и это наталкивает на мысль, что они напихали слишком много лишнего.\nВозможно, им следовало бы остановиться на методе ",[19,64,65],{},"createSlice",",\nкоторый позволяет создавать редьюсер и экшены без лишней головной боли, а так же хуке useSlectors.\nИменно эти вещи я и хочу реализовать самостоятельно. Это будет интересно еще и точки зрения типизации.",[10,68,70],{"id":69},"api","API",[15,72,73],{},"Для начала нужно прикинуть, что именно мы хотим получить на выходе.\nВ рамках данной статьи я хочу реализовать метод createSlice, где можно было бы создать экшены и селекторы,\nа так же useSelector для доступа к данным из реакт компонента и dispatch для вызова экшенов",[75,76,82],"pre",{"className":77,"code":78,"filename":79,"language":80,"meta":81,"style":81},"language-ts shiki shiki-themes github-light github-dark","\ntype User = {\n  id: string;\n  username: string;\n  displayName: string;\n}\n\nexport const usersSlice = createSlice({\n  name: 'users',\n  defaultState: {\n    userById: {} as Record\u003Cstring, User>,\n    usernameById: {} as Record\u003Cstring, string>,\n  },\n  actions: {\n    addUser: (state, user: User) => {\n      // state должен иметь тот же тип, что и defaultState\n      state.userById[user.id] = user;\n      state.usernameById[user.username] = user.id;\n    },\n    deleteUser: (state, userId: string) => {\n      const user = state.userById[userId];\n      delete state.usernameById[user.username];\n      delete state.userById[userId];\n    }\n  },\n  selectors: {\n    selectUserByUsername: (state, username: string) => state.userById[state.usernameById[username]],\n  }\n});\n\nusersSlice.actions;// экшены\nusersSlice.selectors;// селекторы\n\n// ...\n\n// SomeComponent.tsx\n\n// user Должен иметь тип User\nconst user = useSelector(state => state.selectUserByUsername(state.users, 'someUsername'));\n\nconst addUser = useCallback(() => {\n  dispatch(\n    // Аргументом addUser должен быть объект User\n    usersSlice.actions.addUser({\n      id: '2',\n      username: 'username2',\n      displayName: 'some display name',\n    })\n  );\n}, [dispatch]);\n","usersSlice.ts","ts","",[19,83,84,93,111,128,140,152,158,163,183,196,202,228,248,254,260,289,296,308,319,325,350,364,373,380,386,391,397,423,429,435,440,449,458,463,469,474,480,485,491,527,532,552,561,567,578,589,600,611,617,623],{"__ignoreMap":81},[85,86,89],"span",{"class":87,"line":88},"line",1,[85,90,92],{"emptyLinePlaceholder":91},true,"\n",[85,94,96,100,104,107],{"class":87,"line":95},2,[85,97,99],{"class":98},"szBVR","type",[85,101,103],{"class":102},"sScJk"," User",[85,105,106],{"class":98}," =",[85,108,110],{"class":109},"sVt8B"," {\n",[85,112,114,118,121,125],{"class":87,"line":113},3,[85,115,117],{"class":116},"s4XuR","  id",[85,119,120],{"class":98},":",[85,122,124],{"class":123},"sj4cs"," string",[85,126,127],{"class":109},";\n",[85,129,131,134,136,138],{"class":87,"line":130},4,[85,132,133],{"class":116},"  username",[85,135,120],{"class":98},[85,137,124],{"class":123},[85,139,127],{"class":109},[85,141,143,146,148,150],{"class":87,"line":142},5,[85,144,145],{"class":116},"  displayName",[85,147,120],{"class":98},[85,149,124],{"class":123},[85,151,127],{"class":109},[85,153,155],{"class":87,"line":154},6,[85,156,157],{"class":109},"}\n",[85,159,161],{"class":87,"line":160},7,[85,162,92],{"emptyLinePlaceholder":91},[85,164,166,169,172,175,177,180],{"class":87,"line":165},8,[85,167,168],{"class":98},"export",[85,170,171],{"class":98}," const",[85,173,174],{"class":123}," usersSlice",[85,176,106],{"class":98},[85,178,179],{"class":102}," createSlice",[85,181,182],{"class":109},"({\n",[85,184,186,189,193],{"class":87,"line":185},9,[85,187,188],{"class":109},"  name: ",[85,190,192],{"class":191},"sZZnC","'users'",[85,194,195],{"class":109},",\n",[85,197,199],{"class":87,"line":198},10,[85,200,201],{"class":109},"  defaultState: {\n",[85,203,205,208,211,214,217,220,222,225],{"class":87,"line":204},11,[85,206,207],{"class":109},"    userById: {} ",[85,209,210],{"class":98},"as",[85,212,213],{"class":102}," Record",[85,215,216],{"class":109},"\u003C",[85,218,219],{"class":123},"string",[85,221,26],{"class":109},[85,223,224],{"class":102},"User",[85,226,227],{"class":109},">,\n",[85,229,231,234,236,238,240,242,244,246],{"class":87,"line":230},12,[85,232,233],{"class":109},"    usernameById: {} ",[85,235,210],{"class":98},[85,237,213],{"class":102},[85,239,216],{"class":109},[85,241,219],{"class":123},[85,243,26],{"class":109},[85,245,219],{"class":123},[85,247,227],{"class":109},[85,249,251],{"class":87,"line":250},13,[85,252,253],{"class":109},"  },\n",[85,255,257],{"class":87,"line":256},14,[85,258,259],{"class":109},"  actions: {\n",[85,261,263,266,269,272,274,277,279,281,284,287],{"class":87,"line":262},15,[85,264,265],{"class":102},"    addUser",[85,267,268],{"class":109},": (",[85,270,271],{"class":116},"state",[85,273,26],{"class":109},[85,275,276],{"class":116},"user",[85,278,120],{"class":98},[85,280,103],{"class":102},[85,282,283],{"class":109},") ",[85,285,286],{"class":98},"=>",[85,288,110],{"class":109},[85,290,292],{"class":87,"line":291},16,[85,293,295],{"class":294},"sJ8bj","      // state должен иметь тот же тип, что и defaultState\n",[85,297,299,302,305],{"class":87,"line":298},17,[85,300,301],{"class":109},"      state.userById[user.id] ",[85,303,304],{"class":98},"=",[85,306,307],{"class":109}," user;\n",[85,309,311,314,316],{"class":87,"line":310},18,[85,312,313],{"class":109},"      state.usernameById[user.username] ",[85,315,304],{"class":98},[85,317,318],{"class":109}," user.id;\n",[85,320,322],{"class":87,"line":321},19,[85,323,324],{"class":109},"    },\n",[85,326,328,331,333,335,337,340,342,344,346,348],{"class":87,"line":327},20,[85,329,330],{"class":102},"    deleteUser",[85,332,268],{"class":109},[85,334,271],{"class":116},[85,336,26],{"class":109},[85,338,339],{"class":116},"userId",[85,341,120],{"class":98},[85,343,124],{"class":123},[85,345,283],{"class":109},[85,347,286],{"class":98},[85,349,110],{"class":109},[85,351,353,356,359,361],{"class":87,"line":352},21,[85,354,355],{"class":98},"      const",[85,357,358],{"class":123}," user",[85,360,106],{"class":98},[85,362,363],{"class":109}," state.userById[userId];\n",[85,365,367,370],{"class":87,"line":366},22,[85,368,369],{"class":98},"      delete",[85,371,372],{"class":109}," state.usernameById[user.username];\n",[85,374,376,378],{"class":87,"line":375},23,[85,377,369],{"class":98},[85,379,363],{"class":109},[85,381,383],{"class":87,"line":382},24,[85,384,385],{"class":109},"    }\n",[85,387,389],{"class":87,"line":388},25,[85,390,253],{"class":109},[85,392,394],{"class":87,"line":393},26,[85,395,396],{"class":109},"  selectors: {\n",[85,398,400,403,405,407,409,412,414,416,418,420],{"class":87,"line":399},27,[85,401,402],{"class":102},"    selectUserByUsername",[85,404,268],{"class":109},[85,406,271],{"class":116},[85,408,26],{"class":109},[85,410,411],{"class":116},"username",[85,413,120],{"class":98},[85,415,124],{"class":123},[85,417,283],{"class":109},[85,419,286],{"class":98},[85,421,422],{"class":109}," state.userById[state.usernameById[username]],\n",[85,424,426],{"class":87,"line":425},28,[85,427,428],{"class":109},"  }\n",[85,430,432],{"class":87,"line":431},29,[85,433,434],{"class":109},"});\n",[85,436,438],{"class":87,"line":437},30,[85,439,92],{"emptyLinePlaceholder":91},[85,441,443,446],{"class":87,"line":442},31,[85,444,445],{"class":109},"usersSlice.actions;",[85,447,448],{"class":294},"// экшены\n",[85,450,452,455],{"class":87,"line":451},32,[85,453,454],{"class":109},"usersSlice.selectors;",[85,456,457],{"class":294},"// селекторы\n",[85,459,461],{"class":87,"line":460},33,[85,462,92],{"emptyLinePlaceholder":91},[85,464,466],{"class":87,"line":465},34,[85,467,468],{"class":294},"// ...\n",[85,470,472],{"class":87,"line":471},35,[85,473,92],{"emptyLinePlaceholder":91},[85,475,477],{"class":87,"line":476},36,[85,478,479],{"class":294},"// SomeComponent.tsx\n",[85,481,483],{"class":87,"line":482},37,[85,484,92],{"emptyLinePlaceholder":91},[85,486,488],{"class":87,"line":487},38,[85,489,490],{"class":294},"// user Должен иметь тип User\n",[85,492,494,497,499,501,504,507,509,512,515,518,521,524],{"class":87,"line":493},39,[85,495,496],{"class":98},"const",[85,498,358],{"class":123},[85,500,106],{"class":98},[85,502,503],{"class":102}," useSelector",[85,505,506],{"class":109},"(",[85,508,271],{"class":116},[85,510,511],{"class":98}," =>",[85,513,514],{"class":109}," state.",[85,516,517],{"class":102},"selectUserByUsername",[85,519,520],{"class":109},"(state.users, ",[85,522,523],{"class":191},"'someUsername'",[85,525,526],{"class":109},"));\n",[85,528,530],{"class":87,"line":529},40,[85,531,92],{"emptyLinePlaceholder":91},[85,533,535,537,540,542,545,548,550],{"class":87,"line":534},41,[85,536,496],{"class":98},[85,538,539],{"class":123}," addUser",[85,541,106],{"class":98},[85,543,544],{"class":102}," useCallback",[85,546,547],{"class":109},"(() ",[85,549,286],{"class":98},[85,551,110],{"class":109},[85,553,555,558],{"class":87,"line":554},42,[85,556,557],{"class":102},"  dispatch",[85,559,560],{"class":109},"(\n",[85,562,564],{"class":87,"line":563},43,[85,565,566],{"class":294},"    // Аргументом addUser должен быть объект User\n",[85,568,570,573,576],{"class":87,"line":569},44,[85,571,572],{"class":109},"    usersSlice.actions.",[85,574,575],{"class":102},"addUser",[85,577,182],{"class":109},[85,579,581,584,587],{"class":87,"line":580},45,[85,582,583],{"class":109},"      id: ",[85,585,586],{"class":191},"'2'",[85,588,195],{"class":109},[85,590,592,595,598],{"class":87,"line":591},46,[85,593,594],{"class":109},"      username: ",[85,596,597],{"class":191},"'username2'",[85,599,195],{"class":109},[85,601,603,606,609],{"class":87,"line":602},47,[85,604,605],{"class":109},"      displayName: ",[85,607,608],{"class":191},"'some display name'",[85,610,195],{"class":109},[85,612,614],{"class":87,"line":613},48,[85,615,616],{"class":109},"    })\n",[85,618,620],{"class":87,"line":619},49,[85,621,622],{"class":109},"  );\n",[85,624,626],{"class":87,"line":625},50,[85,627,628],{"class":109},"}, [dispatch]);\n",[10,630,632],{"id":631},"implementation","Реализация",[15,634,635,636,638],{},"Для начала определимся с параметрами ",[19,637,65],{}," и набросаем небольшой черновик:",[75,640,642],{"className":77,"code":641,"language":80,"meta":81,"style":81},"type SliceActionCreator\u003CState, Payload = any> = (\n  state: State,\n  payload: Payload\n) => void;\n\ntype SliceSelector\u003CState, Payload = unknown, SelectorReturn = unknown> = (\n  state: State,\n  payload: Payload\n) => SelectorReturn;\n\ntype CreateSliceProps\u003C\n  Name extends string,\n  State extends Record\u003Cstring, unknown>,\n  Actions extends Record\u003Cstring, SliceActionCreator\u003CState>>,\n  Selectors extends Record\u003Cstring, SliceSelector\u003CState>>\n> = {\n  name: Name;\n  actions: Actions;\n  defaultState: State;\n  selectors: Selectors;\n};\n\nexport const createSlice = \u003C\n  Name extends string,\n  State extends Record\u003Cstring, unknown>,\n  Actions extends Record\u003Cstring, SliceActionCreator\u003CState>>,\n  Selectors extends Record\u003Cstring, SliceSelector\u003CState>>\n>({\n    name,\n    actions,\n    defaultState,\n    selectors,\n  }: CreateSliceProps\u003CName, State, Actions, Selectors>) => {\n  let sliceActions; // TODO\n  let reducer; // TODO\n  let sliceSelectors; // TODO\n\n  return {\n    reducer,\n    selectors: sliceSelectors,\n    actions: sliceActions,\n  };\n};\n\n",[19,643,644,674,686,696,707,711,746,756,764,775,779,789,801,821,846,871,879,891,903,914,926,931,935,948,958,976,998,1020,1025,1030,1035,1040,1045,1080,1091,1100,1109,1113,1120,1125,1130,1135,1140],{"__ignoreMap":81},[85,645,646,648,651,653,656,658,661,663,666,669,671],{"class":87,"line":88},[85,647,99],{"class":98},[85,649,650],{"class":102}," SliceActionCreator",[85,652,216],{"class":109},[85,654,655],{"class":102},"State",[85,657,26],{"class":109},[85,659,660],{"class":102},"Payload",[85,662,106],{"class":98},[85,664,665],{"class":123}," any",[85,667,668],{"class":109},"> ",[85,670,304],{"class":98},[85,672,673],{"class":109}," (\n",[85,675,676,679,681,684],{"class":87,"line":95},[85,677,678],{"class":116},"  state",[85,680,120],{"class":98},[85,682,683],{"class":102}," State",[85,685,195],{"class":109},[85,687,688,691,693],{"class":87,"line":113},[85,689,690],{"class":116},"  payload",[85,692,120],{"class":98},[85,694,695],{"class":102}," Payload\n",[85,697,698,700,702,705],{"class":87,"line":130},[85,699,283],{"class":109},[85,701,286],{"class":98},[85,703,704],{"class":123}," void",[85,706,127],{"class":109},[85,708,709],{"class":87,"line":142},[85,710,92],{"emptyLinePlaceholder":91},[85,712,713,715,718,720,722,724,726,728,731,733,736,738,740,742,744],{"class":87,"line":154},[85,714,99],{"class":98},[85,716,717],{"class":102}," SliceSelector",[85,719,216],{"class":109},[85,721,655],{"class":102},[85,723,26],{"class":109},[85,725,660],{"class":102},[85,727,106],{"class":98},[85,729,730],{"class":123}," unknown",[85,732,26],{"class":109},[85,734,735],{"class":102},"SelectorReturn",[85,737,106],{"class":98},[85,739,730],{"class":123},[85,741,668],{"class":109},[85,743,304],{"class":98},[85,745,673],{"class":109},[85,747,748,750,752,754],{"class":87,"line":160},[85,749,678],{"class":116},[85,751,120],{"class":98},[85,753,683],{"class":102},[85,755,195],{"class":109},[85,757,758,760,762],{"class":87,"line":165},[85,759,690],{"class":116},[85,761,120],{"class":98},[85,763,695],{"class":102},[85,765,766,768,770,773],{"class":87,"line":185},[85,767,283],{"class":109},[85,769,286],{"class":98},[85,771,772],{"class":102}," SelectorReturn",[85,774,127],{"class":109},[85,776,777],{"class":87,"line":198},[85,778,92],{"emptyLinePlaceholder":91},[85,780,781,783,786],{"class":87,"line":204},[85,782,99],{"class":98},[85,784,785],{"class":102}," CreateSliceProps",[85,787,788],{"class":109},"\u003C\n",[85,790,791,794,797,799],{"class":87,"line":230},[85,792,793],{"class":102},"  Name",[85,795,796],{"class":98}," extends",[85,798,124],{"class":123},[85,800,195],{"class":109},[85,802,803,806,808,810,812,814,816,819],{"class":87,"line":250},[85,804,805],{"class":102},"  State",[85,807,796],{"class":98},[85,809,213],{"class":102},[85,811,216],{"class":109},[85,813,219],{"class":123},[85,815,26],{"class":109},[85,817,818],{"class":123},"unknown",[85,820,227],{"class":109},[85,822,823,826,828,830,832,834,836,839,841,843],{"class":87,"line":256},[85,824,825],{"class":102},"  Actions",[85,827,796],{"class":98},[85,829,213],{"class":102},[85,831,216],{"class":109},[85,833,219],{"class":123},[85,835,26],{"class":109},[85,837,838],{"class":102},"SliceActionCreator",[85,840,216],{"class":109},[85,842,655],{"class":102},[85,844,845],{"class":109},">>,\n",[85,847,848,851,853,855,857,859,861,864,866,868],{"class":87,"line":262},[85,849,850],{"class":102},"  Selectors",[85,852,796],{"class":98},[85,854,213],{"class":102},[85,856,216],{"class":109},[85,858,219],{"class":123},[85,860,26],{"class":109},[85,862,863],{"class":102},"SliceSelector",[85,865,216],{"class":109},[85,867,655],{"class":102},[85,869,870],{"class":109},">>\n",[85,872,873,875,877],{"class":87,"line":291},[85,874,668],{"class":109},[85,876,304],{"class":98},[85,878,110],{"class":109},[85,880,881,884,886,889],{"class":87,"line":298},[85,882,883],{"class":116},"  name",[85,885,120],{"class":98},[85,887,888],{"class":102}," Name",[85,890,127],{"class":109},[85,892,893,896,898,901],{"class":87,"line":310},[85,894,895],{"class":116},"  actions",[85,897,120],{"class":98},[85,899,900],{"class":102}," Actions",[85,902,127],{"class":109},[85,904,905,908,910,912],{"class":87,"line":321},[85,906,907],{"class":116},"  defaultState",[85,909,120],{"class":98},[85,911,683],{"class":102},[85,913,127],{"class":109},[85,915,916,919,921,924],{"class":87,"line":327},[85,917,918],{"class":116},"  selectors",[85,920,120],{"class":98},[85,922,923],{"class":102}," Selectors",[85,925,127],{"class":109},[85,927,928],{"class":87,"line":352},[85,929,930],{"class":109},"};\n",[85,932,933],{"class":87,"line":366},[85,934,92],{"emptyLinePlaceholder":91},[85,936,937,939,941,943,945],{"class":87,"line":375},[85,938,168],{"class":98},[85,940,171],{"class":98},[85,942,179],{"class":102},[85,944,106],{"class":98},[85,946,947],{"class":109}," \u003C\n",[85,949,950,952,954,956],{"class":87,"line":382},[85,951,793],{"class":102},[85,953,796],{"class":98},[85,955,124],{"class":123},[85,957,195],{"class":109},[85,959,960,962,964,966,968,970,972,974],{"class":87,"line":388},[85,961,805],{"class":102},[85,963,796],{"class":98},[85,965,213],{"class":102},[85,967,216],{"class":109},[85,969,219],{"class":123},[85,971,26],{"class":109},[85,973,818],{"class":123},[85,975,227],{"class":109},[85,977,978,980,982,984,986,988,990,992,994,996],{"class":87,"line":393},[85,979,825],{"class":102},[85,981,796],{"class":98},[85,983,213],{"class":102},[85,985,216],{"class":109},[85,987,219],{"class":123},[85,989,26],{"class":109},[85,991,838],{"class":102},[85,993,216],{"class":109},[85,995,655],{"class":102},[85,997,845],{"class":109},[85,999,1000,1002,1004,1006,1008,1010,1012,1014,1016,1018],{"class":87,"line":399},[85,1001,850],{"class":102},[85,1003,796],{"class":98},[85,1005,213],{"class":102},[85,1007,216],{"class":109},[85,1009,219],{"class":123},[85,1011,26],{"class":109},[85,1013,863],{"class":102},[85,1015,216],{"class":109},[85,1017,655],{"class":102},[85,1019,870],{"class":109},[85,1021,1022],{"class":87,"line":425},[85,1023,1024],{"class":109},">({\n",[85,1026,1027],{"class":87,"line":431},[85,1028,1029],{"class":109},"    name,\n",[85,1031,1032],{"class":87,"line":437},[85,1033,1034],{"class":109},"    actions,\n",[85,1036,1037],{"class":87,"line":442},[85,1038,1039],{"class":109},"    defaultState,\n",[85,1041,1042],{"class":87,"line":451},[85,1043,1044],{"class":109},"    selectors,\n",[85,1046,1047,1050,1052,1054,1056,1059,1061,1063,1065,1068,1070,1073,1076,1078],{"class":87,"line":460},[85,1048,1049],{"class":109},"  }",[85,1051,120],{"class":98},[85,1053,785],{"class":102},[85,1055,216],{"class":109},[85,1057,1058],{"class":102},"Name",[85,1060,26],{"class":109},[85,1062,655],{"class":102},[85,1064,26],{"class":109},[85,1066,1067],{"class":102},"Actions",[85,1069,26],{"class":109},[85,1071,1072],{"class":102},"Selectors",[85,1074,1075],{"class":109},">) ",[85,1077,286],{"class":98},[85,1079,110],{"class":109},[85,1081,1082,1085,1088],{"class":87,"line":465},[85,1083,1084],{"class":98},"  let",[85,1086,1087],{"class":109}," sliceActions; ",[85,1089,1090],{"class":294},"// TODO\n",[85,1092,1093,1095,1098],{"class":87,"line":471},[85,1094,1084],{"class":98},[85,1096,1097],{"class":109}," reducer; ",[85,1099,1090],{"class":294},[85,1101,1102,1104,1107],{"class":87,"line":476},[85,1103,1084],{"class":98},[85,1105,1106],{"class":109}," sliceSelectors; ",[85,1108,1090],{"class":294},[85,1110,1111],{"class":87,"line":482},[85,1112,92],{"emptyLinePlaceholder":91},[85,1114,1115,1118],{"class":87,"line":487},[85,1116,1117],{"class":98},"  return",[85,1119,110],{"class":109},[85,1121,1122],{"class":87,"line":493},[85,1123,1124],{"class":109},"    reducer,\n",[85,1126,1127],{"class":87,"line":529},[85,1128,1129],{"class":109},"    selectors: sliceSelectors,\n",[85,1131,1132],{"class":87,"line":534},[85,1133,1134],{"class":109},"    actions: sliceActions,\n",[85,1136,1137],{"class":87,"line":554},[85,1138,1139],{"class":109},"  };\n",[85,1141,1142],{"class":87,"line":563},[85,1143,930],{"class":109},[15,1145,1146],{},"План такой - сначала реализовать экшены, потом редьюсер и в самом конце - селекторы.",[10,1148,1150],{"id":1149},"actions","Экшены",[15,1152,1153,1154,1156,1157],{},"Экшен представляет из себя объект с обязательным полем ",[19,1155,99],{}," и опциональным ",[19,1158,1159],{},"payload",[75,1161,1163],{"className":77,"code":1162,"language":80,"meta":81,"style":81},"type Action\u003CType extends string = string, Payload = unknown> = {\n  type: Type;\n  payload?: Payload;\n};\n",[19,1164,1165,1199,1211,1223],{"__ignoreMap":81},[85,1166,1167,1169,1172,1174,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197],{"class":87,"line":88},[85,1168,99],{"class":98},[85,1170,1171],{"class":102}," Action",[85,1173,216],{"class":109},[85,1175,1176],{"class":102},"Type",[85,1178,796],{"class":98},[85,1180,124],{"class":123},[85,1182,106],{"class":98},[85,1184,124],{"class":123},[85,1186,26],{"class":109},[85,1188,660],{"class":102},[85,1190,106],{"class":98},[85,1192,730],{"class":123},[85,1194,668],{"class":109},[85,1196,304],{"class":98},[85,1198,110],{"class":109},[85,1200,1201,1204,1206,1209],{"class":87,"line":95},[85,1202,1203],{"class":116},"  type",[85,1205,120],{"class":98},[85,1207,1208],{"class":102}," Type",[85,1210,127],{"class":109},[85,1212,1213,1215,1218,1221],{"class":87,"line":113},[85,1214,690],{"class":116},[85,1216,1217],{"class":98},"?:",[85,1219,1220],{"class":102}," Payload",[85,1222,127],{"class":109},[85,1224,1225],{"class":87,"line":130},[85,1226,930],{"class":109},[15,1228,1229],{},"Пусть, если в метод createSlice прокинуты",[75,1231,1233],{"className":77,"code":1232,"language":80,"meta":81,"style":81},"const props = {\n  name: 'users',\n  actions: {\n    addUser: (state, user: User) => {\n      state.userById[user.id] = user;\n      state.usernameById[user.username] = user.id;\n    },\n    deleteUser: (state, userId: string) => {\n      const user = state.userById[userId];\n      delete state.usernameById[user.username];\n      delete state.userById[userId];\n    }\n  }\n};\n",[19,1234,1235,1246,1254,1258,1280,1288,1296,1300,1322,1332,1338,1344,1348,1352],{"__ignoreMap":81},[85,1236,1237,1239,1242,1244],{"class":87,"line":88},[85,1238,496],{"class":98},[85,1240,1241],{"class":123}," props",[85,1243,106],{"class":98},[85,1245,110],{"class":109},[85,1247,1248,1250,1252],{"class":87,"line":95},[85,1249,188],{"class":109},[85,1251,192],{"class":191},[85,1253,195],{"class":109},[85,1255,1256],{"class":87,"line":113},[85,1257,259],{"class":109},[85,1259,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278],{"class":87,"line":130},[85,1261,265],{"class":102},[85,1263,268],{"class":109},[85,1265,271],{"class":116},[85,1267,26],{"class":109},[85,1269,276],{"class":116},[85,1271,120],{"class":98},[85,1273,103],{"class":102},[85,1275,283],{"class":109},[85,1277,286],{"class":98},[85,1279,110],{"class":109},[85,1281,1282,1284,1286],{"class":87,"line":142},[85,1283,301],{"class":109},[85,1285,304],{"class":98},[85,1287,307],{"class":109},[85,1289,1290,1292,1294],{"class":87,"line":154},[85,1291,313],{"class":109},[85,1293,304],{"class":98},[85,1295,318],{"class":109},[85,1297,1298],{"class":87,"line":160},[85,1299,324],{"class":109},[85,1301,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320],{"class":87,"line":165},[85,1303,330],{"class":102},[85,1305,268],{"class":109},[85,1307,271],{"class":116},[85,1309,26],{"class":109},[85,1311,339],{"class":116},[85,1313,120],{"class":98},[85,1315,124],{"class":123},[85,1317,283],{"class":109},[85,1319,286],{"class":98},[85,1321,110],{"class":109},[85,1323,1324,1326,1328,1330],{"class":87,"line":185},[85,1325,355],{"class":98},[85,1327,358],{"class":123},[85,1329,106],{"class":98},[85,1331,363],{"class":109},[85,1333,1334,1336],{"class":87,"line":198},[85,1335,369],{"class":98},[85,1337,372],{"class":109},[85,1339,1340,1342],{"class":87,"line":204},[85,1341,369],{"class":98},[85,1343,363],{"class":109},[85,1345,1346],{"class":87,"line":230},[85,1347,385],{"class":109},[85,1349,1350],{"class":87,"line":250},[85,1351,428],{"class":109},[85,1353,1354],{"class":87,"line":256},[85,1355,930],{"class":109},[15,1357,1358],{},"то мы будем генерировать два actionType:",[15,1360,1361],{},"users/addUser\nusers/deleteUser",[15,1363,1364],{},"и два экшена -",[75,1366,1368],{"className":77,"code":1367,"language":80,"meta":81,"style":81},"const addUser = (user: User) => ({\n  type: \"users/addUser\",\n  payload: user,\n});\n\nconst deleteUser = (userId: string) => ({\n  type: \"users/deleteUser\",\n  payload: user,\n});\n",[19,1369,1370,1394,1404,1409,1413,1417,1440,1449,1453],{"__ignoreMap":81},[85,1371,1372,1374,1376,1378,1381,1383,1385,1387,1389,1391],{"class":87,"line":88},[85,1373,496],{"class":98},[85,1375,539],{"class":102},[85,1377,106],{"class":98},[85,1379,1380],{"class":109}," (",[85,1382,276],{"class":116},[85,1384,120],{"class":98},[85,1386,103],{"class":102},[85,1388,283],{"class":109},[85,1390,286],{"class":98},[85,1392,1393],{"class":109}," ({\n",[85,1395,1396,1399,1402],{"class":87,"line":95},[85,1397,1398],{"class":109},"  type: ",[85,1400,1401],{"class":191},"\"users/addUser\"",[85,1403,195],{"class":109},[85,1405,1406],{"class":87,"line":113},[85,1407,1408],{"class":109},"  payload: user,\n",[85,1410,1411],{"class":87,"line":130},[85,1412,434],{"class":109},[85,1414,1415],{"class":87,"line":142},[85,1416,92],{"emptyLinePlaceholder":91},[85,1418,1419,1421,1424,1426,1428,1430,1432,1434,1436,1438],{"class":87,"line":154},[85,1420,496],{"class":98},[85,1422,1423],{"class":102}," deleteUser",[85,1425,106],{"class":98},[85,1427,1380],{"class":109},[85,1429,339],{"class":116},[85,1431,120],{"class":98},[85,1433,124],{"class":123},[85,1435,283],{"class":109},[85,1437,286],{"class":98},[85,1439,1393],{"class":109},[85,1441,1442,1444,1447],{"class":87,"line":160},[85,1443,1398],{"class":109},[85,1445,1446],{"class":191},"\"users/deleteUser\"",[85,1448,195],{"class":109},[85,1450,1451],{"class":87,"line":165},[85,1452,1408],{"class":109},[85,1454,1455],{"class":87,"line":185},[85,1456,434],{"class":109},[15,1458,1459],{},"Префикс с названием слайса добавлен для удобства и для того, чтобы предотвратить конфликт экшенов с одинаковыми названиями.",[15,1461,1462,1463,1466,1467],{},"Нам понадобится два новых типа - ",[19,1464,1465],{},"ActionKey"," и ",[19,1468,1469],{},"ActionType",[15,1471,1472,1473,1475],{},"это ключи переданного объекта actions, а ",[19,1474,1469],{}," - это экшены, которые генерирует слайс, те же ключи, но с префиксом,",[15,1477,1478,1479,1481,1482],{},"Для создания типа ",[19,1480,1469],{}," используется небольшой генерик хелпер ",[19,1483,1484],{},"Scoped",[75,1486,1488],{"className":77,"code":1487,"language":80,"meta":81,"style":81},"type Scoped\u003CString extends string, Scope extends string> = `${Scope}/${String}`;\n\nexport const createSlice = \u003C\n  Name extends string,\n  State extends Record\u003Cstring, unknown>,\n  Actions extends Record\u003Cstring, SliceActionCreator\u003CState>>,\n  ActionKey extends Extract\u003Ckeyof Actions, string>,\n  ScopedActionType extends Scoped\u003CActionKey, Name>,\n  ActionPayload extends Parameters\u003CActions[ActionKey]>[1],\n  Action extends { type: ScopedActionType, payload: ActionPayload },\n>({\n    name,\n    actions,\n    defaultState,\n    selectors,\n  }: CreateSliceProps\u003CName, State, Actions, Selectors>) => {\n  const actionKeys = Object.keys(actions) as ActionKey[];\n  const actionTypeByActionKey = actionKeys.reduce((acc, action) => {\n    const scopedActionType = `${name}/${action}` as ScopedActionType;\n    acc[scopedActionType] = action;\n    return acc;\n  }, {} as Record\u003CScopedActionType, ActionKey>);\n\n  const reducer = (state: State = defaultState, action: Action) => {\n    const nextState = produce(state, draft => {\n      const actionType = actionTypeByActionKey[action.type];\n      actions[actionType]?.(draft as State, action.payload);\n    });\n    return nextState;\n  };\n\n  const sliceActions = actionKeys.reduce((acc, curr) => {\n    acc[curr] = (payload) => {\n      const scopedActionType = `${name}/${curr}` as ScopedActionType;\n\n      return {\n        type: scopedActionType,\n        payload,\n      };\n    };\n    return acc;\n  }, {} as {\n    [ActionKey in Extract\u003Ckeyof Actions, string>]: (payload: Parameters\u003CActions[ActionKey]>[1]) => { type: Scoped\u003CActionKey, Name>, payload: P }\n  });\n\n  return {\n    actions: sliceActions,\n  };\n};\n",[19,1489,1490,1534,1538,1550,1560,1578,1600,1623,1642,1670,1699,1703,1707,1711,1715,1719,1749,1776,1808,1836,1846,1854,1875,1879,1913,1935,1947,1959,1964,1971,1975,1979,2007,2024,2048,2052,2059,2064,2069,2074,2079,2085,2093,2174,2179,2183,2189,2193,2197],{"__ignoreMap":81},[85,1491,1492,1494,1497,1499,1502,1504,1506,1508,1511,1513,1515,1517,1519,1522,1524,1527,1529,1532],{"class":87,"line":88},[85,1493,99],{"class":98},[85,1495,1496],{"class":102}," Scoped",[85,1498,216],{"class":109},[85,1500,1501],{"class":102},"String",[85,1503,796],{"class":98},[85,1505,124],{"class":123},[85,1507,26],{"class":109},[85,1509,1510],{"class":102},"Scope",[85,1512,796],{"class":98},[85,1514,124],{"class":123},[85,1516,668],{"class":109},[85,1518,304],{"class":98},[85,1520,1521],{"class":191}," `${",[85,1523,1510],{"class":102},[85,1525,1526],{"class":191},"}/${",[85,1528,1501],{"class":102},[85,1530,1531],{"class":191},"}`",[85,1533,127],{"class":109},[85,1535,1536],{"class":87,"line":95},[85,1537,92],{"emptyLinePlaceholder":91},[85,1539,1540,1542,1544,1546,1548],{"class":87,"line":113},[85,1541,168],{"class":98},[85,1543,171],{"class":98},[85,1545,179],{"class":102},[85,1547,106],{"class":98},[85,1549,947],{"class":109},[85,1551,1552,1554,1556,1558],{"class":87,"line":130},[85,1553,793],{"class":102},[85,1555,796],{"class":98},[85,1557,124],{"class":123},[85,1559,195],{"class":109},[85,1561,1562,1564,1566,1568,1570,1572,1574,1576],{"class":87,"line":142},[85,1563,805],{"class":102},[85,1565,796],{"class":98},[85,1567,213],{"class":102},[85,1569,216],{"class":109},[85,1571,219],{"class":123},[85,1573,26],{"class":109},[85,1575,818],{"class":123},[85,1577,227],{"class":109},[85,1579,1580,1582,1584,1586,1588,1590,1592,1594,1596,1598],{"class":87,"line":154},[85,1581,825],{"class":102},[85,1583,796],{"class":98},[85,1585,213],{"class":102},[85,1587,216],{"class":109},[85,1589,219],{"class":123},[85,1591,26],{"class":109},[85,1593,838],{"class":102},[85,1595,216],{"class":109},[85,1597,655],{"class":102},[85,1599,845],{"class":109},[85,1601,1602,1605,1607,1610,1612,1615,1617,1619,1621],{"class":87,"line":160},[85,1603,1604],{"class":102},"  ActionKey",[85,1606,796],{"class":98},[85,1608,1609],{"class":102}," Extract",[85,1611,216],{"class":109},[85,1613,1614],{"class":98},"keyof",[85,1616,900],{"class":102},[85,1618,26],{"class":109},[85,1620,219],{"class":123},[85,1622,227],{"class":109},[85,1624,1625,1628,1630,1632,1634,1636,1638,1640],{"class":87,"line":165},[85,1626,1627],{"class":102},"  ScopedActionType",[85,1629,796],{"class":98},[85,1631,1496],{"class":102},[85,1633,216],{"class":109},[85,1635,1465],{"class":102},[85,1637,26],{"class":109},[85,1639,1058],{"class":102},[85,1641,227],{"class":109},[85,1643,1644,1647,1649,1652,1654,1656,1659,1661,1664,1667],{"class":87,"line":185},[85,1645,1646],{"class":102},"  ActionPayload",[85,1648,796],{"class":98},[85,1650,1651],{"class":102}," Parameters",[85,1653,216],{"class":109},[85,1655,1067],{"class":102},[85,1657,1658],{"class":109},"[",[85,1660,1465],{"class":102},[85,1662,1663],{"class":109},"]>[",[85,1665,1666],{"class":123},"1",[85,1668,1669],{"class":109},"],\n",[85,1671,1672,1675,1677,1680,1682,1684,1687,1689,1691,1693,1696],{"class":87,"line":198},[85,1673,1674],{"class":102},"  Action",[85,1676,796],{"class":98},[85,1678,1679],{"class":109}," { ",[85,1681,99],{"class":116},[85,1683,120],{"class":98},[85,1685,1686],{"class":102}," ScopedActionType",[85,1688,26],{"class":109},[85,1690,1159],{"class":116},[85,1692,120],{"class":98},[85,1694,1695],{"class":102}," ActionPayload",[85,1697,1698],{"class":109}," },\n",[85,1700,1701],{"class":87,"line":204},[85,1702,1024],{"class":109},[85,1704,1705],{"class":87,"line":230},[85,1706,1029],{"class":109},[85,1708,1709],{"class":87,"line":250},[85,1710,1034],{"class":109},[85,1712,1713],{"class":87,"line":256},[85,1714,1039],{"class":109},[85,1716,1717],{"class":87,"line":262},[85,1718,1044],{"class":109},[85,1720,1721,1723,1725,1727,1729,1731,1733,1735,1737,1739,1741,1743,1745,1747],{"class":87,"line":291},[85,1722,1049],{"class":109},[85,1724,120],{"class":98},[85,1726,785],{"class":102},[85,1728,216],{"class":109},[85,1730,1058],{"class":102},[85,1732,26],{"class":109},[85,1734,655],{"class":102},[85,1736,26],{"class":109},[85,1738,1067],{"class":102},[85,1740,26],{"class":109},[85,1742,1072],{"class":102},[85,1744,1075],{"class":109},[85,1746,286],{"class":98},[85,1748,110],{"class":109},[85,1750,1751,1754,1757,1759,1762,1765,1768,1770,1773],{"class":87,"line":298},[85,1752,1753],{"class":98},"  const",[85,1755,1756],{"class":123}," actionKeys",[85,1758,106],{"class":98},[85,1760,1761],{"class":109}," Object.",[85,1763,1764],{"class":102},"keys",[85,1766,1767],{"class":109},"(actions) ",[85,1769,210],{"class":98},[85,1771,1772],{"class":102}," ActionKey",[85,1774,1775],{"class":109},"[];\n",[85,1777,1778,1780,1783,1785,1788,1791,1794,1797,1799,1802,1804,1806],{"class":87,"line":310},[85,1779,1753],{"class":98},[85,1781,1782],{"class":123}," actionTypeByActionKey",[85,1784,106],{"class":98},[85,1786,1787],{"class":109}," actionKeys.",[85,1789,1790],{"class":102},"reduce",[85,1792,1793],{"class":109},"((",[85,1795,1796],{"class":116},"acc",[85,1798,26],{"class":109},[85,1800,1801],{"class":116},"action",[85,1803,283],{"class":109},[85,1805,286],{"class":98},[85,1807,110],{"class":109},[85,1809,1810,1813,1816,1818,1820,1823,1825,1827,1829,1832,1834],{"class":87,"line":321},[85,1811,1812],{"class":98},"    const",[85,1814,1815],{"class":123}," scopedActionType",[85,1817,106],{"class":98},[85,1819,1521],{"class":191},[85,1821,1822],{"class":109},"name",[85,1824,1526],{"class":191},[85,1826,1801],{"class":109},[85,1828,1531],{"class":191},[85,1830,1831],{"class":98}," as",[85,1833,1686],{"class":102},[85,1835,127],{"class":109},[85,1837,1838,1841,1843],{"class":87,"line":327},[85,1839,1840],{"class":109},"    acc[scopedActionType] ",[85,1842,304],{"class":98},[85,1844,1845],{"class":109}," action;\n",[85,1847,1848,1851],{"class":87,"line":352},[85,1849,1850],{"class":98},"    return",[85,1852,1853],{"class":109}," acc;\n",[85,1855,1856,1859,1861,1863,1865,1868,1870,1872],{"class":87,"line":366},[85,1857,1858],{"class":109},"  }, {} ",[85,1860,210],{"class":98},[85,1862,213],{"class":102},[85,1864,216],{"class":109},[85,1866,1867],{"class":102},"ScopedActionType",[85,1869,26],{"class":109},[85,1871,1465],{"class":102},[85,1873,1874],{"class":109},">);\n",[85,1876,1877],{"class":87,"line":375},[85,1878,92],{"emptyLinePlaceholder":91},[85,1880,1881,1883,1886,1888,1890,1892,1894,1896,1898,1901,1903,1905,1907,1909,1911],{"class":87,"line":382},[85,1882,1753],{"class":98},[85,1884,1885],{"class":102}," reducer",[85,1887,106],{"class":98},[85,1889,1380],{"class":109},[85,1891,271],{"class":116},[85,1893,120],{"class":98},[85,1895,683],{"class":102},[85,1897,106],{"class":98},[85,1899,1900],{"class":109}," defaultState, ",[85,1902,1801],{"class":116},[85,1904,120],{"class":98},[85,1906,1171],{"class":102},[85,1908,283],{"class":109},[85,1910,286],{"class":98},[85,1912,110],{"class":109},[85,1914,1915,1917,1920,1922,1925,1928,1931,1933],{"class":87,"line":388},[85,1916,1812],{"class":98},[85,1918,1919],{"class":123}," nextState",[85,1921,106],{"class":98},[85,1923,1924],{"class":102}," produce",[85,1926,1927],{"class":109},"(state, ",[85,1929,1930],{"class":116},"draft",[85,1932,511],{"class":98},[85,1934,110],{"class":109},[85,1936,1937,1939,1942,1944],{"class":87,"line":393},[85,1938,355],{"class":98},[85,1940,1941],{"class":123}," actionType",[85,1943,106],{"class":98},[85,1945,1946],{"class":109}," actionTypeByActionKey[action.type];\n",[85,1948,1949,1952,1954,1956],{"class":87,"line":399},[85,1950,1951],{"class":109},"      actions[actionType]?.(draft ",[85,1953,210],{"class":98},[85,1955,683],{"class":102},[85,1957,1958],{"class":109},", action.payload);\n",[85,1960,1961],{"class":87,"line":425},[85,1962,1963],{"class":109},"    });\n",[85,1965,1966,1968],{"class":87,"line":431},[85,1967,1850],{"class":98},[85,1969,1970],{"class":109}," nextState;\n",[85,1972,1973],{"class":87,"line":437},[85,1974,1139],{"class":109},[85,1976,1977],{"class":87,"line":442},[85,1978,92],{"emptyLinePlaceholder":91},[85,1980,1981,1983,1986,1988,1990,1992,1994,1996,1998,2001,2003,2005],{"class":87,"line":451},[85,1982,1753],{"class":98},[85,1984,1985],{"class":123}," sliceActions",[85,1987,106],{"class":98},[85,1989,1787],{"class":109},[85,1991,1790],{"class":102},[85,1993,1793],{"class":109},[85,1995,1796],{"class":116},[85,1997,26],{"class":109},[85,1999,2000],{"class":116},"curr",[85,2002,283],{"class":109},[85,2004,286],{"class":98},[85,2006,110],{"class":109},[85,2008,2009,2012,2014,2016,2018,2020,2022],{"class":87,"line":460},[85,2010,2011],{"class":109},"    acc[curr] ",[85,2013,304],{"class":98},[85,2015,1380],{"class":109},[85,2017,1159],{"class":116},[85,2019,283],{"class":109},[85,2021,286],{"class":98},[85,2023,110],{"class":109},[85,2025,2026,2028,2030,2032,2034,2036,2038,2040,2042,2044,2046],{"class":87,"line":465},[85,2027,355],{"class":98},[85,2029,1815],{"class":123},[85,2031,106],{"class":98},[85,2033,1521],{"class":191},[85,2035,1822],{"class":109},[85,2037,1526],{"class":191},[85,2039,2000],{"class":109},[85,2041,1531],{"class":191},[85,2043,1831],{"class":98},[85,2045,1686],{"class":102},[85,2047,127],{"class":109},[85,2049,2050],{"class":87,"line":471},[85,2051,92],{"emptyLinePlaceholder":91},[85,2053,2054,2057],{"class":87,"line":476},[85,2055,2056],{"class":98},"      return",[85,2058,110],{"class":109},[85,2060,2061],{"class":87,"line":482},[85,2062,2063],{"class":109},"        type: scopedActionType,\n",[85,2065,2066],{"class":87,"line":487},[85,2067,2068],{"class":109},"        payload,\n",[85,2070,2071],{"class":87,"line":493},[85,2072,2073],{"class":109},"      };\n",[85,2075,2076],{"class":87,"line":529},[85,2077,2078],{"class":109},"    };\n",[85,2080,2081,2083],{"class":87,"line":534},[85,2082,1850],{"class":98},[85,2084,1853],{"class":109},[85,2086,2087,2089,2091],{"class":87,"line":554},[85,2088,1858],{"class":109},[85,2090,210],{"class":98},[85,2092,110],{"class":109},[85,2094,2095,2098,2100,2103,2105,2107,2109,2111,2113,2115,2118,2120,2122,2124,2126,2128,2130,2132,2134,2136,2138,2140,2143,2145,2147,2149,2151,2153,2155,2157,2159,2161,2164,2166,2168,2171],{"class":87,"line":563},[85,2096,2097],{"class":109},"    [",[85,2099,1465],{"class":102},[85,2101,2102],{"class":98}," in",[85,2104,1609],{"class":102},[85,2106,216],{"class":109},[85,2108,1614],{"class":98},[85,2110,900],{"class":102},[85,2112,26],{"class":109},[85,2114,219],{"class":123},[85,2116,2117],{"class":109},">]",[85,2119,120],{"class":98},[85,2121,1380],{"class":109},[85,2123,1159],{"class":116},[85,2125,120],{"class":98},[85,2127,1651],{"class":102},[85,2129,216],{"class":109},[85,2131,1067],{"class":102},[85,2133,1658],{"class":109},[85,2135,1465],{"class":102},[85,2137,1663],{"class":109},[85,2139,1666],{"class":123},[85,2141,2142],{"class":109},"]) ",[85,2144,286],{"class":98},[85,2146,1679],{"class":109},[85,2148,99],{"class":116},[85,2150,120],{"class":98},[85,2152,1496],{"class":102},[85,2154,216],{"class":109},[85,2156,1465],{"class":102},[85,2158,26],{"class":109},[85,2160,1058],{"class":102},[85,2162,2163],{"class":109},">, ",[85,2165,1159],{"class":116},[85,2167,120],{"class":98},[85,2169,2170],{"class":102}," P",[85,2172,2173],{"class":109}," }\n",[85,2175,2176],{"class":87,"line":569},[85,2177,2178],{"class":109},"  });\n",[85,2180,2181],{"class":87,"line":580},[85,2182,92],{"emptyLinePlaceholder":91},[85,2184,2185,2187],{"class":87,"line":591},[85,2186,1117],{"class":98},[85,2188,110],{"class":109},[85,2190,2191],{"class":87,"line":602},[85,2192,1134],{"class":109},[85,2194,2195],{"class":87,"line":613},[85,2196,1139],{"class":109},[85,2198,2199],{"class":87,"line":619},[85,2200,930],{"class":109},[15,2202,2203],{},"Остановлюсь на некоторых аспектах типизации чуть подробнее",[15,2205,2206,2207,2209,2210],{},"должен быть генериком, который будет на лету подхватывать ключи из переданного объекта ",[19,2208,1067],{},".\nУ объекта в качестве ключа помимо строки может быть число или символ.\nЧтобы избежать проблем с типизацией, нужно достать только строки при помощи  ",[19,2211,2212],{},"Extract\u003Ckeyof Actions, string>",[15,2214,2215,2216,2218,2219,2222,2223,2226,2227,2229,2230],{},"Чтобы сгенерировать экшены с правильным payload (чтобы у ",[19,2217,575],{}," была поддержка типизации и аргументом был именно ",[19,2220,2221],{},"user: User","),\nнужно достать второй аргумент из переданного коллбека. Для этого воспользуемся хелпером ",[19,2224,2225],{},"Parameters","\nи укажем нужный ",[19,2228,1465],{},"-  ",[19,2231,2232],{},"Parameters\u003CActions[ActionType]>[1]",[15,2234,2235],{},"Проверим, что все работает правильно:",[75,2237,2239],{"className":77,"code":2238,"language":80,"meta":81,"style":81},"export const usersSlice = createSlice({\n  name: 'users',\n  defaultState: {\n    userById: {} as Record\u003Cstring, User>,\n    usernameById: {} as Record\u003Cstring, string>,\n  },\n  actions: {\n    addUser: (state, user: User) => {\n      // state должен иметь тот же тип, что и defaultState\n      state.userById[user.id] = user;\n      state.usernameById[user.username] = user.id;\n    },\n    deleteUser: (state, userId: string) => {\n      const user = state.userById[userId];\n      delete state.usernameById[user.username];\n      delete state.userById[userId];\n    }\n  },\n  selectors: {\n    selectUserByUsername: (state, username: string) => state.userById[state.usernameById[username]],\n  }\n});\n\nusersSlice.actions; // можно навести на actions и увидеть его тип\n",[19,2240,2241,2255,2263,2267,2285,2303,2307,2311,2333,2337,2345,2353,2357,2379,2389,2395,2401,2405,2409,2413,2435,2439,2443,2447],{"__ignoreMap":81},[85,2242,2243,2245,2247,2249,2251,2253],{"class":87,"line":88},[85,2244,168],{"class":98},[85,2246,171],{"class":98},[85,2248,174],{"class":123},[85,2250,106],{"class":98},[85,2252,179],{"class":102},[85,2254,182],{"class":109},[85,2256,2257,2259,2261],{"class":87,"line":95},[85,2258,188],{"class":109},[85,2260,192],{"class":191},[85,2262,195],{"class":109},[85,2264,2265],{"class":87,"line":113},[85,2266,201],{"class":109},[85,2268,2269,2271,2273,2275,2277,2279,2281,2283],{"class":87,"line":130},[85,2270,207],{"class":109},[85,2272,210],{"class":98},[85,2274,213],{"class":102},[85,2276,216],{"class":109},[85,2278,219],{"class":123},[85,2280,26],{"class":109},[85,2282,224],{"class":102},[85,2284,227],{"class":109},[85,2286,2287,2289,2291,2293,2295,2297,2299,2301],{"class":87,"line":142},[85,2288,233],{"class":109},[85,2290,210],{"class":98},[85,2292,213],{"class":102},[85,2294,216],{"class":109},[85,2296,219],{"class":123},[85,2298,26],{"class":109},[85,2300,219],{"class":123},[85,2302,227],{"class":109},[85,2304,2305],{"class":87,"line":154},[85,2306,253],{"class":109},[85,2308,2309],{"class":87,"line":160},[85,2310,259],{"class":109},[85,2312,2313,2315,2317,2319,2321,2323,2325,2327,2329,2331],{"class":87,"line":165},[85,2314,265],{"class":102},[85,2316,268],{"class":109},[85,2318,271],{"class":116},[85,2320,26],{"class":109},[85,2322,276],{"class":116},[85,2324,120],{"class":98},[85,2326,103],{"class":102},[85,2328,283],{"class":109},[85,2330,286],{"class":98},[85,2332,110],{"class":109},[85,2334,2335],{"class":87,"line":185},[85,2336,295],{"class":294},[85,2338,2339,2341,2343],{"class":87,"line":198},[85,2340,301],{"class":109},[85,2342,304],{"class":98},[85,2344,307],{"class":109},[85,2346,2347,2349,2351],{"class":87,"line":204},[85,2348,313],{"class":109},[85,2350,304],{"class":98},[85,2352,318],{"class":109},[85,2354,2355],{"class":87,"line":230},[85,2356,324],{"class":109},[85,2358,2359,2361,2363,2365,2367,2369,2371,2373,2375,2377],{"class":87,"line":250},[85,2360,330],{"class":102},[85,2362,268],{"class":109},[85,2364,271],{"class":116},[85,2366,26],{"class":109},[85,2368,339],{"class":116},[85,2370,120],{"class":98},[85,2372,124],{"class":123},[85,2374,283],{"class":109},[85,2376,286],{"class":98},[85,2378,110],{"class":109},[85,2380,2381,2383,2385,2387],{"class":87,"line":256},[85,2382,355],{"class":98},[85,2384,358],{"class":123},[85,2386,106],{"class":98},[85,2388,363],{"class":109},[85,2390,2391,2393],{"class":87,"line":262},[85,2392,369],{"class":98},[85,2394,372],{"class":109},[85,2396,2397,2399],{"class":87,"line":291},[85,2398,369],{"class":98},[85,2400,363],{"class":109},[85,2402,2403],{"class":87,"line":298},[85,2404,385],{"class":109},[85,2406,2407],{"class":87,"line":310},[85,2408,253],{"class":109},[85,2410,2411],{"class":87,"line":321},[85,2412,396],{"class":109},[85,2414,2415,2417,2419,2421,2423,2425,2427,2429,2431,2433],{"class":87,"line":327},[85,2416,402],{"class":102},[85,2418,268],{"class":109},[85,2420,271],{"class":116},[85,2422,26],{"class":109},[85,2424,411],{"class":116},[85,2426,120],{"class":98},[85,2428,124],{"class":123},[85,2430,283],{"class":109},[85,2432,286],{"class":98},[85,2434,422],{"class":109},[85,2436,2437],{"class":87,"line":352},[85,2438,428],{"class":109},[85,2440,2441],{"class":87,"line":366},[85,2442,434],{"class":109},[85,2444,2445],{"class":87,"line":375},[85,2446,92],{"emptyLinePlaceholder":91},[85,2448,2449,2452],{"class":87,"line":382},[85,2450,2451],{"class":109},"usersSlice.actions; ",[85,2453,2454],{"class":294},"// можно навести на actions и увидеть его тип\n",[15,2456,2457],{},[2458,2459],"img",{"alt":2460,"src":2461},"Подсказка в vs code","/images/actions-type-hightlight.png",[10,2463,2465],{"id":2464},"reducer","Редьюсер",[15,2467,2468,2469,1466,2471,2473,2474,2477],{},"По своей сути редьюсер - это чистая функция, которая принимает два аргумента - ",[19,2470,271],{},[19,2472,1801],{}," и возвращает ",[19,2475,2476],{},"nextState",".\nОчень важно при этом, чтобы стейт был иммутабельным, ради этого обычно используются страшные конструкции вроде",[75,2479,2481],{"className":77,"code":2480,"language":80,"meta":81,"style":81},"const nextState = {\n  ...state,\n  userById: {\n    ...state.userById,\n    [user.id]: user, \n  }\n};\n",[19,2482,2483,2493,2501,2506,2514,2519,2523],{"__ignoreMap":81},[85,2484,2485,2487,2489,2491],{"class":87,"line":88},[85,2486,496],{"class":98},[85,2488,1919],{"class":123},[85,2490,106],{"class":98},[85,2492,110],{"class":109},[85,2494,2495,2498],{"class":87,"line":95},[85,2496,2497],{"class":98},"  ...",[85,2499,2500],{"class":109},"state,\n",[85,2502,2503],{"class":87,"line":113},[85,2504,2505],{"class":109},"  userById: {\n",[85,2507,2508,2511],{"class":87,"line":130},[85,2509,2510],{"class":98},"    ...",[85,2512,2513],{"class":109},"state.userById,\n",[85,2515,2516],{"class":87,"line":142},[85,2517,2518],{"class":109},"    [user.id]: user, \n",[85,2520,2521],{"class":87,"line":154},[85,2522,428],{"class":109},[85,2524,2525],{"class":87,"line":160},[85,2526,930],{"class":109},[15,2528,2529,2530,2534,2535,2539,2540,2544],{},"Чтобы облегчить себе жизнь, для создания иммутабельного стейта предлагаю использовать\n",[42,2531,2532],{"href":2532,"rel":2533},"https://www.npmjs.com/package/immer",[46],"](",[42,2536,2537],{"href":2537,"rel":2538},"https://github.com/immerjs/immer",[46],"), в частности метод\nproduce](",[42,2541,2542],{"href":2542,"rel":2543},"https://immerjs.github.io/immer/produce",[46],")",[15,2546,2547,2548,2551],{},"таким образом все, что нам нужно - это вызвать внутри ",[19,2549,2550],{},"produce"," нужный коллбек (экшен), передав туда драфт стейта и payload экшена",[75,2553,2555],{"className":77,"code":2554,"language":80,"meta":81,"style":81},"const reducer = (state: State = defaultState, action: Action) => {\n  const nextState = produce(state, draft => {\n    actions[action.type]?.(draft as State, action.payload);\n  });\n  return nextState;\n};\n",[19,2556,2557,2589,2607,2618,2622,2628],{"__ignoreMap":81},[85,2558,2559,2561,2563,2565,2567,2569,2571,2573,2575,2577,2579,2581,2583,2585,2587],{"class":87,"line":88},[85,2560,496],{"class":98},[85,2562,1885],{"class":102},[85,2564,106],{"class":98},[85,2566,1380],{"class":109},[85,2568,271],{"class":116},[85,2570,120],{"class":98},[85,2572,683],{"class":102},[85,2574,106],{"class":98},[85,2576,1900],{"class":109},[85,2578,1801],{"class":116},[85,2580,120],{"class":98},[85,2582,1171],{"class":102},[85,2584,283],{"class":109},[85,2586,286],{"class":98},[85,2588,110],{"class":109},[85,2590,2591,2593,2595,2597,2599,2601,2603,2605],{"class":87,"line":95},[85,2592,1753],{"class":98},[85,2594,1919],{"class":123},[85,2596,106],{"class":98},[85,2598,1924],{"class":102},[85,2600,1927],{"class":109},[85,2602,1930],{"class":116},[85,2604,511],{"class":98},[85,2606,110],{"class":109},[85,2608,2609,2612,2614,2616],{"class":87,"line":113},[85,2610,2611],{"class":109},"    actions[action.type]?.(draft ",[85,2613,210],{"class":98},[85,2615,683],{"class":102},[85,2617,1958],{"class":109},[85,2619,2620],{"class":87,"line":130},[85,2621,2178],{"class":109},[85,2623,2624,2626],{"class":87,"line":142},[85,2625,1117],{"class":98},[85,2627,1970],{"class":109},[85,2629,2630],{"class":87,"line":154},[85,2631,930],{"class":109},[10,2633,2635],{"id":2634},"selectors","Селекторы",[15,2637,2638,2639,2642],{},"Для работы в связке с react + redux используется хук ",[19,2640,2641],{},"useSelector"," .",[15,2644,2645,2646,2544],{},"Чтобы реакт знал и мог реагировать (делать ререндер компонента) на изменения в стейте существует метод\nuseSyncExternalStore](",[42,2647,2648],{"href":2648,"rel":2649},"https://react.dev/reference/react/useSyncExternalStore",[46],[15,2651,2652],{},"Например, чтобы получить актуальный стейт, можно написать следующий код:",[75,2654,2656],{"className":77,"code":2655,"language":80,"meta":81,"style":81},"const useStore = () => {\n  const state = useSyncExternalStore(\n    myStore.subscribe,\n    myStore.getState,\n  );\n\n  return state;\n};\n",[19,2657,2658,2674,2688,2693,2698,2702,2706,2713],{"__ignoreMap":81},[85,2659,2660,2662,2665,2667,2670,2672],{"class":87,"line":88},[85,2661,496],{"class":98},[85,2663,2664],{"class":102}," useStore",[85,2666,106],{"class":98},[85,2668,2669],{"class":109}," () ",[85,2671,286],{"class":98},[85,2673,110],{"class":109},[85,2675,2676,2678,2681,2683,2686],{"class":87,"line":95},[85,2677,1753],{"class":98},[85,2679,2680],{"class":123}," state",[85,2682,106],{"class":98},[85,2684,2685],{"class":102}," useSyncExternalStore",[85,2687,560],{"class":109},[85,2689,2690],{"class":87,"line":113},[85,2691,2692],{"class":109},"    myStore.subscribe,\n",[85,2694,2695],{"class":87,"line":130},[85,2696,2697],{"class":109},"    myStore.getState,\n",[85,2699,2700],{"class":87,"line":142},[85,2701,622],{"class":109},[85,2703,2704],{"class":87,"line":154},[85,2705,92],{"emptyLinePlaceholder":91},[85,2707,2708,2710],{"class":87,"line":160},[85,2709,1117],{"class":98},[85,2711,2712],{"class":109}," state;\n",[85,2714,2715],{"class":87,"line":165},[85,2716,930],{"class":109},[15,2718,2719,2720,2723],{},"Мы могли бы даже использовать селектор, чтобы достать из стора нужные нам данные,\nоднако такая реализация будет реагировать на ",[51,2721,2722],{},"любые"," изменения в стейте.",[15,2725,2726],{},"Мы же хотим, чтобы наш useSelector реагировал только на изменения результата селектора, а не всего стейта.\nТ.е. чтобы селектор",[75,2728,2730],{"className":77,"code":2729,"language":80,"meta":81,"style":81},"const username = useSelector(state => state.users.usersById['some-id'].username);\n",[19,2731,2732],{"__ignoreMap":81},[85,2733,2734,2736,2739,2741,2743,2745,2747,2749,2752,2755],{"class":87,"line":88},[85,2735,496],{"class":98},[85,2737,2738],{"class":123}," username",[85,2740,106],{"class":98},[85,2742,503],{"class":102},[85,2744,506],{"class":109},[85,2746,271],{"class":116},[85,2748,511],{"class":98},[85,2750,2751],{"class":109}," state.users.usersById[",[85,2753,2754],{"class":191},"'some-id'",[85,2756,2757],{"class":109},"].username);\n",[15,2759,2760],{},"реагировал только на изменение username конкретного юзера (с id = “some-id”).",[15,2762,2763,2764,2767,2768,2771],{},"Предлагаю не писать велосипед и использовать ",[19,2765,2766],{},"useSyncExternalStoreWithSelector",".\nЭто модифицированная версия ",[19,2769,2770],{},"useSyncExternalStore"," c поддержкой селекторов и мемоизацией.",[15,2773,2774,2775,2777],{},"Таким образом хелпер для создания ",[19,2776,2641],{}," будет выглядеть следующим образом:",[75,2779,2781],{"className":77,"code":2780,"language":80,"meta":81,"style":81},"import type { Store as ReduxStore } from 'redux';\nimport { useSyncExternalStoreWithSelector } from 'use-sync-external-store/with-selector';\n\nexport const createUseSelector = \u003C\n  Store extends ReduxStore,\n  State extends ReturnType\u003CStore['getState']>,\n>(store: Store) => {\n  const useSelector = \u003CSelector extends (state: State) => unknown>(selector: Selector) => {\n    return useSyncExternalStoreWithSelector(\n      store.subscribe,\n      store.getState,\n      store.getState,\n      selector\n    ) as ReturnType\u003CSelector>;\n  };\n\n  return useSelector;\n};\n",[19,2782,2783,2807,2821,2825,2838,2850,2872,2891,2937,2946,2951,2956,2960,2965,2981,2985,2989,2996],{"__ignoreMap":81},[85,2784,2785,2788,2791,2794,2796,2799,2802,2805],{"class":87,"line":88},[85,2786,2787],{"class":98},"import",[85,2789,2790],{"class":98}," type",[85,2792,2793],{"class":109}," { Store ",[85,2795,210],{"class":98},[85,2797,2798],{"class":109}," ReduxStore } ",[85,2800,2801],{"class":98},"from",[85,2803,2804],{"class":191}," 'redux'",[85,2806,127],{"class":109},[85,2808,2809,2811,2814,2816,2819],{"class":87,"line":95},[85,2810,2787],{"class":98},[85,2812,2813],{"class":109}," { useSyncExternalStoreWithSelector } ",[85,2815,2801],{"class":98},[85,2817,2818],{"class":191}," 'use-sync-external-store/with-selector'",[85,2820,127],{"class":109},[85,2822,2823],{"class":87,"line":113},[85,2824,92],{"emptyLinePlaceholder":91},[85,2826,2827,2829,2831,2834,2836],{"class":87,"line":130},[85,2828,168],{"class":98},[85,2830,171],{"class":98},[85,2832,2833],{"class":102}," createUseSelector",[85,2835,106],{"class":98},[85,2837,947],{"class":109},[85,2839,2840,2843,2845,2848],{"class":87,"line":142},[85,2841,2842],{"class":102},"  Store",[85,2844,796],{"class":98},[85,2846,2847],{"class":102}," ReduxStore",[85,2849,195],{"class":109},[85,2851,2852,2854,2856,2859,2861,2864,2866,2869],{"class":87,"line":154},[85,2853,805],{"class":102},[85,2855,796],{"class":98},[85,2857,2858],{"class":102}," ReturnType",[85,2860,216],{"class":109},[85,2862,2863],{"class":102},"Store",[85,2865,1658],{"class":109},[85,2867,2868],{"class":191},"'getState'",[85,2870,2871],{"class":109},"]>,\n",[85,2873,2874,2877,2880,2882,2885,2887,2889],{"class":87,"line":160},[85,2875,2876],{"class":109},">(",[85,2878,2879],{"class":116},"store",[85,2881,120],{"class":98},[85,2883,2884],{"class":102}," Store",[85,2886,283],{"class":109},[85,2888,286],{"class":98},[85,2890,110],{"class":109},[85,2892,2893,2895,2897,2899,2902,2905,2907,2909,2911,2913,2915,2917,2919,2921,2923,2926,2928,2931,2933,2935],{"class":87,"line":165},[85,2894,1753],{"class":98},[85,2896,503],{"class":102},[85,2898,106],{"class":98},[85,2900,2901],{"class":109}," \u003C",[85,2903,2904],{"class":102},"Selector",[85,2906,796],{"class":98},[85,2908,1380],{"class":109},[85,2910,271],{"class":116},[85,2912,120],{"class":98},[85,2914,683],{"class":102},[85,2916,283],{"class":109},[85,2918,286],{"class":98},[85,2920,730],{"class":123},[85,2922,2876],{"class":109},[85,2924,2925],{"class":116},"selector",[85,2927,120],{"class":98},[85,2929,2930],{"class":102}," Selector",[85,2932,283],{"class":109},[85,2934,286],{"class":98},[85,2936,110],{"class":109},[85,2938,2939,2941,2944],{"class":87,"line":185},[85,2940,1850],{"class":98},[85,2942,2943],{"class":102}," useSyncExternalStoreWithSelector",[85,2945,560],{"class":109},[85,2947,2948],{"class":87,"line":198},[85,2949,2950],{"class":109},"      store.subscribe,\n",[85,2952,2953],{"class":87,"line":204},[85,2954,2955],{"class":109},"      store.getState,\n",[85,2957,2958],{"class":87,"line":230},[85,2959,2955],{"class":109},[85,2961,2962],{"class":87,"line":250},[85,2963,2964],{"class":109},"      selector\n",[85,2966,2967,2970,2972,2974,2976,2978],{"class":87,"line":256},[85,2968,2969],{"class":109},"    ) ",[85,2971,210],{"class":98},[85,2973,2858],{"class":102},[85,2975,216],{"class":109},[85,2977,2904],{"class":102},[85,2979,2980],{"class":109},">;\n",[85,2982,2983],{"class":87,"line":262},[85,2984,1139],{"class":109},[85,2986,2987],{"class":87,"line":291},[85,2988,92],{"emptyLinePlaceholder":91},[85,2990,2991,2993],{"class":87,"line":298},[85,2992,1117],{"class":98},[85,2994,2995],{"class":109}," useSelector;\n",[85,2997,2998],{"class":87,"line":310},[85,2999,930],{"class":109},[10,3001,3003],{"id":3002},"global-store","Глобальный стор",[15,3005,3006,3007,3010],{},"В redux-toolkit есть метод ",[19,3008,3009],{},"configureStore"," для создания глобального стора.\nПредлагаю написать минималистичную версию, которая лишь объединяет редьюсеры и создает store",[75,3012,3014],{"className":77,"code":3013,"language":80,"meta":81,"style":81},"import type { Reducer } from 'redux';\n\ntype SliceAction\u003CType extends string = string, Payload = unknown> = {\n  type: Type,\n  payload: Payload,\n}\n\ntype SimpleSlice\u003CName extends string, ReducerType extends Reducer\u003Cany, any>> = {\n  name: Name;\n  reducer: ReducerType,\n}\n\ntype TypesFromSlices\u003CT> = T extends readonly { name: infer Name extends string, reducer: Reducer\u003Cinfer State, infer Action> }[]\n  ? Action extends SliceAction\u003Cinfer Type, infer Payload>\n  ? {\n    action: SliceAction\u003CType, Payload>,\n    state: { [P in Name]: State }\n  } : never : never\n\nexport const configureStore = \u003C\n  Slice extends SimpleSlice\u003Cstring, Reducer\u003Cany, any, any>>,\n  State extends TypesFromSlices\u003CSlice[]>['state'],\n  Action extends TypesFromSlices\u003CSlice[]>['action'],\n>(slices: Slice[]) => {\n  const reducersByName = slices.reduce((acc, current) => {\n    acc[current.name] = current.reducer;\n    return acc;\n  }, {} as Record\u003Cstring, Reducer>);\n\n  const reducer = combineReducers(reducersByName) as Reducer\u003CState, Action>;\n\n  const store = createStore(reducer);\n\n  return {\n    store,\n  };\n};\n",[19,3015,3016,3031,3035,3068,3078,3088,3092,3096,3137,3147,3159,3163,3167,3230,3256,3262,3281,3307,3323,3327,3340,3372,3393,3412,3431,3460,3470,3476,3494,3498,3527,3531,3546,3550,3556,3561,3565],{"__ignoreMap":81},[85,3017,3018,3020,3022,3025,3027,3029],{"class":87,"line":88},[85,3019,2787],{"class":98},[85,3021,2790],{"class":98},[85,3023,3024],{"class":109}," { Reducer } ",[85,3026,2801],{"class":98},[85,3028,2804],{"class":191},[85,3030,127],{"class":109},[85,3032,3033],{"class":87,"line":95},[85,3034,92],{"emptyLinePlaceholder":91},[85,3036,3037,3039,3042,3044,3046,3048,3050,3052,3054,3056,3058,3060,3062,3064,3066],{"class":87,"line":113},[85,3038,99],{"class":98},[85,3040,3041],{"class":102}," SliceAction",[85,3043,216],{"class":109},[85,3045,1176],{"class":102},[85,3047,796],{"class":98},[85,3049,124],{"class":123},[85,3051,106],{"class":98},[85,3053,124],{"class":123},[85,3055,26],{"class":109},[85,3057,660],{"class":102},[85,3059,106],{"class":98},[85,3061,730],{"class":123},[85,3063,668],{"class":109},[85,3065,304],{"class":98},[85,3067,110],{"class":109},[85,3069,3070,3072,3074,3076],{"class":87,"line":130},[85,3071,1203],{"class":116},[85,3073,120],{"class":98},[85,3075,1208],{"class":102},[85,3077,195],{"class":109},[85,3079,3080,3082,3084,3086],{"class":87,"line":142},[85,3081,690],{"class":116},[85,3083,120],{"class":98},[85,3085,1220],{"class":102},[85,3087,195],{"class":109},[85,3089,3090],{"class":87,"line":154},[85,3091,157],{"class":109},[85,3093,3094],{"class":87,"line":160},[85,3095,92],{"emptyLinePlaceholder":91},[85,3097,3098,3100,3103,3105,3107,3109,3111,3113,3116,3118,3121,3123,3126,3128,3130,3133,3135],{"class":87,"line":165},[85,3099,99],{"class":98},[85,3101,3102],{"class":102}," SimpleSlice",[85,3104,216],{"class":109},[85,3106,1058],{"class":102},[85,3108,796],{"class":98},[85,3110,124],{"class":123},[85,3112,26],{"class":109},[85,3114,3115],{"class":102},"ReducerType",[85,3117,796],{"class":98},[85,3119,3120],{"class":102}," Reducer",[85,3122,216],{"class":109},[85,3124,3125],{"class":123},"any",[85,3127,26],{"class":109},[85,3129,3125],{"class":123},[85,3131,3132],{"class":109},">> ",[85,3134,304],{"class":98},[85,3136,110],{"class":109},[85,3138,3139,3141,3143,3145],{"class":87,"line":185},[85,3140,883],{"class":116},[85,3142,120],{"class":98},[85,3144,888],{"class":102},[85,3146,127],{"class":109},[85,3148,3149,3152,3154,3157],{"class":87,"line":198},[85,3150,3151],{"class":116},"  reducer",[85,3153,120],{"class":98},[85,3155,3156],{"class":102}," ReducerType",[85,3158,195],{"class":109},[85,3160,3161],{"class":87,"line":204},[85,3162,157],{"class":109},[85,3164,3165],{"class":87,"line":230},[85,3166,92],{"emptyLinePlaceholder":91},[85,3168,3169,3171,3174,3176,3179,3181,3183,3186,3188,3191,3193,3195,3197,3200,3202,3204,3206,3208,3210,3212,3214,3216,3219,3221,3223,3225,3227],{"class":87,"line":250},[85,3170,99],{"class":98},[85,3172,3173],{"class":102}," TypesFromSlices",[85,3175,216],{"class":109},[85,3177,3178],{"class":102},"T",[85,3180,668],{"class":109},[85,3182,304],{"class":98},[85,3184,3185],{"class":102}," T",[85,3187,796],{"class":98},[85,3189,3190],{"class":98}," readonly",[85,3192,1679],{"class":109},[85,3194,1822],{"class":116},[85,3196,120],{"class":98},[85,3198,3199],{"class":98}," infer",[85,3201,888],{"class":102},[85,3203,796],{"class":98},[85,3205,124],{"class":123},[85,3207,26],{"class":109},[85,3209,2464],{"class":116},[85,3211,120],{"class":98},[85,3213,3120],{"class":102},[85,3215,216],{"class":109},[85,3217,3218],{"class":98},"infer",[85,3220,683],{"class":102},[85,3222,26],{"class":109},[85,3224,3218],{"class":98},[85,3226,1171],{"class":102},[85,3228,3229],{"class":109},"> }[]\n",[85,3231,3232,3235,3237,3239,3241,3243,3245,3247,3249,3251,3253],{"class":87,"line":256},[85,3233,3234],{"class":98},"  ?",[85,3236,1171],{"class":102},[85,3238,796],{"class":98},[85,3240,3041],{"class":102},[85,3242,216],{"class":109},[85,3244,3218],{"class":98},[85,3246,1208],{"class":102},[85,3248,26],{"class":109},[85,3250,3218],{"class":98},[85,3252,1220],{"class":102},[85,3254,3255],{"class":109},">\n",[85,3257,3258,3260],{"class":87,"line":262},[85,3259,3234],{"class":98},[85,3261,110],{"class":109},[85,3263,3264,3267,3269,3271,3273,3275,3277,3279],{"class":87,"line":291},[85,3265,3266],{"class":116},"    action",[85,3268,120],{"class":98},[85,3270,3041],{"class":102},[85,3272,216],{"class":109},[85,3274,1176],{"class":102},[85,3276,26],{"class":109},[85,3278,660],{"class":102},[85,3280,227],{"class":109},[85,3282,3283,3286,3288,3291,3294,3296,3298,3301,3303,3305],{"class":87,"line":298},[85,3284,3285],{"class":116},"    state",[85,3287,120],{"class":98},[85,3289,3290],{"class":109}," { [",[85,3292,3293],{"class":102},"P",[85,3295,2102],{"class":98},[85,3297,888],{"class":102},[85,3299,3300],{"class":109},"]",[85,3302,120],{"class":98},[85,3304,683],{"class":102},[85,3306,2173],{"class":109},[85,3308,3309,3312,3314,3317,3320],{"class":87,"line":310},[85,3310,3311],{"class":109},"  } ",[85,3313,120],{"class":98},[85,3315,3316],{"class":123}," never",[85,3318,3319],{"class":98}," :",[85,3321,3322],{"class":123}," never\n",[85,3324,3325],{"class":87,"line":321},[85,3326,92],{"emptyLinePlaceholder":91},[85,3328,3329,3331,3333,3336,3338],{"class":87,"line":327},[85,3330,168],{"class":98},[85,3332,171],{"class":98},[85,3334,3335],{"class":102}," configureStore",[85,3337,106],{"class":98},[85,3339,947],{"class":109},[85,3341,3342,3345,3347,3349,3351,3353,3355,3358,3360,3362,3364,3366,3368,3370],{"class":87,"line":352},[85,3343,3344],{"class":102},"  Slice",[85,3346,796],{"class":98},[85,3348,3102],{"class":102},[85,3350,216],{"class":109},[85,3352,219],{"class":123},[85,3354,26],{"class":109},[85,3356,3357],{"class":102},"Reducer",[85,3359,216],{"class":109},[85,3361,3125],{"class":123},[85,3363,26],{"class":109},[85,3365,3125],{"class":123},[85,3367,26],{"class":109},[85,3369,3125],{"class":123},[85,3371,845],{"class":109},[85,3373,3374,3376,3378,3380,3382,3385,3388,3391],{"class":87,"line":366},[85,3375,805],{"class":102},[85,3377,796],{"class":98},[85,3379,3173],{"class":102},[85,3381,216],{"class":109},[85,3383,3384],{"class":102},"Slice",[85,3386,3387],{"class":109},"[]>[",[85,3389,3390],{"class":191},"'state'",[85,3392,1669],{"class":109},[85,3394,3395,3397,3399,3401,3403,3405,3407,3410],{"class":87,"line":375},[85,3396,1674],{"class":102},[85,3398,796],{"class":98},[85,3400,3173],{"class":102},[85,3402,216],{"class":109},[85,3404,3384],{"class":102},[85,3406,3387],{"class":109},[85,3408,3409],{"class":191},"'action'",[85,3411,1669],{"class":109},[85,3413,3414,3416,3419,3421,3424,3427,3429],{"class":87,"line":382},[85,3415,2876],{"class":109},[85,3417,3418],{"class":116},"slices",[85,3420,120],{"class":98},[85,3422,3423],{"class":102}," Slice",[85,3425,3426],{"class":109},"[]) ",[85,3428,286],{"class":98},[85,3430,110],{"class":109},[85,3432,3433,3435,3438,3440,3443,3445,3447,3449,3451,3454,3456,3458],{"class":87,"line":388},[85,3434,1753],{"class":98},[85,3436,3437],{"class":123}," reducersByName",[85,3439,106],{"class":98},[85,3441,3442],{"class":109}," slices.",[85,3444,1790],{"class":102},[85,3446,1793],{"class":109},[85,3448,1796],{"class":116},[85,3450,26],{"class":109},[85,3452,3453],{"class":116},"current",[85,3455,283],{"class":109},[85,3457,286],{"class":98},[85,3459,110],{"class":109},[85,3461,3462,3465,3467],{"class":87,"line":393},[85,3463,3464],{"class":109},"    acc[current.name] ",[85,3466,304],{"class":98},[85,3468,3469],{"class":109}," current.reducer;\n",[85,3471,3472,3474],{"class":87,"line":399},[85,3473,1850],{"class":98},[85,3475,1853],{"class":109},[85,3477,3478,3480,3482,3484,3486,3488,3490,3492],{"class":87,"line":425},[85,3479,1858],{"class":109},[85,3481,210],{"class":98},[85,3483,213],{"class":102},[85,3485,216],{"class":109},[85,3487,219],{"class":123},[85,3489,26],{"class":109},[85,3491,3357],{"class":102},[85,3493,1874],{"class":109},[85,3495,3496],{"class":87,"line":431},[85,3497,92],{"emptyLinePlaceholder":91},[85,3499,3500,3502,3504,3506,3509,3512,3514,3516,3518,3520,3522,3525],{"class":87,"line":437},[85,3501,1753],{"class":98},[85,3503,1885],{"class":123},[85,3505,106],{"class":98},[85,3507,3508],{"class":102}," combineReducers",[85,3510,3511],{"class":109},"(reducersByName) ",[85,3513,210],{"class":98},[85,3515,3120],{"class":102},[85,3517,216],{"class":109},[85,3519,655],{"class":102},[85,3521,26],{"class":109},[85,3523,3524],{"class":102},"Action",[85,3526,2980],{"class":109},[85,3528,3529],{"class":87,"line":442},[85,3530,92],{"emptyLinePlaceholder":91},[85,3532,3533,3535,3538,3540,3543],{"class":87,"line":451},[85,3534,1753],{"class":98},[85,3536,3537],{"class":123}," store",[85,3539,106],{"class":98},[85,3541,3542],{"class":102}," createStore",[85,3544,3545],{"class":109},"(reducer);\n",[85,3547,3548],{"class":87,"line":460},[85,3549,92],{"emptyLinePlaceholder":91},[85,3551,3552,3554],{"class":87,"line":465},[85,3553,1117],{"class":98},[85,3555,110],{"class":109},[85,3557,3558],{"class":87,"line":471},[85,3559,3560],{"class":109},"    store,\n",[85,3562,3563],{"class":87,"line":476},[85,3564,1139],{"class":109},[85,3566,3567],{"class":87,"line":482},[85,3568,930],{"class":109},[15,3570,3571,3572,3575,3576,3578,3579,3582,3583,3585,3586,1466,3588,3590,3591,3593,3594,3596,3597,1466,3599,3601,3602,3604,3605,1466,3607,3609,3610,1466,3612],{},"Чтобы правильно типизировать созданный стор, нужно указать стейт и экшены редьюсера,\nкоторый будет создан при помощи ",[19,3573,3574],{},"combineReducers",".\nМы можем извлечь стейт и экшены из редьюсеров при помощи ",[19,3577,3218],{},".\nВ хелпере ",[19,3580,3581],{},"TypesFromSlices"," мы постепенно проверяем сначала, что ",[19,3584,3178],{}," расширяет массив объектов,\nгде есть два интересующих нас поля - ",[19,3587,1822],{},[19,3589,2464],{},". Мы можем вытащить типы этих полей при помощи ",[19,3592,3218],{},".\nПохожим образом при помощи ",[19,3595,3218],{}," можно вытащить типы ",[19,3598,655],{},[19,3600,3524],{},".\nИз ",[19,3603,3524],{}," в свою очередь можно достать ",[19,3606,1176],{},[19,3608,660],{},".\nПосле этого мы можем вернуть извлеченные типы для ",[19,3611,1801],{},[19,3613,271],{},[10,3615,3617],{"id":3616},"bring-all-together","Собираем все вместе",[75,3619,3622],{"className":77,"code":3620,"filename":3621,"language":80,"meta":81,"style":81},"\nimport { createStore, combineReducers } from 'redux';\nimport type { Store as ReduxStore, Reducer } from 'redux';\nimport { produce } from 'immer';\nimport { useSyncExternalStoreWithSelector } from 'use-sync-external-store/with-selector';\n\ntype SliceActionCreator\u003CState, Payload = any> = (state: State, payload: Payload) => void\n\ntype SliceSelector\u003CState, Payload = any> = (state: State, payload: Payload) => void\n\ntype Scoped\u003CString extends string, Scope extends string> = `${Scope}/${String}`;\n\ntype CreateSliceProps\u003C\n  Name extends string,\n  State extends Record\u003Cstring, unknown>,\n  Actions extends Record\u003Cstring, SliceActionCreator\u003CState>>,\n  Selectors extends Record\u003Cstring, SliceSelector\u003CState>>\n> = {\n  name: Name\n  actions: Actions\n  defaultState: State\n  selectors: Selectors\n}\n\nexport const createSlice = \u003C\n  Name extends string,\n  State extends Record\u003Cstring, unknown>,\n  Actions extends Record\u003Cstring, SliceActionCreator\u003CState>>,\n  ActionKey extends Extract\u003Ckeyof Actions, string>,\n  ScopedActionType extends Scoped\u003CActionKey, Name>,\n  Selectors extends Record\u003Cstring, SliceSelector\u003CState>>,\n  ActionPayload extends Parameters\u003CActions[ActionKey]>[1],\n  Action extends { type: ScopedActionType, payload: ActionPayload },\n>({\n    name,\n    actions,\n    defaultState,\n    selectors,\n  }: CreateSliceProps\u003CName, State, Actions, Selectors>) => {\n  const actionKeys = Object.keys(actions) as ActionKey[];\n  const actionTypeByActionKey = actionKeys.reduce((acc, action) => {\n    const scopedActionType = `${name}/${action}` as ScopedActionType;\n    acc[scopedActionType] = action;\n    return acc;\n  }, {} as Record\u003CScopedActionType, ActionKey>);\n\n  const reducer = (state: State = defaultState, action: Action) => {\n    const nextState = produce(state, draft => {\n      const actionType = actionTypeByActionKey[action.type];\n      actions[actionType]?.(draft as State, action.payload);\n    });\n    return nextState;\n  };\n\n  const sliceActions = actionKeys.reduce((acc, curr) => {\n    acc[curr] = (payload) => {\n      const scopedActionType = `${name}/${curr}` as ScopedActionType;\n\n      return {\n        type: scopedActionType,\n        payload,\n      };\n    };\n    return acc;\n  }, {} as {\n    [ActionKey in Extract\u003Ckeyof Actions, string>]: \u003CP extends Parameters\u003CActions[ActionKey]>[1]>(payload: P) => { type: Scoped\u003CActionKey, Name>, payload: P }\n  });\n\n  return {\n    name,\n    reducer,\n    actions: sliceActions,\n    selectors: selectors,\n  };\n};\n\ntype SliceAction\u003CType extends string = string, Payload = unknown> = {\n  type: Type,\n  payload: Payload,\n}\n\ntype SimpleSlice\u003CName extends string, ReducerType extends Reducer\u003Cany, any>> = {\n  name: Name;\n  reducer: ReducerType,\n}\n\ntype TypesFromSlices\u003CT> = T extends { name: infer Name extends string, reducer: Reducer\u003Cinfer State, infer Action> }[]\n  ? Action extends SliceAction\u003Cinfer Type, infer Payload>\n  ? {\n    action: SliceAction\u003CType, Payload>,\n    state: { [P in Name]: State }\n  } : never : never\n\nexport const configureStore = \u003C\n  Slice extends SimpleSlice\u003Cstring, Reducer\u003Cany, any, any>>,\n  State extends TypesFromSlices\u003CSlice[]>['state'],\n  Action extends TypesFromSlices\u003CSlice[]>['action'],\n>(slices: Slice[]) => {\n  const reducersByName = slices.reduce((acc, current) => {\n    acc[current.name] = current.reducer;\n    return acc;\n  }, {} as Record\u003Cstring, Reducer>);\n\n  const reducer = combineReducers(reducersByName) as Reducer\u003CState, Action>;\n\n  const store = createStore(reducer);\n\n  return {\n    store,\n  };\n};\n\nexport const createUseSelector = \u003C\n  Store extends ReduxStore,\n  State extends ReturnType\u003CStore['getState']>,\n>(store: Store) => {\n  const useSelector = \u003CSelector extends (state: State) => unknown>(selector: Selector) => {\n    return useSyncExternalStoreWithSelector(\n      store.subscribe,\n      store.getState,\n      store.getState,\n      selector\n    ) as ReturnType\u003CSelector>;\n  };\n\n  return useSelector;\n};\n\n","myReduxToolkit.ts",[19,3623,3624,3628,3641,3660,3674,3686,3690,3735,3739,3783,3787,3825,3829,3837,3847,3865,3887,3909,3917,3926,3935,3944,3953,3957,3961,3973,3983,4001,4023,4043,4061,4083,4105,4129,4133,4137,4141,4145,4149,4179,4199,4225,4249,4257,4263,4281,4285,4317,4335,4345,4355,4360,4367,4372,4377,4404,4421,4446,4451,4458,4463,4468,4473,4478,4485,4494,4578,4583,4588,4595,4600,4605,4610,4616,4621,4626,4631,4664,4675,4686,4691,4696,4733,4744,4755,4760,4765,4820,4845,4852,4871,4894,4907,4912,4925,4956,4975,4994,5011,5038,5047,5054,5073,5078,5105,5110,5123,5128,5135,5140,5145,5150,5155,5168,5179,5198,5215,5258,5267,5272,5277,5282,5287,5302,5307,5312,5319],{"__ignoreMap":81},[85,3625,3626],{"class":87,"line":88},[85,3627,92],{"emptyLinePlaceholder":91},[85,3629,3630,3632,3635,3637,3639],{"class":87,"line":95},[85,3631,2787],{"class":98},[85,3633,3634],{"class":109}," { createStore, combineReducers } ",[85,3636,2801],{"class":98},[85,3638,2804],{"class":191},[85,3640,127],{"class":109},[85,3642,3643,3645,3647,3649,3651,3654,3656,3658],{"class":87,"line":113},[85,3644,2787],{"class":98},[85,3646,2790],{"class":98},[85,3648,2793],{"class":109},[85,3650,210],{"class":98},[85,3652,3653],{"class":109}," ReduxStore, Reducer } ",[85,3655,2801],{"class":98},[85,3657,2804],{"class":191},[85,3659,127],{"class":109},[85,3661,3662,3664,3667,3669,3672],{"class":87,"line":130},[85,3663,2787],{"class":98},[85,3665,3666],{"class":109}," { produce } ",[85,3668,2801],{"class":98},[85,3670,3671],{"class":191}," 'immer'",[85,3673,127],{"class":109},[85,3675,3676,3678,3680,3682,3684],{"class":87,"line":142},[85,3677,2787],{"class":98},[85,3679,2813],{"class":109},[85,3681,2801],{"class":98},[85,3683,2818],{"class":191},[85,3685,127],{"class":109},[85,3687,3688],{"class":87,"line":154},[85,3689,92],{"emptyLinePlaceholder":91},[85,3691,3692,3694,3696,3698,3700,3702,3704,3706,3708,3710,3712,3714,3716,3718,3720,3722,3724,3726,3728,3730,3732],{"class":87,"line":160},[85,3693,99],{"class":98},[85,3695,650],{"class":102},[85,3697,216],{"class":109},[85,3699,655],{"class":102},[85,3701,26],{"class":109},[85,3703,660],{"class":102},[85,3705,106],{"class":98},[85,3707,665],{"class":123},[85,3709,668],{"class":109},[85,3711,304],{"class":98},[85,3713,1380],{"class":109},[85,3715,271],{"class":116},[85,3717,120],{"class":98},[85,3719,683],{"class":102},[85,3721,26],{"class":109},[85,3723,1159],{"class":116},[85,3725,120],{"class":98},[85,3727,1220],{"class":102},[85,3729,283],{"class":109},[85,3731,286],{"class":98},[85,3733,3734],{"class":123}," void\n",[85,3736,3737],{"class":87,"line":165},[85,3738,92],{"emptyLinePlaceholder":91},[85,3740,3741,3743,3745,3747,3749,3751,3753,3755,3757,3759,3761,3763,3765,3767,3769,3771,3773,3775,3777,3779,3781],{"class":87,"line":185},[85,3742,99],{"class":98},[85,3744,717],{"class":102},[85,3746,216],{"class":109},[85,3748,655],{"class":102},[85,3750,26],{"class":109},[85,3752,660],{"class":102},[85,3754,106],{"class":98},[85,3756,665],{"class":123},[85,3758,668],{"class":109},[85,3760,304],{"class":98},[85,3762,1380],{"class":109},[85,3764,271],{"class":116},[85,3766,120],{"class":98},[85,3768,683],{"class":102},[85,3770,26],{"class":109},[85,3772,1159],{"class":116},[85,3774,120],{"class":98},[85,3776,1220],{"class":102},[85,3778,283],{"class":109},[85,3780,286],{"class":98},[85,3782,3734],{"class":123},[85,3784,3785],{"class":87,"line":198},[85,3786,92],{"emptyLinePlaceholder":91},[85,3788,3789,3791,3793,3795,3797,3799,3801,3803,3805,3807,3809,3811,3813,3815,3817,3819,3821,3823],{"class":87,"line":204},[85,3790,99],{"class":98},[85,3792,1496],{"class":102},[85,3794,216],{"class":109},[85,3796,1501],{"class":102},[85,3798,796],{"class":98},[85,3800,124],{"class":123},[85,3802,26],{"class":109},[85,3804,1510],{"class":102},[85,3806,796],{"class":98},[85,3808,124],{"class":123},[85,3810,668],{"class":109},[85,3812,304],{"class":98},[85,3814,1521],{"class":191},[85,3816,1510],{"class":102},[85,3818,1526],{"class":191},[85,3820,1501],{"class":102},[85,3822,1531],{"class":191},[85,3824,127],{"class":109},[85,3826,3827],{"class":87,"line":230},[85,3828,92],{"emptyLinePlaceholder":91},[85,3830,3831,3833,3835],{"class":87,"line":250},[85,3832,99],{"class":98},[85,3834,785],{"class":102},[85,3836,788],{"class":109},[85,3838,3839,3841,3843,3845],{"class":87,"line":256},[85,3840,793],{"class":102},[85,3842,796],{"class":98},[85,3844,124],{"class":123},[85,3846,195],{"class":109},[85,3848,3849,3851,3853,3855,3857,3859,3861,3863],{"class":87,"line":262},[85,3850,805],{"class":102},[85,3852,796],{"class":98},[85,3854,213],{"class":102},[85,3856,216],{"class":109},[85,3858,219],{"class":123},[85,3860,26],{"class":109},[85,3862,818],{"class":123},[85,3864,227],{"class":109},[85,3866,3867,3869,3871,3873,3875,3877,3879,3881,3883,3885],{"class":87,"line":291},[85,3868,825],{"class":102},[85,3870,796],{"class":98},[85,3872,213],{"class":102},[85,3874,216],{"class":109},[85,3876,219],{"class":123},[85,3878,26],{"class":109},[85,3880,838],{"class":102},[85,3882,216],{"class":109},[85,3884,655],{"class":102},[85,3886,845],{"class":109},[85,3888,3889,3891,3893,3895,3897,3899,3901,3903,3905,3907],{"class":87,"line":298},[85,3890,850],{"class":102},[85,3892,796],{"class":98},[85,3894,213],{"class":102},[85,3896,216],{"class":109},[85,3898,219],{"class":123},[85,3900,26],{"class":109},[85,3902,863],{"class":102},[85,3904,216],{"class":109},[85,3906,655],{"class":102},[85,3908,870],{"class":109},[85,3910,3911,3913,3915],{"class":87,"line":310},[85,3912,668],{"class":109},[85,3914,304],{"class":98},[85,3916,110],{"class":109},[85,3918,3919,3921,3923],{"class":87,"line":321},[85,3920,883],{"class":116},[85,3922,120],{"class":98},[85,3924,3925],{"class":102}," Name\n",[85,3927,3928,3930,3932],{"class":87,"line":327},[85,3929,895],{"class":116},[85,3931,120],{"class":98},[85,3933,3934],{"class":102}," Actions\n",[85,3936,3937,3939,3941],{"class":87,"line":352},[85,3938,907],{"class":116},[85,3940,120],{"class":98},[85,3942,3943],{"class":102}," State\n",[85,3945,3946,3948,3950],{"class":87,"line":366},[85,3947,918],{"class":116},[85,3949,120],{"class":98},[85,3951,3952],{"class":102}," Selectors\n",[85,3954,3955],{"class":87,"line":375},[85,3956,157],{"class":109},[85,3958,3959],{"class":87,"line":382},[85,3960,92],{"emptyLinePlaceholder":91},[85,3962,3963,3965,3967,3969,3971],{"class":87,"line":388},[85,3964,168],{"class":98},[85,3966,171],{"class":98},[85,3968,179],{"class":102},[85,3970,106],{"class":98},[85,3972,947],{"class":109},[85,3974,3975,3977,3979,3981],{"class":87,"line":393},[85,3976,793],{"class":102},[85,3978,796],{"class":98},[85,3980,124],{"class":123},[85,3982,195],{"class":109},[85,3984,3985,3987,3989,3991,3993,3995,3997,3999],{"class":87,"line":399},[85,3986,805],{"class":102},[85,3988,796],{"class":98},[85,3990,213],{"class":102},[85,3992,216],{"class":109},[85,3994,219],{"class":123},[85,3996,26],{"class":109},[85,3998,818],{"class":123},[85,4000,227],{"class":109},[85,4002,4003,4005,4007,4009,4011,4013,4015,4017,4019,4021],{"class":87,"line":425},[85,4004,825],{"class":102},[85,4006,796],{"class":98},[85,4008,213],{"class":102},[85,4010,216],{"class":109},[85,4012,219],{"class":123},[85,4014,26],{"class":109},[85,4016,838],{"class":102},[85,4018,216],{"class":109},[85,4020,655],{"class":102},[85,4022,845],{"class":109},[85,4024,4025,4027,4029,4031,4033,4035,4037,4039,4041],{"class":87,"line":431},[85,4026,1604],{"class":102},[85,4028,796],{"class":98},[85,4030,1609],{"class":102},[85,4032,216],{"class":109},[85,4034,1614],{"class":98},[85,4036,900],{"class":102},[85,4038,26],{"class":109},[85,4040,219],{"class":123},[85,4042,227],{"class":109},[85,4044,4045,4047,4049,4051,4053,4055,4057,4059],{"class":87,"line":437},[85,4046,1627],{"class":102},[85,4048,796],{"class":98},[85,4050,1496],{"class":102},[85,4052,216],{"class":109},[85,4054,1465],{"class":102},[85,4056,26],{"class":109},[85,4058,1058],{"class":102},[85,4060,227],{"class":109},[85,4062,4063,4065,4067,4069,4071,4073,4075,4077,4079,4081],{"class":87,"line":442},[85,4064,850],{"class":102},[85,4066,796],{"class":98},[85,4068,213],{"class":102},[85,4070,216],{"class":109},[85,4072,219],{"class":123},[85,4074,26],{"class":109},[85,4076,863],{"class":102},[85,4078,216],{"class":109},[85,4080,655],{"class":102},[85,4082,845],{"class":109},[85,4084,4085,4087,4089,4091,4093,4095,4097,4099,4101,4103],{"class":87,"line":451},[85,4086,1646],{"class":102},[85,4088,796],{"class":98},[85,4090,1651],{"class":102},[85,4092,216],{"class":109},[85,4094,1067],{"class":102},[85,4096,1658],{"class":109},[85,4098,1465],{"class":102},[85,4100,1663],{"class":109},[85,4102,1666],{"class":123},[85,4104,1669],{"class":109},[85,4106,4107,4109,4111,4113,4115,4117,4119,4121,4123,4125,4127],{"class":87,"line":460},[85,4108,1674],{"class":102},[85,4110,796],{"class":98},[85,4112,1679],{"class":109},[85,4114,99],{"class":116},[85,4116,120],{"class":98},[85,4118,1686],{"class":102},[85,4120,26],{"class":109},[85,4122,1159],{"class":116},[85,4124,120],{"class":98},[85,4126,1695],{"class":102},[85,4128,1698],{"class":109},[85,4130,4131],{"class":87,"line":465},[85,4132,1024],{"class":109},[85,4134,4135],{"class":87,"line":471},[85,4136,1029],{"class":109},[85,4138,4139],{"class":87,"line":476},[85,4140,1034],{"class":109},[85,4142,4143],{"class":87,"line":482},[85,4144,1039],{"class":109},[85,4146,4147],{"class":87,"line":487},[85,4148,1044],{"class":109},[85,4150,4151,4153,4155,4157,4159,4161,4163,4165,4167,4169,4171,4173,4175,4177],{"class":87,"line":493},[85,4152,1049],{"class":109},[85,4154,120],{"class":98},[85,4156,785],{"class":102},[85,4158,216],{"class":109},[85,4160,1058],{"class":102},[85,4162,26],{"class":109},[85,4164,655],{"class":102},[85,4166,26],{"class":109},[85,4168,1067],{"class":102},[85,4170,26],{"class":109},[85,4172,1072],{"class":102},[85,4174,1075],{"class":109},[85,4176,286],{"class":98},[85,4178,110],{"class":109},[85,4180,4181,4183,4185,4187,4189,4191,4193,4195,4197],{"class":87,"line":529},[85,4182,1753],{"class":98},[85,4184,1756],{"class":123},[85,4186,106],{"class":98},[85,4188,1761],{"class":109},[85,4190,1764],{"class":102},[85,4192,1767],{"class":109},[85,4194,210],{"class":98},[85,4196,1772],{"class":102},[85,4198,1775],{"class":109},[85,4200,4201,4203,4205,4207,4209,4211,4213,4215,4217,4219,4221,4223],{"class":87,"line":534},[85,4202,1753],{"class":98},[85,4204,1782],{"class":123},[85,4206,106],{"class":98},[85,4208,1787],{"class":109},[85,4210,1790],{"class":102},[85,4212,1793],{"class":109},[85,4214,1796],{"class":116},[85,4216,26],{"class":109},[85,4218,1801],{"class":116},[85,4220,283],{"class":109},[85,4222,286],{"class":98},[85,4224,110],{"class":109},[85,4226,4227,4229,4231,4233,4235,4237,4239,4241,4243,4245,4247],{"class":87,"line":554},[85,4228,1812],{"class":98},[85,4230,1815],{"class":123},[85,4232,106],{"class":98},[85,4234,1521],{"class":191},[85,4236,1822],{"class":109},[85,4238,1526],{"class":191},[85,4240,1801],{"class":109},[85,4242,1531],{"class":191},[85,4244,1831],{"class":98},[85,4246,1686],{"class":102},[85,4248,127],{"class":109},[85,4250,4251,4253,4255],{"class":87,"line":563},[85,4252,1840],{"class":109},[85,4254,304],{"class":98},[85,4256,1845],{"class":109},[85,4258,4259,4261],{"class":87,"line":569},[85,4260,1850],{"class":98},[85,4262,1853],{"class":109},[85,4264,4265,4267,4269,4271,4273,4275,4277,4279],{"class":87,"line":580},[85,4266,1858],{"class":109},[85,4268,210],{"class":98},[85,4270,213],{"class":102},[85,4272,216],{"class":109},[85,4274,1867],{"class":102},[85,4276,26],{"class":109},[85,4278,1465],{"class":102},[85,4280,1874],{"class":109},[85,4282,4283],{"class":87,"line":591},[85,4284,92],{"emptyLinePlaceholder":91},[85,4286,4287,4289,4291,4293,4295,4297,4299,4301,4303,4305,4307,4309,4311,4313,4315],{"class":87,"line":602},[85,4288,1753],{"class":98},[85,4290,1885],{"class":102},[85,4292,106],{"class":98},[85,4294,1380],{"class":109},[85,4296,271],{"class":116},[85,4298,120],{"class":98},[85,4300,683],{"class":102},[85,4302,106],{"class":98},[85,4304,1900],{"class":109},[85,4306,1801],{"class":116},[85,4308,120],{"class":98},[85,4310,1171],{"class":102},[85,4312,283],{"class":109},[85,4314,286],{"class":98},[85,4316,110],{"class":109},[85,4318,4319,4321,4323,4325,4327,4329,4331,4333],{"class":87,"line":613},[85,4320,1812],{"class":98},[85,4322,1919],{"class":123},[85,4324,106],{"class":98},[85,4326,1924],{"class":102},[85,4328,1927],{"class":109},[85,4330,1930],{"class":116},[85,4332,511],{"class":98},[85,4334,110],{"class":109},[85,4336,4337,4339,4341,4343],{"class":87,"line":619},[85,4338,355],{"class":98},[85,4340,1941],{"class":123},[85,4342,106],{"class":98},[85,4344,1946],{"class":109},[85,4346,4347,4349,4351,4353],{"class":87,"line":625},[85,4348,1951],{"class":109},[85,4350,210],{"class":98},[85,4352,683],{"class":102},[85,4354,1958],{"class":109},[85,4356,4358],{"class":87,"line":4357},51,[85,4359,1963],{"class":109},[85,4361,4363,4365],{"class":87,"line":4362},52,[85,4364,1850],{"class":98},[85,4366,1970],{"class":109},[85,4368,4370],{"class":87,"line":4369},53,[85,4371,1139],{"class":109},[85,4373,4375],{"class":87,"line":4374},54,[85,4376,92],{"emptyLinePlaceholder":91},[85,4378,4380,4382,4384,4386,4388,4390,4392,4394,4396,4398,4400,4402],{"class":87,"line":4379},55,[85,4381,1753],{"class":98},[85,4383,1985],{"class":123},[85,4385,106],{"class":98},[85,4387,1787],{"class":109},[85,4389,1790],{"class":102},[85,4391,1793],{"class":109},[85,4393,1796],{"class":116},[85,4395,26],{"class":109},[85,4397,2000],{"class":116},[85,4399,283],{"class":109},[85,4401,286],{"class":98},[85,4403,110],{"class":109},[85,4405,4407,4409,4411,4413,4415,4417,4419],{"class":87,"line":4406},56,[85,4408,2011],{"class":109},[85,4410,304],{"class":98},[85,4412,1380],{"class":109},[85,4414,1159],{"class":116},[85,4416,283],{"class":109},[85,4418,286],{"class":98},[85,4420,110],{"class":109},[85,4422,4424,4426,4428,4430,4432,4434,4436,4438,4440,4442,4444],{"class":87,"line":4423},57,[85,4425,355],{"class":98},[85,4427,1815],{"class":123},[85,4429,106],{"class":98},[85,4431,1521],{"class":191},[85,4433,1822],{"class":109},[85,4435,1526],{"class":191},[85,4437,2000],{"class":109},[85,4439,1531],{"class":191},[85,4441,1831],{"class":98},[85,4443,1686],{"class":102},[85,4445,127],{"class":109},[85,4447,4449],{"class":87,"line":4448},58,[85,4450,92],{"emptyLinePlaceholder":91},[85,4452,4454,4456],{"class":87,"line":4453},59,[85,4455,2056],{"class":98},[85,4457,110],{"class":109},[85,4459,4461],{"class":87,"line":4460},60,[85,4462,2063],{"class":109},[85,4464,4466],{"class":87,"line":4465},61,[85,4467,2068],{"class":109},[85,4469,4471],{"class":87,"line":4470},62,[85,4472,2073],{"class":109},[85,4474,4476],{"class":87,"line":4475},63,[85,4477,2078],{"class":109},[85,4479,4481,4483],{"class":87,"line":4480},64,[85,4482,1850],{"class":98},[85,4484,1853],{"class":109},[85,4486,4488,4490,4492],{"class":87,"line":4487},65,[85,4489,1858],{"class":109},[85,4491,210],{"class":98},[85,4493,110],{"class":109},[85,4495,4497,4499,4501,4503,4505,4507,4509,4511,4513,4515,4517,4519,4521,4523,4525,4527,4529,4531,4533,4535,4537,4539,4542,4544,4546,4548,4550,4552,4554,4556,4558,4560,4562,4564,4566,4568,4570,4572,4574,4576],{"class":87,"line":4496},66,[85,4498,2097],{"class":109},[85,4500,1465],{"class":102},[85,4502,2102],{"class":98},[85,4504,1609],{"class":102},[85,4506,216],{"class":109},[85,4508,1614],{"class":98},[85,4510,900],{"class":102},[85,4512,26],{"class":109},[85,4514,219],{"class":123},[85,4516,2117],{"class":109},[85,4518,120],{"class":98},[85,4520,2901],{"class":109},[85,4522,3293],{"class":102},[85,4524,796],{"class":98},[85,4526,1651],{"class":102},[85,4528,216],{"class":109},[85,4530,1067],{"class":102},[85,4532,1658],{"class":109},[85,4534,1465],{"class":102},[85,4536,1663],{"class":109},[85,4538,1666],{"class":123},[85,4540,4541],{"class":109},"]>(",[85,4543,1159],{"class":116},[85,4545,120],{"class":98},[85,4547,2170],{"class":102},[85,4549,283],{"class":109},[85,4551,286],{"class":98},[85,4553,1679],{"class":109},[85,4555,99],{"class":116},[85,4557,120],{"class":98},[85,4559,1496],{"class":102},[85,4561,216],{"class":109},[85,4563,1465],{"class":102},[85,4565,26],{"class":109},[85,4567,1058],{"class":102},[85,4569,2163],{"class":109},[85,4571,1159],{"class":116},[85,4573,120],{"class":98},[85,4575,2170],{"class":102},[85,4577,2173],{"class":109},[85,4579,4581],{"class":87,"line":4580},67,[85,4582,2178],{"class":109},[85,4584,4586],{"class":87,"line":4585},68,[85,4587,92],{"emptyLinePlaceholder":91},[85,4589,4591,4593],{"class":87,"line":4590},69,[85,4592,1117],{"class":98},[85,4594,110],{"class":109},[85,4596,4598],{"class":87,"line":4597},70,[85,4599,1029],{"class":109},[85,4601,4603],{"class":87,"line":4602},71,[85,4604,1124],{"class":109},[85,4606,4608],{"class":87,"line":4607},72,[85,4609,1134],{"class":109},[85,4611,4613],{"class":87,"line":4612},73,[85,4614,4615],{"class":109},"    selectors: selectors,\n",[85,4617,4619],{"class":87,"line":4618},74,[85,4620,1139],{"class":109},[85,4622,4624],{"class":87,"line":4623},75,[85,4625,930],{"class":109},[85,4627,4629],{"class":87,"line":4628},76,[85,4630,92],{"emptyLinePlaceholder":91},[85,4632,4634,4636,4638,4640,4642,4644,4646,4648,4650,4652,4654,4656,4658,4660,4662],{"class":87,"line":4633},77,[85,4635,99],{"class":98},[85,4637,3041],{"class":102},[85,4639,216],{"class":109},[85,4641,1176],{"class":102},[85,4643,796],{"class":98},[85,4645,124],{"class":123},[85,4647,106],{"class":98},[85,4649,124],{"class":123},[85,4651,26],{"class":109},[85,4653,660],{"class":102},[85,4655,106],{"class":98},[85,4657,730],{"class":123},[85,4659,668],{"class":109},[85,4661,304],{"class":98},[85,4663,110],{"class":109},[85,4665,4667,4669,4671,4673],{"class":87,"line":4666},78,[85,4668,1203],{"class":116},[85,4670,120],{"class":98},[85,4672,1208],{"class":102},[85,4674,195],{"class":109},[85,4676,4678,4680,4682,4684],{"class":87,"line":4677},79,[85,4679,690],{"class":116},[85,4681,120],{"class":98},[85,4683,1220],{"class":102},[85,4685,195],{"class":109},[85,4687,4689],{"class":87,"line":4688},80,[85,4690,157],{"class":109},[85,4692,4694],{"class":87,"line":4693},81,[85,4695,92],{"emptyLinePlaceholder":91},[85,4697,4699,4701,4703,4705,4707,4709,4711,4713,4715,4717,4719,4721,4723,4725,4727,4729,4731],{"class":87,"line":4698},82,[85,4700,99],{"class":98},[85,4702,3102],{"class":102},[85,4704,216],{"class":109},[85,4706,1058],{"class":102},[85,4708,796],{"class":98},[85,4710,124],{"class":123},[85,4712,26],{"class":109},[85,4714,3115],{"class":102},[85,4716,796],{"class":98},[85,4718,3120],{"class":102},[85,4720,216],{"class":109},[85,4722,3125],{"class":123},[85,4724,26],{"class":109},[85,4726,3125],{"class":123},[85,4728,3132],{"class":109},[85,4730,304],{"class":98},[85,4732,110],{"class":109},[85,4734,4736,4738,4740,4742],{"class":87,"line":4735},83,[85,4737,883],{"class":116},[85,4739,120],{"class":98},[85,4741,888],{"class":102},[85,4743,127],{"class":109},[85,4745,4747,4749,4751,4753],{"class":87,"line":4746},84,[85,4748,3151],{"class":116},[85,4750,120],{"class":98},[85,4752,3156],{"class":102},[85,4754,195],{"class":109},[85,4756,4758],{"class":87,"line":4757},85,[85,4759,157],{"class":109},[85,4761,4763],{"class":87,"line":4762},86,[85,4764,92],{"emptyLinePlaceholder":91},[85,4766,4768,4770,4772,4774,4776,4778,4780,4782,4784,4786,4788,4790,4792,4794,4796,4798,4800,4802,4804,4806,4808,4810,4812,4814,4816,4818],{"class":87,"line":4767},87,[85,4769,99],{"class":98},[85,4771,3173],{"class":102},[85,4773,216],{"class":109},[85,4775,3178],{"class":102},[85,4777,668],{"class":109},[85,4779,304],{"class":98},[85,4781,3185],{"class":102},[85,4783,796],{"class":98},[85,4785,1679],{"class":109},[85,4787,1822],{"class":116},[85,4789,120],{"class":98},[85,4791,3199],{"class":98},[85,4793,888],{"class":102},[85,4795,796],{"class":98},[85,4797,124],{"class":123},[85,4799,26],{"class":109},[85,4801,2464],{"class":116},[85,4803,120],{"class":98},[85,4805,3120],{"class":102},[85,4807,216],{"class":109},[85,4809,3218],{"class":98},[85,4811,683],{"class":102},[85,4813,26],{"class":109},[85,4815,3218],{"class":98},[85,4817,1171],{"class":102},[85,4819,3229],{"class":109},[85,4821,4823,4825,4827,4829,4831,4833,4835,4837,4839,4841,4843],{"class":87,"line":4822},88,[85,4824,3234],{"class":98},[85,4826,1171],{"class":102},[85,4828,796],{"class":98},[85,4830,3041],{"class":102},[85,4832,216],{"class":109},[85,4834,3218],{"class":98},[85,4836,1208],{"class":102},[85,4838,26],{"class":109},[85,4840,3218],{"class":98},[85,4842,1220],{"class":102},[85,4844,3255],{"class":109},[85,4846,4848,4850],{"class":87,"line":4847},89,[85,4849,3234],{"class":98},[85,4851,110],{"class":109},[85,4853,4855,4857,4859,4861,4863,4865,4867,4869],{"class":87,"line":4854},90,[85,4856,3266],{"class":116},[85,4858,120],{"class":98},[85,4860,3041],{"class":102},[85,4862,216],{"class":109},[85,4864,1176],{"class":102},[85,4866,26],{"class":109},[85,4868,660],{"class":102},[85,4870,227],{"class":109},[85,4872,4874,4876,4878,4880,4882,4884,4886,4888,4890,4892],{"class":87,"line":4873},91,[85,4875,3285],{"class":116},[85,4877,120],{"class":98},[85,4879,3290],{"class":109},[85,4881,3293],{"class":102},[85,4883,2102],{"class":98},[85,4885,888],{"class":102},[85,4887,3300],{"class":109},[85,4889,120],{"class":98},[85,4891,683],{"class":102},[85,4893,2173],{"class":109},[85,4895,4897,4899,4901,4903,4905],{"class":87,"line":4896},92,[85,4898,3311],{"class":109},[85,4900,120],{"class":98},[85,4902,3316],{"class":123},[85,4904,3319],{"class":98},[85,4906,3322],{"class":123},[85,4908,4910],{"class":87,"line":4909},93,[85,4911,92],{"emptyLinePlaceholder":91},[85,4913,4915,4917,4919,4921,4923],{"class":87,"line":4914},94,[85,4916,168],{"class":98},[85,4918,171],{"class":98},[85,4920,3335],{"class":102},[85,4922,106],{"class":98},[85,4924,947],{"class":109},[85,4926,4928,4930,4932,4934,4936,4938,4940,4942,4944,4946,4948,4950,4952,4954],{"class":87,"line":4927},95,[85,4929,3344],{"class":102},[85,4931,796],{"class":98},[85,4933,3102],{"class":102},[85,4935,216],{"class":109},[85,4937,219],{"class":123},[85,4939,26],{"class":109},[85,4941,3357],{"class":102},[85,4943,216],{"class":109},[85,4945,3125],{"class":123},[85,4947,26],{"class":109},[85,4949,3125],{"class":123},[85,4951,26],{"class":109},[85,4953,3125],{"class":123},[85,4955,845],{"class":109},[85,4957,4959,4961,4963,4965,4967,4969,4971,4973],{"class":87,"line":4958},96,[85,4960,805],{"class":102},[85,4962,796],{"class":98},[85,4964,3173],{"class":102},[85,4966,216],{"class":109},[85,4968,3384],{"class":102},[85,4970,3387],{"class":109},[85,4972,3390],{"class":191},[85,4974,1669],{"class":109},[85,4976,4978,4980,4982,4984,4986,4988,4990,4992],{"class":87,"line":4977},97,[85,4979,1674],{"class":102},[85,4981,796],{"class":98},[85,4983,3173],{"class":102},[85,4985,216],{"class":109},[85,4987,3384],{"class":102},[85,4989,3387],{"class":109},[85,4991,3409],{"class":191},[85,4993,1669],{"class":109},[85,4995,4997,4999,5001,5003,5005,5007,5009],{"class":87,"line":4996},98,[85,4998,2876],{"class":109},[85,5000,3418],{"class":116},[85,5002,120],{"class":98},[85,5004,3423],{"class":102},[85,5006,3426],{"class":109},[85,5008,286],{"class":98},[85,5010,110],{"class":109},[85,5012,5014,5016,5018,5020,5022,5024,5026,5028,5030,5032,5034,5036],{"class":87,"line":5013},99,[85,5015,1753],{"class":98},[85,5017,3437],{"class":123},[85,5019,106],{"class":98},[85,5021,3442],{"class":109},[85,5023,1790],{"class":102},[85,5025,1793],{"class":109},[85,5027,1796],{"class":116},[85,5029,26],{"class":109},[85,5031,3453],{"class":116},[85,5033,283],{"class":109},[85,5035,286],{"class":98},[85,5037,110],{"class":109},[85,5039,5041,5043,5045],{"class":87,"line":5040},100,[85,5042,3464],{"class":109},[85,5044,304],{"class":98},[85,5046,3469],{"class":109},[85,5048,5050,5052],{"class":87,"line":5049},101,[85,5051,1850],{"class":98},[85,5053,1853],{"class":109},[85,5055,5057,5059,5061,5063,5065,5067,5069,5071],{"class":87,"line":5056},102,[85,5058,1858],{"class":109},[85,5060,210],{"class":98},[85,5062,213],{"class":102},[85,5064,216],{"class":109},[85,5066,219],{"class":123},[85,5068,26],{"class":109},[85,5070,3357],{"class":102},[85,5072,1874],{"class":109},[85,5074,5076],{"class":87,"line":5075},103,[85,5077,92],{"emptyLinePlaceholder":91},[85,5079,5081,5083,5085,5087,5089,5091,5093,5095,5097,5099,5101,5103],{"class":87,"line":5080},104,[85,5082,1753],{"class":98},[85,5084,1885],{"class":123},[85,5086,106],{"class":98},[85,5088,3508],{"class":102},[85,5090,3511],{"class":109},[85,5092,210],{"class":98},[85,5094,3120],{"class":102},[85,5096,216],{"class":109},[85,5098,655],{"class":102},[85,5100,26],{"class":109},[85,5102,3524],{"class":102},[85,5104,2980],{"class":109},[85,5106,5108],{"class":87,"line":5107},105,[85,5109,92],{"emptyLinePlaceholder":91},[85,5111,5113,5115,5117,5119,5121],{"class":87,"line":5112},106,[85,5114,1753],{"class":98},[85,5116,3537],{"class":123},[85,5118,106],{"class":98},[85,5120,3542],{"class":102},[85,5122,3545],{"class":109},[85,5124,5126],{"class":87,"line":5125},107,[85,5127,92],{"emptyLinePlaceholder":91},[85,5129,5131,5133],{"class":87,"line":5130},108,[85,5132,1117],{"class":98},[85,5134,110],{"class":109},[85,5136,5138],{"class":87,"line":5137},109,[85,5139,3560],{"class":109},[85,5141,5143],{"class":87,"line":5142},110,[85,5144,1139],{"class":109},[85,5146,5148],{"class":87,"line":5147},111,[85,5149,930],{"class":109},[85,5151,5153],{"class":87,"line":5152},112,[85,5154,92],{"emptyLinePlaceholder":91},[85,5156,5158,5160,5162,5164,5166],{"class":87,"line":5157},113,[85,5159,168],{"class":98},[85,5161,171],{"class":98},[85,5163,2833],{"class":102},[85,5165,106],{"class":98},[85,5167,947],{"class":109},[85,5169,5171,5173,5175,5177],{"class":87,"line":5170},114,[85,5172,2842],{"class":102},[85,5174,796],{"class":98},[85,5176,2847],{"class":102},[85,5178,195],{"class":109},[85,5180,5182,5184,5186,5188,5190,5192,5194,5196],{"class":87,"line":5181},115,[85,5183,805],{"class":102},[85,5185,796],{"class":98},[85,5187,2858],{"class":102},[85,5189,216],{"class":109},[85,5191,2863],{"class":102},[85,5193,1658],{"class":109},[85,5195,2868],{"class":191},[85,5197,2871],{"class":109},[85,5199,5201,5203,5205,5207,5209,5211,5213],{"class":87,"line":5200},116,[85,5202,2876],{"class":109},[85,5204,2879],{"class":116},[85,5206,120],{"class":98},[85,5208,2884],{"class":102},[85,5210,283],{"class":109},[85,5212,286],{"class":98},[85,5214,110],{"class":109},[85,5216,5218,5220,5222,5224,5226,5228,5230,5232,5234,5236,5238,5240,5242,5244,5246,5248,5250,5252,5254,5256],{"class":87,"line":5217},117,[85,5219,1753],{"class":98},[85,5221,503],{"class":102},[85,5223,106],{"class":98},[85,5225,2901],{"class":109},[85,5227,2904],{"class":102},[85,5229,796],{"class":98},[85,5231,1380],{"class":109},[85,5233,271],{"class":116},[85,5235,120],{"class":98},[85,5237,683],{"class":102},[85,5239,283],{"class":109},[85,5241,286],{"class":98},[85,5243,730],{"class":123},[85,5245,2876],{"class":109},[85,5247,2925],{"class":116},[85,5249,120],{"class":98},[85,5251,2930],{"class":102},[85,5253,283],{"class":109},[85,5255,286],{"class":98},[85,5257,110],{"class":109},[85,5259,5261,5263,5265],{"class":87,"line":5260},118,[85,5262,1850],{"class":98},[85,5264,2943],{"class":102},[85,5266,560],{"class":109},[85,5268,5270],{"class":87,"line":5269},119,[85,5271,2950],{"class":109},[85,5273,5275],{"class":87,"line":5274},120,[85,5276,2955],{"class":109},[85,5278,5280],{"class":87,"line":5279},121,[85,5281,2955],{"class":109},[85,5283,5285],{"class":87,"line":5284},122,[85,5286,2964],{"class":109},[85,5288,5290,5292,5294,5296,5298,5300],{"class":87,"line":5289},123,[85,5291,2969],{"class":109},[85,5293,210],{"class":98},[85,5295,2858],{"class":102},[85,5297,216],{"class":109},[85,5299,2904],{"class":102},[85,5301,2980],{"class":109},[85,5303,5305],{"class":87,"line":5304},124,[85,5306,1139],{"class":109},[85,5308,5310],{"class":87,"line":5309},125,[85,5311,92],{"emptyLinePlaceholder":91},[85,5313,5315,5317],{"class":87,"line":5314},126,[85,5316,1117],{"class":98},[85,5318,2995],{"class":109},[85,5320,5322],{"class":87,"line":5321},127,[85,5323,930],{"class":109},[75,5325,5328],{"className":77,"code":5326,"filename":5327,"language":80,"meta":81,"style":81},"import { createSlice } from \"@/myReduxToolkit\";\n\ntype User = {\n  id: string;\n  username: string;\n  displayName: string;\n}\n\nexport const usersSlice = createSlice({\n  name: 'users',\n  defaultState: {\n    userById: {} as Record\u003Cstring, User>,\n    usernameById: {} as Record\u003Cstring, string>,\n  },\n  actions: {\n    addUser: (state, user: User) => {\n      state.userById[user.id] = user;\n      state.usernameById[user.username] = user.id;\n    },\n    deleteUser: (state, userId: string) => {\n      const user = state.userById[userId];\n      delete state.usernameById[user.username];\n      delete state.userById[userId];\n    }\n  },\n  selectors: {\n    selectUserByUsername: (state, username: string) => state.userById[state.usernameById[username]],\n    selectAllUsers: (state) => Object.values(state.userById),\n  }\n});\n\n","store/users/slice.ts",[19,5329,5330,5344,5348,5358,5368,5378,5388,5392,5396,5410,5418,5422,5440,5458,5462,5466,5488,5496,5504,5508,5530,5540,5546,5552,5556,5560,5564,5586,5607,5611],{"__ignoreMap":81},[85,5331,5332,5334,5337,5339,5342],{"class":87,"line":88},[85,5333,2787],{"class":98},[85,5335,5336],{"class":109}," { createSlice } ",[85,5338,2801],{"class":98},[85,5340,5341],{"class":191}," \"@/myReduxToolkit\"",[85,5343,127],{"class":109},[85,5345,5346],{"class":87,"line":95},[85,5347,92],{"emptyLinePlaceholder":91},[85,5349,5350,5352,5354,5356],{"class":87,"line":113},[85,5351,99],{"class":98},[85,5353,103],{"class":102},[85,5355,106],{"class":98},[85,5357,110],{"class":109},[85,5359,5360,5362,5364,5366],{"class":87,"line":130},[85,5361,117],{"class":116},[85,5363,120],{"class":98},[85,5365,124],{"class":123},[85,5367,127],{"class":109},[85,5369,5370,5372,5374,5376],{"class":87,"line":142},[85,5371,133],{"class":116},[85,5373,120],{"class":98},[85,5375,124],{"class":123},[85,5377,127],{"class":109},[85,5379,5380,5382,5384,5386],{"class":87,"line":154},[85,5381,145],{"class":116},[85,5383,120],{"class":98},[85,5385,124],{"class":123},[85,5387,127],{"class":109},[85,5389,5390],{"class":87,"line":160},[85,5391,157],{"class":109},[85,5393,5394],{"class":87,"line":165},[85,5395,92],{"emptyLinePlaceholder":91},[85,5397,5398,5400,5402,5404,5406,5408],{"class":87,"line":185},[85,5399,168],{"class":98},[85,5401,171],{"class":98},[85,5403,174],{"class":123},[85,5405,106],{"class":98},[85,5407,179],{"class":102},[85,5409,182],{"class":109},[85,5411,5412,5414,5416],{"class":87,"line":198},[85,5413,188],{"class":109},[85,5415,192],{"class":191},[85,5417,195],{"class":109},[85,5419,5420],{"class":87,"line":204},[85,5421,201],{"class":109},[85,5423,5424,5426,5428,5430,5432,5434,5436,5438],{"class":87,"line":230},[85,5425,207],{"class":109},[85,5427,210],{"class":98},[85,5429,213],{"class":102},[85,5431,216],{"class":109},[85,5433,219],{"class":123},[85,5435,26],{"class":109},[85,5437,224],{"class":102},[85,5439,227],{"class":109},[85,5441,5442,5444,5446,5448,5450,5452,5454,5456],{"class":87,"line":250},[85,5443,233],{"class":109},[85,5445,210],{"class":98},[85,5447,213],{"class":102},[85,5449,216],{"class":109},[85,5451,219],{"class":123},[85,5453,26],{"class":109},[85,5455,219],{"class":123},[85,5457,227],{"class":109},[85,5459,5460],{"class":87,"line":256},[85,5461,253],{"class":109},[85,5463,5464],{"class":87,"line":262},[85,5465,259],{"class":109},[85,5467,5468,5470,5472,5474,5476,5478,5480,5482,5484,5486],{"class":87,"line":291},[85,5469,265],{"class":102},[85,5471,268],{"class":109},[85,5473,271],{"class":116},[85,5475,26],{"class":109},[85,5477,276],{"class":116},[85,5479,120],{"class":98},[85,5481,103],{"class":102},[85,5483,283],{"class":109},[85,5485,286],{"class":98},[85,5487,110],{"class":109},[85,5489,5490,5492,5494],{"class":87,"line":298},[85,5491,301],{"class":109},[85,5493,304],{"class":98},[85,5495,307],{"class":109},[85,5497,5498,5500,5502],{"class":87,"line":310},[85,5499,313],{"class":109},[85,5501,304],{"class":98},[85,5503,318],{"class":109},[85,5505,5506],{"class":87,"line":321},[85,5507,324],{"class":109},[85,5509,5510,5512,5514,5516,5518,5520,5522,5524,5526,5528],{"class":87,"line":327},[85,5511,330],{"class":102},[85,5513,268],{"class":109},[85,5515,271],{"class":116},[85,5517,26],{"class":109},[85,5519,339],{"class":116},[85,5521,120],{"class":98},[85,5523,124],{"class":123},[85,5525,283],{"class":109},[85,5527,286],{"class":98},[85,5529,110],{"class":109},[85,5531,5532,5534,5536,5538],{"class":87,"line":352},[85,5533,355],{"class":98},[85,5535,358],{"class":123},[85,5537,106],{"class":98},[85,5539,363],{"class":109},[85,5541,5542,5544],{"class":87,"line":366},[85,5543,369],{"class":98},[85,5545,372],{"class":109},[85,5547,5548,5550],{"class":87,"line":375},[85,5549,369],{"class":98},[85,5551,363],{"class":109},[85,5553,5554],{"class":87,"line":382},[85,5555,385],{"class":109},[85,5557,5558],{"class":87,"line":388},[85,5559,253],{"class":109},[85,5561,5562],{"class":87,"line":393},[85,5563,396],{"class":109},[85,5565,5566,5568,5570,5572,5574,5576,5578,5580,5582,5584],{"class":87,"line":399},[85,5567,402],{"class":102},[85,5569,268],{"class":109},[85,5571,271],{"class":116},[85,5573,26],{"class":109},[85,5575,411],{"class":116},[85,5577,120],{"class":98},[85,5579,124],{"class":123},[85,5581,283],{"class":109},[85,5583,286],{"class":98},[85,5585,422],{"class":109},[85,5587,5588,5591,5593,5595,5597,5599,5601,5604],{"class":87,"line":425},[85,5589,5590],{"class":102},"    selectAllUsers",[85,5592,268],{"class":109},[85,5594,271],{"class":116},[85,5596,283],{"class":109},[85,5598,286],{"class":98},[85,5600,1761],{"class":109},[85,5602,5603],{"class":102},"values",[85,5605,5606],{"class":109},"(state.userById),\n",[85,5608,5609],{"class":87,"line":431},[85,5610,428],{"class":109},[85,5612,5613],{"class":87,"line":437},[85,5614,434],{"class":109},[75,5616,5619],{"className":77,"code":5617,"filename":5618,"language":80,"meta":81,"style":81},"import { configureStore, createUseSelector } from '@/myReduxToolkit';\nimport { usersSlice } from './users/slice';\n\nexport const { store } = configureStore([usersSlice]);\n\nexport const useSelector = createUseSelector(store);\n\n","store/index.ts",[19,5620,5621,5635,5649,5653,5673,5677],{"__ignoreMap":81},[85,5622,5623,5625,5628,5630,5633],{"class":87,"line":88},[85,5624,2787],{"class":98},[85,5626,5627],{"class":109}," { configureStore, createUseSelector } ",[85,5629,2801],{"class":98},[85,5631,5632],{"class":191}," '@/myReduxToolkit'",[85,5634,127],{"class":109},[85,5636,5637,5639,5642,5644,5647],{"class":87,"line":95},[85,5638,2787],{"class":98},[85,5640,5641],{"class":109}," { usersSlice } ",[85,5643,2801],{"class":98},[85,5645,5646],{"class":191}," './users/slice'",[85,5648,127],{"class":109},[85,5650,5651],{"class":87,"line":113},[85,5652,92],{"emptyLinePlaceholder":91},[85,5654,5655,5657,5659,5661,5663,5666,5668,5670],{"class":87,"line":130},[85,5656,168],{"class":98},[85,5658,171],{"class":98},[85,5660,1679],{"class":109},[85,5662,2879],{"class":123},[85,5664,5665],{"class":109}," } ",[85,5667,304],{"class":98},[85,5669,3335],{"class":102},[85,5671,5672],{"class":109},"([usersSlice]);\n",[85,5674,5675],{"class":87,"line":142},[85,5676,92],{"emptyLinePlaceholder":91},[85,5678,5679,5681,5683,5685,5687,5689],{"class":87,"line":154},[85,5680,168],{"class":98},[85,5682,171],{"class":98},[85,5684,503],{"class":123},[85,5686,106],{"class":98},[85,5688,2833],{"class":102},[85,5690,5691],{"class":109},"(store);\n",[75,5693,5698],{"className":5694,"code":5695,"filename":5696,"language":5697,"meta":81,"style":81},"language-tsx shiki shiki-themes github-light github-dark","const Test = () => {\n  const allUsers = useSelector(state => usersSlice.selectors.selectAllUsers(state.users));\n\n  console.log({\n    allUsers\n  });\n\n  return \u003Cdiv>\n    \u003Cbutton onClick={() => {\n      console.log(usersSlice.actions);\n      store.dispatch(usersSlice.actions.addUser({\n        displayName: String(Math.random()),\n        id: String(Math.random()),\n        username: String(Math.random()),\n      }));\n      console.log(store.getState());\n    }}>Add new user\u003C/button>\n\n    {allUsers.map((user) => \u003Cdiv key={user.username}>\n      \u003Cp>{user.displayName}\u003C/p>\n      \u003Cp>@{user.username}\u003C/p>\n    \u003C/div>)}\n  \u003C/div>;\n};\n","components/SomeComponent.tsx","tsx",[19,5699,5700,5715,5741,5745,5755,5760,5764,5768,5780,5800,5810,5825,5841,5854,5867,5872,5887,5896,5900,5928,5942,5955,5965,5974],{"__ignoreMap":81},[85,5701,5702,5704,5707,5709,5711,5713],{"class":87,"line":88},[85,5703,496],{"class":98},[85,5705,5706],{"class":102}," Test",[85,5708,106],{"class":98},[85,5710,2669],{"class":109},[85,5712,286],{"class":98},[85,5714,110],{"class":109},[85,5716,5717,5719,5722,5724,5726,5728,5730,5732,5735,5738],{"class":87,"line":95},[85,5718,1753],{"class":98},[85,5720,5721],{"class":123}," allUsers",[85,5723,106],{"class":98},[85,5725,503],{"class":102},[85,5727,506],{"class":109},[85,5729,271],{"class":116},[85,5731,511],{"class":98},[85,5733,5734],{"class":109}," usersSlice.selectors.",[85,5736,5737],{"class":102},"selectAllUsers",[85,5739,5740],{"class":109},"(state.users));\n",[85,5742,5743],{"class":87,"line":113},[85,5744,92],{"emptyLinePlaceholder":91},[85,5746,5747,5750,5753],{"class":87,"line":130},[85,5748,5749],{"class":109},"  console.",[85,5751,5752],{"class":102},"log",[85,5754,182],{"class":109},[85,5756,5757],{"class":87,"line":142},[85,5758,5759],{"class":109},"    allUsers\n",[85,5761,5762],{"class":87,"line":154},[85,5763,2178],{"class":109},[85,5765,5766],{"class":87,"line":160},[85,5767,92],{"emptyLinePlaceholder":91},[85,5769,5770,5772,5774,5778],{"class":87,"line":165},[85,5771,1117],{"class":98},[85,5773,2901],{"class":109},[85,5775,5777],{"class":5776},"s9eBZ","div",[85,5779,3255],{"class":109},[85,5781,5782,5785,5788,5791,5793,5796,5798],{"class":87,"line":185},[85,5783,5784],{"class":109},"    \u003C",[85,5786,5787],{"class":5776},"button",[85,5789,5790],{"class":102}," onClick",[85,5792,304],{"class":98},[85,5794,5795],{"class":109},"{() ",[85,5797,286],{"class":98},[85,5799,110],{"class":109},[85,5801,5802,5805,5807],{"class":87,"line":198},[85,5803,5804],{"class":109},"      console.",[85,5806,5752],{"class":102},[85,5808,5809],{"class":109},"(usersSlice.actions);\n",[85,5811,5812,5815,5818,5821,5823],{"class":87,"line":204},[85,5813,5814],{"class":109},"      store.",[85,5816,5817],{"class":102},"dispatch",[85,5819,5820],{"class":109},"(usersSlice.actions.",[85,5822,575],{"class":102},[85,5824,182],{"class":109},[85,5826,5827,5830,5832,5835,5838],{"class":87,"line":230},[85,5828,5829],{"class":109},"        displayName: ",[85,5831,1501],{"class":102},[85,5833,5834],{"class":109},"(Math.",[85,5836,5837],{"class":102},"random",[85,5839,5840],{"class":109},"()),\n",[85,5842,5843,5846,5848,5850,5852],{"class":87,"line":250},[85,5844,5845],{"class":109},"        id: ",[85,5847,1501],{"class":102},[85,5849,5834],{"class":109},[85,5851,5837],{"class":102},[85,5853,5840],{"class":109},[85,5855,5856,5859,5861,5863,5865],{"class":87,"line":256},[85,5857,5858],{"class":109},"        username: ",[85,5860,1501],{"class":102},[85,5862,5834],{"class":109},[85,5864,5837],{"class":102},[85,5866,5840],{"class":109},[85,5868,5869],{"class":87,"line":262},[85,5870,5871],{"class":109},"      }));\n",[85,5873,5874,5876,5878,5881,5884],{"class":87,"line":291},[85,5875,5804],{"class":109},[85,5877,5752],{"class":102},[85,5879,5880],{"class":109},"(store.",[85,5882,5883],{"class":102},"getState",[85,5885,5886],{"class":109},"());\n",[85,5888,5889,5892,5894],{"class":87,"line":298},[85,5890,5891],{"class":109},"    }}>Add new user\u003C/",[85,5893,5787],{"class":5776},[85,5895,3255],{"class":109},[85,5897,5898],{"class":87,"line":310},[85,5899,92],{"emptyLinePlaceholder":91},[85,5901,5902,5905,5908,5910,5912,5914,5916,5918,5920,5923,5925],{"class":87,"line":321},[85,5903,5904],{"class":109},"    {allUsers.",[85,5906,5907],{"class":102},"map",[85,5909,1793],{"class":109},[85,5911,276],{"class":116},[85,5913,283],{"class":109},[85,5915,286],{"class":98},[85,5917,2901],{"class":109},[85,5919,5777],{"class":5776},[85,5921,5922],{"class":102}," key",[85,5924,304],{"class":98},[85,5926,5927],{"class":109},"{user.username}>\n",[85,5929,5930,5933,5935,5938,5940],{"class":87,"line":327},[85,5931,5932],{"class":109},"      \u003C",[85,5934,15],{"class":5776},[85,5936,5937],{"class":109},">{user.displayName}\u003C/",[85,5939,15],{"class":5776},[85,5941,3255],{"class":109},[85,5943,5944,5946,5948,5951,5953],{"class":87,"line":352},[85,5945,5932],{"class":109},[85,5947,15],{"class":5776},[85,5949,5950],{"class":109},">@{user.username}\u003C/",[85,5952,15],{"class":5776},[85,5954,3255],{"class":109},[85,5956,5957,5960,5962],{"class":87,"line":366},[85,5958,5959],{"class":109},"    \u003C/",[85,5961,5777],{"class":5776},[85,5963,5964],{"class":109},">)}\n",[85,5966,5967,5970,5972],{"class":87,"line":375},[85,5968,5969],{"class":109},"  \u003C/",[85,5971,5777],{"class":5776},[85,5973,2980],{"class":109},[85,5975,5976],{"class":87,"line":382},[85,5977,930],{"class":109},[5979,5980,5981],"style",{},"html pre.shiki code .szBVR, html code.shiki .szBVR{--shiki-default:#D73A49;--shiki-dark:#F97583}html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sVt8B, html code.shiki .sVt8B{--shiki-default:#24292E;--shiki-dark:#E1E4E8}html pre.shiki code .s4XuR, html code.shiki .s4XuR{--shiki-default:#E36209;--shiki-dark:#FFAB70}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html pre.shiki code .sJ8bj, html code.shiki .sJ8bj{--shiki-default:#6A737D;--shiki-dark:#6A737D}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .s9eBZ, html code.shiki .s9eBZ{--shiki-default:#22863A;--shiki-dark:#85E89D}",{"title":81,"searchDepth":95,"depth":95,"links":5983},[5984,5985,5986,5987,5988,5989,5990,5991],{"id":12,"depth":95,"text":13},{"id":69,"depth":95,"text":70},{"id":631,"depth":95,"text":632},{"id":1149,"depth":95,"text":1150},{"id":2464,"depth":95,"text":2465},{"id":2634,"depth":95,"text":2635},{"id":3002,"depth":95,"text":3003},{"id":3616,"depth":95,"text":3617},"2024-02-12","Как работает @reduxjs/toolkit, реализация его упрощенной версии","md",{},"/blog/implementing-own-redux-toolkit","/images/own-redux-preview.webp",{"title":5,"description":5993},"blog/implementing-own-redux-toolkit",[6001,6002,6003,6004],"react","redux","typescript","state-manager","OkJLGUCANe-AwCcFZCoF38kZekYrjpczJ8LxZZaSDu8",[6007,6011],{"title":6008,"path":6009,"stem":6010,"children":-1},"Шпаргалка по CSS","/blog/advanced-css","blog/advanced-css",{"title":6012,"path":6013,"stem":6014,"children":-1},"Шпаргалка по built-in методам","/blog/js-built-in-methods","blog/js-built-in-methods",1751114697168]