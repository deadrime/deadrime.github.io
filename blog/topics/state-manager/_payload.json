[{"data":1,"prerenderedAt":6007},["ShallowReactive",2],{"articles_state-manager":3},[4],{"id":5,"title":6,"body":7,"date":5993,"description":5994,"extension":5995,"meta":5996,"navigation":92,"path":5997,"previewImg":5998,"seo":5999,"stem":6000,"topics":6001,"__hash__":6006},"articles/blog/implementing-own-redux-toolkit.md","Пишем свой redux-toolkit",{"type":8,"value":9,"toc":5983},"minimark",[10,15,39,68,72,75,630,634,640,1145,1148,1152,1161,1228,1231,1357,1360,1363,1366,1458,1461,1471,1477,1486,2202,2205,2214,2234,2237,2456,2463,2467,2479,2528,2546,2553,2633,2637,2644,2651,2654,2718,2725,2728,2759,2762,2773,2779,3001,3005,3012,3570,3615,3619,5325,5616,5693,5979],[11,12,14],"h2",{"id":13},"motivation","Мотивация",[16,17,18,19,23,24,27,28,31,32,27,35,38],"p",{},"Как правило мы задумываемся о глобальном стейте, когда приложение обрастает какой-то сложной бизнес логикой и прокидывать пропсы становится больно.\nВ случае с более менее легкой бизнес логикой можно обойтись ",[20,21,22],"code",{},"React Context",". Но когда уже не хватает и его - на помощь приходит стейт менеджер,\nнапример редакс. Обычно в качестве примера использования редакса показывают TODO лист, что на мой взгляд тупо - мне трудно представить\nсебе туду лист, который был бы достаточно сложен, что для него бы мог потребоваться глобальный стейт.\nСкорее вы будете хранить в стейте профиль авторизованного юзера или какие-то сложные структуры,\nкоторые нужно уметь находить разными способами, скажем ",[20,25,26],{},"profileById",", ",[20,29,30],{},"profileByUsername"," или ",[20,33,34],{},"noteIdsByWeekTs",[20,36,37],{},"noteIdsByDayTs",".",[16,40,41,42,50,51,55,56,59,60,63,64,67],{},"Глобальный стейт решает 3 основный задачи - хранить, записывать и доставать данные. Чем удобнее, тем лучше.\nRedux предлагает редьюсеры, экшены и селекторы для этих задач.\nЕсли говорить про ",[43,44,49],"a",{"href":45,"rel":46,"target":48},"https://redux.js.org/tutorials/fundamentals/part-3-state-actions-reducers",[47],"nofollow","_blank","стандартную реализацию",",\nто про про удобство говорить не приходится, switch case конструкция для экшенов - это боль.\nРазработчики редакса тоже так подумали и изобрели красивую обертку под названием ",[52,53,54],"strong",{},"Redux Toolkit.","\nОднако они умудрились превратить ",[52,57,58],{},"3.33 kB"," в ",[52,61,62],{},"37 kB"," и это наталкивает на мысль, что они напихали слишком много лишнего.\nВозможно, им следовало бы остановиться на методе ",[20,65,66],{},"createSlice",",\nкоторый позволяет создавать редьюсер и экшены без лишней головной боли, а так же хуке useSlectors.\nИменно эти вещи я и хочу реализовать самостоятельно. Это будет интересно еще и точки зрения типизации.",[11,69,71],{"id":70},"api","API",[16,73,74],{},"Для начала нужно прикинуть, что именно мы хотим получить на выходе.\nВ рамках данной статьи я хочу реализовать метод createSlice, где можно было бы создать экшены и селекторы,\nа так же useSelector для доступа к данным из реакт компонента и dispatch для вызова экшенов",[76,77,83],"pre",{"className":78,"code":79,"filename":80,"language":81,"meta":82,"style":82},"language-ts shiki shiki-themes github-light github-dark","\ntype User = {\n  id: string;\n  username: string;\n  displayName: string;\n}\n\nexport const usersSlice = createSlice({\n  name: 'users',\n  defaultState: {\n    userById: {} as Record\u003Cstring, User>,\n    usernameById: {} as Record\u003Cstring, string>,\n  },\n  actions: {\n    addUser: (state, user: User) => {\n      // state должен иметь тот же тип, что и defaultState\n      state.userById[user.id] = user;\n      state.usernameById[user.username] = user.id;\n    },\n    deleteUser: (state, userId: string) => {\n      const user = state.userById[userId];\n      delete state.usernameById[user.username];\n      delete state.userById[userId];\n    }\n  },\n  selectors: {\n    selectUserByUsername: (state, username: string) => state.userById[state.usernameById[username]],\n  }\n});\n\nusersSlice.actions;// экшены\nusersSlice.selectors;// селекторы\n\n// ...\n\n// SomeComponent.tsx\n\n// user Должен иметь тип User\nconst user = useSelector(state => state.selectUserByUsername(state.users, 'someUsername'));\n\nconst addUser = useCallback(() => {\n  dispatch(\n    // Аргументом addUser должен быть объект User\n    usersSlice.actions.addUser({\n      id: '2',\n      username: 'username2',\n      displayName: 'some display name',\n    })\n  );\n}, [dispatch]);\n","usersSlice.ts","ts","",[20,84,85,94,112,129,141,153,159,164,184,197,203,229,249,255,261,290,297,309,320,326,351,365,374,381,387,392,398,424,430,436,441,450,459,464,470,475,481,486,492,528,533,553,562,568,579,590,601,612,618,624],{"__ignoreMap":82},[86,87,90],"span",{"class":88,"line":89},"line",1,[86,91,93],{"emptyLinePlaceholder":92},true,"\n",[86,95,97,101,105,108],{"class":88,"line":96},2,[86,98,100],{"class":99},"szBVR","type",[86,102,104],{"class":103},"sScJk"," User",[86,106,107],{"class":99}," =",[86,109,111],{"class":110},"sVt8B"," {\n",[86,113,115,119,122,126],{"class":88,"line":114},3,[86,116,118],{"class":117},"s4XuR","  id",[86,120,121],{"class":99},":",[86,123,125],{"class":124},"sj4cs"," string",[86,127,128],{"class":110},";\n",[86,130,132,135,137,139],{"class":88,"line":131},4,[86,133,134],{"class":117},"  username",[86,136,121],{"class":99},[86,138,125],{"class":124},[86,140,128],{"class":110},[86,142,144,147,149,151],{"class":88,"line":143},5,[86,145,146],{"class":117},"  displayName",[86,148,121],{"class":99},[86,150,125],{"class":124},[86,152,128],{"class":110},[86,154,156],{"class":88,"line":155},6,[86,157,158],{"class":110},"}\n",[86,160,162],{"class":88,"line":161},7,[86,163,93],{"emptyLinePlaceholder":92},[86,165,167,170,173,176,178,181],{"class":88,"line":166},8,[86,168,169],{"class":99},"export",[86,171,172],{"class":99}," const",[86,174,175],{"class":124}," usersSlice",[86,177,107],{"class":99},[86,179,180],{"class":103}," createSlice",[86,182,183],{"class":110},"({\n",[86,185,187,190,194],{"class":88,"line":186},9,[86,188,189],{"class":110},"  name: ",[86,191,193],{"class":192},"sZZnC","'users'",[86,195,196],{"class":110},",\n",[86,198,200],{"class":88,"line":199},10,[86,201,202],{"class":110},"  defaultState: {\n",[86,204,206,209,212,215,218,221,223,226],{"class":88,"line":205},11,[86,207,208],{"class":110},"    userById: {} ",[86,210,211],{"class":99},"as",[86,213,214],{"class":103}," Record",[86,216,217],{"class":110},"\u003C",[86,219,220],{"class":124},"string",[86,222,27],{"class":110},[86,224,225],{"class":103},"User",[86,227,228],{"class":110},">,\n",[86,230,232,235,237,239,241,243,245,247],{"class":88,"line":231},12,[86,233,234],{"class":110},"    usernameById: {} ",[86,236,211],{"class":99},[86,238,214],{"class":103},[86,240,217],{"class":110},[86,242,220],{"class":124},[86,244,27],{"class":110},[86,246,220],{"class":124},[86,248,228],{"class":110},[86,250,252],{"class":88,"line":251},13,[86,253,254],{"class":110},"  },\n",[86,256,258],{"class":88,"line":257},14,[86,259,260],{"class":110},"  actions: {\n",[86,262,264,267,270,273,275,278,280,282,285,288],{"class":88,"line":263},15,[86,265,266],{"class":103},"    addUser",[86,268,269],{"class":110},": (",[86,271,272],{"class":117},"state",[86,274,27],{"class":110},[86,276,277],{"class":117},"user",[86,279,121],{"class":99},[86,281,104],{"class":103},[86,283,284],{"class":110},") ",[86,286,287],{"class":99},"=>",[86,289,111],{"class":110},[86,291,293],{"class":88,"line":292},16,[86,294,296],{"class":295},"sJ8bj","      // state должен иметь тот же тип, что и defaultState\n",[86,298,300,303,306],{"class":88,"line":299},17,[86,301,302],{"class":110},"      state.userById[user.id] ",[86,304,305],{"class":99},"=",[86,307,308],{"class":110}," user;\n",[86,310,312,315,317],{"class":88,"line":311},18,[86,313,314],{"class":110},"      state.usernameById[user.username] ",[86,316,305],{"class":99},[86,318,319],{"class":110}," user.id;\n",[86,321,323],{"class":88,"line":322},19,[86,324,325],{"class":110},"    },\n",[86,327,329,332,334,336,338,341,343,345,347,349],{"class":88,"line":328},20,[86,330,331],{"class":103},"    deleteUser",[86,333,269],{"class":110},[86,335,272],{"class":117},[86,337,27],{"class":110},[86,339,340],{"class":117},"userId",[86,342,121],{"class":99},[86,344,125],{"class":124},[86,346,284],{"class":110},[86,348,287],{"class":99},[86,350,111],{"class":110},[86,352,354,357,360,362],{"class":88,"line":353},21,[86,355,356],{"class":99},"      const",[86,358,359],{"class":124}," user",[86,361,107],{"class":99},[86,363,364],{"class":110}," state.userById[userId];\n",[86,366,368,371],{"class":88,"line":367},22,[86,369,370],{"class":99},"      delete",[86,372,373],{"class":110}," state.usernameById[user.username];\n",[86,375,377,379],{"class":88,"line":376},23,[86,378,370],{"class":99},[86,380,364],{"class":110},[86,382,384],{"class":88,"line":383},24,[86,385,386],{"class":110},"    }\n",[86,388,390],{"class":88,"line":389},25,[86,391,254],{"class":110},[86,393,395],{"class":88,"line":394},26,[86,396,397],{"class":110},"  selectors: {\n",[86,399,401,404,406,408,410,413,415,417,419,421],{"class":88,"line":400},27,[86,402,403],{"class":103},"    selectUserByUsername",[86,405,269],{"class":110},[86,407,272],{"class":117},[86,409,27],{"class":110},[86,411,412],{"class":117},"username",[86,414,121],{"class":99},[86,416,125],{"class":124},[86,418,284],{"class":110},[86,420,287],{"class":99},[86,422,423],{"class":110}," state.userById[state.usernameById[username]],\n",[86,425,427],{"class":88,"line":426},28,[86,428,429],{"class":110},"  }\n",[86,431,433],{"class":88,"line":432},29,[86,434,435],{"class":110},"});\n",[86,437,439],{"class":88,"line":438},30,[86,440,93],{"emptyLinePlaceholder":92},[86,442,444,447],{"class":88,"line":443},31,[86,445,446],{"class":110},"usersSlice.actions;",[86,448,449],{"class":295},"// экшены\n",[86,451,453,456],{"class":88,"line":452},32,[86,454,455],{"class":110},"usersSlice.selectors;",[86,457,458],{"class":295},"// селекторы\n",[86,460,462],{"class":88,"line":461},33,[86,463,93],{"emptyLinePlaceholder":92},[86,465,467],{"class":88,"line":466},34,[86,468,469],{"class":295},"// ...\n",[86,471,473],{"class":88,"line":472},35,[86,474,93],{"emptyLinePlaceholder":92},[86,476,478],{"class":88,"line":477},36,[86,479,480],{"class":295},"// SomeComponent.tsx\n",[86,482,484],{"class":88,"line":483},37,[86,485,93],{"emptyLinePlaceholder":92},[86,487,489],{"class":88,"line":488},38,[86,490,491],{"class":295},"// user Должен иметь тип User\n",[86,493,495,498,500,502,505,508,510,513,516,519,522,525],{"class":88,"line":494},39,[86,496,497],{"class":99},"const",[86,499,359],{"class":124},[86,501,107],{"class":99},[86,503,504],{"class":103}," useSelector",[86,506,507],{"class":110},"(",[86,509,272],{"class":117},[86,511,512],{"class":99}," =>",[86,514,515],{"class":110}," state.",[86,517,518],{"class":103},"selectUserByUsername",[86,520,521],{"class":110},"(state.users, ",[86,523,524],{"class":192},"'someUsername'",[86,526,527],{"class":110},"));\n",[86,529,531],{"class":88,"line":530},40,[86,532,93],{"emptyLinePlaceholder":92},[86,534,536,538,541,543,546,549,551],{"class":88,"line":535},41,[86,537,497],{"class":99},[86,539,540],{"class":124}," addUser",[86,542,107],{"class":99},[86,544,545],{"class":103}," useCallback",[86,547,548],{"class":110},"(() ",[86,550,287],{"class":99},[86,552,111],{"class":110},[86,554,556,559],{"class":88,"line":555},42,[86,557,558],{"class":103},"  dispatch",[86,560,561],{"class":110},"(\n",[86,563,565],{"class":88,"line":564},43,[86,566,567],{"class":295},"    // Аргументом addUser должен быть объект User\n",[86,569,571,574,577],{"class":88,"line":570},44,[86,572,573],{"class":110},"    usersSlice.actions.",[86,575,576],{"class":103},"addUser",[86,578,183],{"class":110},[86,580,582,585,588],{"class":88,"line":581},45,[86,583,584],{"class":110},"      id: ",[86,586,587],{"class":192},"'2'",[86,589,196],{"class":110},[86,591,593,596,599],{"class":88,"line":592},46,[86,594,595],{"class":110},"      username: ",[86,597,598],{"class":192},"'username2'",[86,600,196],{"class":110},[86,602,604,607,610],{"class":88,"line":603},47,[86,605,606],{"class":110},"      displayName: ",[86,608,609],{"class":192},"'some display name'",[86,611,196],{"class":110},[86,613,615],{"class":88,"line":614},48,[86,616,617],{"class":110},"    })\n",[86,619,621],{"class":88,"line":620},49,[86,622,623],{"class":110},"  );\n",[86,625,627],{"class":88,"line":626},50,[86,628,629],{"class":110},"}, [dispatch]);\n",[11,631,633],{"id":632},"implementation","Реализация",[16,635,636,637,639],{},"Для начала определимся с параметрами ",[20,638,66],{}," и набросаем небольшой черновик:",[76,641,643],{"className":78,"code":642,"language":81,"meta":82,"style":82},"type SliceActionCreator\u003CState, Payload = any> = (\n  state: State,\n  payload: Payload\n) => void;\n\ntype SliceSelector\u003CState, Payload = unknown, SelectorReturn = unknown> = (\n  state: State,\n  payload: Payload\n) => SelectorReturn;\n\ntype CreateSliceProps\u003C\n  Name extends string,\n  State extends Record\u003Cstring, unknown>,\n  Actions extends Record\u003Cstring, SliceActionCreator\u003CState>>,\n  Selectors extends Record\u003Cstring, SliceSelector\u003CState>>\n> = {\n  name: Name;\n  actions: Actions;\n  defaultState: State;\n  selectors: Selectors;\n};\n\nexport const createSlice = \u003C\n  Name extends string,\n  State extends Record\u003Cstring, unknown>,\n  Actions extends Record\u003Cstring, SliceActionCreator\u003CState>>,\n  Selectors extends Record\u003Cstring, SliceSelector\u003CState>>\n>({\n    name,\n    actions,\n    defaultState,\n    selectors,\n  }: CreateSliceProps\u003CName, State, Actions, Selectors>) => {\n  let sliceActions; // TODO\n  let reducer; // TODO\n  let sliceSelectors; // TODO\n\n  return {\n    reducer,\n    selectors: sliceSelectors,\n    actions: sliceActions,\n  };\n};\n\n",[20,644,645,675,687,697,708,712,747,757,765,776,780,790,802,822,847,872,880,892,904,915,927,932,936,949,959,977,999,1021,1026,1031,1036,1041,1046,1081,1092,1101,1110,1114,1121,1126,1131,1136,1141],{"__ignoreMap":82},[86,646,647,649,652,654,657,659,662,664,667,670,672],{"class":88,"line":89},[86,648,100],{"class":99},[86,650,651],{"class":103}," SliceActionCreator",[86,653,217],{"class":110},[86,655,656],{"class":103},"State",[86,658,27],{"class":110},[86,660,661],{"class":103},"Payload",[86,663,107],{"class":99},[86,665,666],{"class":124}," any",[86,668,669],{"class":110},"> ",[86,671,305],{"class":99},[86,673,674],{"class":110}," (\n",[86,676,677,680,682,685],{"class":88,"line":96},[86,678,679],{"class":117},"  state",[86,681,121],{"class":99},[86,683,684],{"class":103}," State",[86,686,196],{"class":110},[86,688,689,692,694],{"class":88,"line":114},[86,690,691],{"class":117},"  payload",[86,693,121],{"class":99},[86,695,696],{"class":103}," Payload\n",[86,698,699,701,703,706],{"class":88,"line":131},[86,700,284],{"class":110},[86,702,287],{"class":99},[86,704,705],{"class":124}," void",[86,707,128],{"class":110},[86,709,710],{"class":88,"line":143},[86,711,93],{"emptyLinePlaceholder":92},[86,713,714,716,719,721,723,725,727,729,732,734,737,739,741,743,745],{"class":88,"line":155},[86,715,100],{"class":99},[86,717,718],{"class":103}," SliceSelector",[86,720,217],{"class":110},[86,722,656],{"class":103},[86,724,27],{"class":110},[86,726,661],{"class":103},[86,728,107],{"class":99},[86,730,731],{"class":124}," unknown",[86,733,27],{"class":110},[86,735,736],{"class":103},"SelectorReturn",[86,738,107],{"class":99},[86,740,731],{"class":124},[86,742,669],{"class":110},[86,744,305],{"class":99},[86,746,674],{"class":110},[86,748,749,751,753,755],{"class":88,"line":161},[86,750,679],{"class":117},[86,752,121],{"class":99},[86,754,684],{"class":103},[86,756,196],{"class":110},[86,758,759,761,763],{"class":88,"line":166},[86,760,691],{"class":117},[86,762,121],{"class":99},[86,764,696],{"class":103},[86,766,767,769,771,774],{"class":88,"line":186},[86,768,284],{"class":110},[86,770,287],{"class":99},[86,772,773],{"class":103}," SelectorReturn",[86,775,128],{"class":110},[86,777,778],{"class":88,"line":199},[86,779,93],{"emptyLinePlaceholder":92},[86,781,782,784,787],{"class":88,"line":205},[86,783,100],{"class":99},[86,785,786],{"class":103}," CreateSliceProps",[86,788,789],{"class":110},"\u003C\n",[86,791,792,795,798,800],{"class":88,"line":231},[86,793,794],{"class":103},"  Name",[86,796,797],{"class":99}," extends",[86,799,125],{"class":124},[86,801,196],{"class":110},[86,803,804,807,809,811,813,815,817,820],{"class":88,"line":251},[86,805,806],{"class":103},"  State",[86,808,797],{"class":99},[86,810,214],{"class":103},[86,812,217],{"class":110},[86,814,220],{"class":124},[86,816,27],{"class":110},[86,818,819],{"class":124},"unknown",[86,821,228],{"class":110},[86,823,824,827,829,831,833,835,837,840,842,844],{"class":88,"line":257},[86,825,826],{"class":103},"  Actions",[86,828,797],{"class":99},[86,830,214],{"class":103},[86,832,217],{"class":110},[86,834,220],{"class":124},[86,836,27],{"class":110},[86,838,839],{"class":103},"SliceActionCreator",[86,841,217],{"class":110},[86,843,656],{"class":103},[86,845,846],{"class":110},">>,\n",[86,848,849,852,854,856,858,860,862,865,867,869],{"class":88,"line":263},[86,850,851],{"class":103},"  Selectors",[86,853,797],{"class":99},[86,855,214],{"class":103},[86,857,217],{"class":110},[86,859,220],{"class":124},[86,861,27],{"class":110},[86,863,864],{"class":103},"SliceSelector",[86,866,217],{"class":110},[86,868,656],{"class":103},[86,870,871],{"class":110},">>\n",[86,873,874,876,878],{"class":88,"line":292},[86,875,669],{"class":110},[86,877,305],{"class":99},[86,879,111],{"class":110},[86,881,882,885,887,890],{"class":88,"line":299},[86,883,884],{"class":117},"  name",[86,886,121],{"class":99},[86,888,889],{"class":103}," Name",[86,891,128],{"class":110},[86,893,894,897,899,902],{"class":88,"line":311},[86,895,896],{"class":117},"  actions",[86,898,121],{"class":99},[86,900,901],{"class":103}," Actions",[86,903,128],{"class":110},[86,905,906,909,911,913],{"class":88,"line":322},[86,907,908],{"class":117},"  defaultState",[86,910,121],{"class":99},[86,912,684],{"class":103},[86,914,128],{"class":110},[86,916,917,920,922,925],{"class":88,"line":328},[86,918,919],{"class":117},"  selectors",[86,921,121],{"class":99},[86,923,924],{"class":103}," Selectors",[86,926,128],{"class":110},[86,928,929],{"class":88,"line":353},[86,930,931],{"class":110},"};\n",[86,933,934],{"class":88,"line":367},[86,935,93],{"emptyLinePlaceholder":92},[86,937,938,940,942,944,946],{"class":88,"line":376},[86,939,169],{"class":99},[86,941,172],{"class":99},[86,943,180],{"class":103},[86,945,107],{"class":99},[86,947,948],{"class":110}," \u003C\n",[86,950,951,953,955,957],{"class":88,"line":383},[86,952,794],{"class":103},[86,954,797],{"class":99},[86,956,125],{"class":124},[86,958,196],{"class":110},[86,960,961,963,965,967,969,971,973,975],{"class":88,"line":389},[86,962,806],{"class":103},[86,964,797],{"class":99},[86,966,214],{"class":103},[86,968,217],{"class":110},[86,970,220],{"class":124},[86,972,27],{"class":110},[86,974,819],{"class":124},[86,976,228],{"class":110},[86,978,979,981,983,985,987,989,991,993,995,997],{"class":88,"line":394},[86,980,826],{"class":103},[86,982,797],{"class":99},[86,984,214],{"class":103},[86,986,217],{"class":110},[86,988,220],{"class":124},[86,990,27],{"class":110},[86,992,839],{"class":103},[86,994,217],{"class":110},[86,996,656],{"class":103},[86,998,846],{"class":110},[86,1000,1001,1003,1005,1007,1009,1011,1013,1015,1017,1019],{"class":88,"line":400},[86,1002,851],{"class":103},[86,1004,797],{"class":99},[86,1006,214],{"class":103},[86,1008,217],{"class":110},[86,1010,220],{"class":124},[86,1012,27],{"class":110},[86,1014,864],{"class":103},[86,1016,217],{"class":110},[86,1018,656],{"class":103},[86,1020,871],{"class":110},[86,1022,1023],{"class":88,"line":426},[86,1024,1025],{"class":110},">({\n",[86,1027,1028],{"class":88,"line":432},[86,1029,1030],{"class":110},"    name,\n",[86,1032,1033],{"class":88,"line":438},[86,1034,1035],{"class":110},"    actions,\n",[86,1037,1038],{"class":88,"line":443},[86,1039,1040],{"class":110},"    defaultState,\n",[86,1042,1043],{"class":88,"line":452},[86,1044,1045],{"class":110},"    selectors,\n",[86,1047,1048,1051,1053,1055,1057,1060,1062,1064,1066,1069,1071,1074,1077,1079],{"class":88,"line":461},[86,1049,1050],{"class":110},"  }",[86,1052,121],{"class":99},[86,1054,786],{"class":103},[86,1056,217],{"class":110},[86,1058,1059],{"class":103},"Name",[86,1061,27],{"class":110},[86,1063,656],{"class":103},[86,1065,27],{"class":110},[86,1067,1068],{"class":103},"Actions",[86,1070,27],{"class":110},[86,1072,1073],{"class":103},"Selectors",[86,1075,1076],{"class":110},">) ",[86,1078,287],{"class":99},[86,1080,111],{"class":110},[86,1082,1083,1086,1089],{"class":88,"line":466},[86,1084,1085],{"class":99},"  let",[86,1087,1088],{"class":110}," sliceActions; ",[86,1090,1091],{"class":295},"// TODO\n",[86,1093,1094,1096,1099],{"class":88,"line":472},[86,1095,1085],{"class":99},[86,1097,1098],{"class":110}," reducer; ",[86,1100,1091],{"class":295},[86,1102,1103,1105,1108],{"class":88,"line":477},[86,1104,1085],{"class":99},[86,1106,1107],{"class":110}," sliceSelectors; ",[86,1109,1091],{"class":295},[86,1111,1112],{"class":88,"line":483},[86,1113,93],{"emptyLinePlaceholder":92},[86,1115,1116,1119],{"class":88,"line":488},[86,1117,1118],{"class":99},"  return",[86,1120,111],{"class":110},[86,1122,1123],{"class":88,"line":494},[86,1124,1125],{"class":110},"    reducer,\n",[86,1127,1128],{"class":88,"line":530},[86,1129,1130],{"class":110},"    selectors: sliceSelectors,\n",[86,1132,1133],{"class":88,"line":535},[86,1134,1135],{"class":110},"    actions: sliceActions,\n",[86,1137,1138],{"class":88,"line":555},[86,1139,1140],{"class":110},"  };\n",[86,1142,1143],{"class":88,"line":564},[86,1144,931],{"class":110},[16,1146,1147],{},"План такой - сначала реализовать экшены, потом редьюсер и в самом конце - селекторы.",[11,1149,1151],{"id":1150},"actions","Экшены",[16,1153,1154,1155,1157,1158],{},"Экшен представляет из себя объект с обязательным полем ",[20,1156,100],{}," и опциональным ",[20,1159,1160],{},"payload",[76,1162,1164],{"className":78,"code":1163,"language":81,"meta":82,"style":82},"type Action\u003CType extends string = string, Payload = unknown> = {\n  type: Type;\n  payload?: Payload;\n};\n",[20,1165,1166,1200,1212,1224],{"__ignoreMap":82},[86,1167,1168,1170,1173,1175,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198],{"class":88,"line":89},[86,1169,100],{"class":99},[86,1171,1172],{"class":103}," Action",[86,1174,217],{"class":110},[86,1176,1177],{"class":103},"Type",[86,1179,797],{"class":99},[86,1181,125],{"class":124},[86,1183,107],{"class":99},[86,1185,125],{"class":124},[86,1187,27],{"class":110},[86,1189,661],{"class":103},[86,1191,107],{"class":99},[86,1193,731],{"class":124},[86,1195,669],{"class":110},[86,1197,305],{"class":99},[86,1199,111],{"class":110},[86,1201,1202,1205,1207,1210],{"class":88,"line":96},[86,1203,1204],{"class":117},"  type",[86,1206,121],{"class":99},[86,1208,1209],{"class":103}," Type",[86,1211,128],{"class":110},[86,1213,1214,1216,1219,1222],{"class":88,"line":114},[86,1215,691],{"class":117},[86,1217,1218],{"class":99},"?:",[86,1220,1221],{"class":103}," Payload",[86,1223,128],{"class":110},[86,1225,1226],{"class":88,"line":131},[86,1227,931],{"class":110},[16,1229,1230],{},"Пусть, если в метод createSlice прокинуты",[76,1232,1234],{"className":78,"code":1233,"language":81,"meta":82,"style":82},"const props = {\n  name: 'users',\n  actions: {\n    addUser: (state, user: User) => {\n      state.userById[user.id] = user;\n      state.usernameById[user.username] = user.id;\n    },\n    deleteUser: (state, userId: string) => {\n      const user = state.userById[userId];\n      delete state.usernameById[user.username];\n      delete state.userById[userId];\n    }\n  }\n};\n",[20,1235,1236,1247,1255,1259,1281,1289,1297,1301,1323,1333,1339,1345,1349,1353],{"__ignoreMap":82},[86,1237,1238,1240,1243,1245],{"class":88,"line":89},[86,1239,497],{"class":99},[86,1241,1242],{"class":124}," props",[86,1244,107],{"class":99},[86,1246,111],{"class":110},[86,1248,1249,1251,1253],{"class":88,"line":96},[86,1250,189],{"class":110},[86,1252,193],{"class":192},[86,1254,196],{"class":110},[86,1256,1257],{"class":88,"line":114},[86,1258,260],{"class":110},[86,1260,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279],{"class":88,"line":131},[86,1262,266],{"class":103},[86,1264,269],{"class":110},[86,1266,272],{"class":117},[86,1268,27],{"class":110},[86,1270,277],{"class":117},[86,1272,121],{"class":99},[86,1274,104],{"class":103},[86,1276,284],{"class":110},[86,1278,287],{"class":99},[86,1280,111],{"class":110},[86,1282,1283,1285,1287],{"class":88,"line":143},[86,1284,302],{"class":110},[86,1286,305],{"class":99},[86,1288,308],{"class":110},[86,1290,1291,1293,1295],{"class":88,"line":155},[86,1292,314],{"class":110},[86,1294,305],{"class":99},[86,1296,319],{"class":110},[86,1298,1299],{"class":88,"line":161},[86,1300,325],{"class":110},[86,1302,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321],{"class":88,"line":166},[86,1304,331],{"class":103},[86,1306,269],{"class":110},[86,1308,272],{"class":117},[86,1310,27],{"class":110},[86,1312,340],{"class":117},[86,1314,121],{"class":99},[86,1316,125],{"class":124},[86,1318,284],{"class":110},[86,1320,287],{"class":99},[86,1322,111],{"class":110},[86,1324,1325,1327,1329,1331],{"class":88,"line":186},[86,1326,356],{"class":99},[86,1328,359],{"class":124},[86,1330,107],{"class":99},[86,1332,364],{"class":110},[86,1334,1335,1337],{"class":88,"line":199},[86,1336,370],{"class":99},[86,1338,373],{"class":110},[86,1340,1341,1343],{"class":88,"line":205},[86,1342,370],{"class":99},[86,1344,364],{"class":110},[86,1346,1347],{"class":88,"line":231},[86,1348,386],{"class":110},[86,1350,1351],{"class":88,"line":251},[86,1352,429],{"class":110},[86,1354,1355],{"class":88,"line":257},[86,1356,931],{"class":110},[16,1358,1359],{},"то мы будем генерировать два actionType:",[16,1361,1362],{},"users/addUser\nusers/deleteUser",[16,1364,1365],{},"и два экшена -",[76,1367,1369],{"className":78,"code":1368,"language":81,"meta":82,"style":82},"const addUser = (user: User) => ({\n  type: \"users/addUser\",\n  payload: user,\n});\n\nconst deleteUser = (userId: string) => ({\n  type: \"users/deleteUser\",\n  payload: user,\n});\n",[20,1370,1371,1395,1405,1410,1414,1418,1441,1450,1454],{"__ignoreMap":82},[86,1372,1373,1375,1377,1379,1382,1384,1386,1388,1390,1392],{"class":88,"line":89},[86,1374,497],{"class":99},[86,1376,540],{"class":103},[86,1378,107],{"class":99},[86,1380,1381],{"class":110}," (",[86,1383,277],{"class":117},[86,1385,121],{"class":99},[86,1387,104],{"class":103},[86,1389,284],{"class":110},[86,1391,287],{"class":99},[86,1393,1394],{"class":110}," ({\n",[86,1396,1397,1400,1403],{"class":88,"line":96},[86,1398,1399],{"class":110},"  type: ",[86,1401,1402],{"class":192},"\"users/addUser\"",[86,1404,196],{"class":110},[86,1406,1407],{"class":88,"line":114},[86,1408,1409],{"class":110},"  payload: user,\n",[86,1411,1412],{"class":88,"line":131},[86,1413,435],{"class":110},[86,1415,1416],{"class":88,"line":143},[86,1417,93],{"emptyLinePlaceholder":92},[86,1419,1420,1422,1425,1427,1429,1431,1433,1435,1437,1439],{"class":88,"line":155},[86,1421,497],{"class":99},[86,1423,1424],{"class":103}," deleteUser",[86,1426,107],{"class":99},[86,1428,1381],{"class":110},[86,1430,340],{"class":117},[86,1432,121],{"class":99},[86,1434,125],{"class":124},[86,1436,284],{"class":110},[86,1438,287],{"class":99},[86,1440,1394],{"class":110},[86,1442,1443,1445,1448],{"class":88,"line":161},[86,1444,1399],{"class":110},[86,1446,1447],{"class":192},"\"users/deleteUser\"",[86,1449,196],{"class":110},[86,1451,1452],{"class":88,"line":166},[86,1453,1409],{"class":110},[86,1455,1456],{"class":88,"line":186},[86,1457,435],{"class":110},[16,1459,1460],{},"Префикс с названием слайса добавлен для удобства и для того, чтобы предотвратить конфликт экшенов с одинаковыми названиями.",[16,1462,1463,1464,1467,1468],{},"Нам понадобится два новых типа - ",[20,1465,1466],{},"ActionKey"," и ",[20,1469,1470],{},"ActionType",[16,1472,1473,1474,1476],{},"это ключи переданного объекта actions, а ",[20,1475,1470],{}," - это экшены, которые генерирует слайс, те же ключи, но с префиксом,",[16,1478,1479,1480,1482,1483],{},"Для создания типа ",[20,1481,1470],{}," используется небольшой генерик хелпер ",[20,1484,1485],{},"Scoped",[76,1487,1489],{"className":78,"code":1488,"language":81,"meta":82,"style":82},"type Scoped\u003CString extends string, Scope extends string> = `${Scope}/${String}`;\n\nexport const createSlice = \u003C\n  Name extends string,\n  State extends Record\u003Cstring, unknown>,\n  Actions extends Record\u003Cstring, SliceActionCreator\u003CState>>,\n  ActionKey extends Extract\u003Ckeyof Actions, string>,\n  ScopedActionType extends Scoped\u003CActionKey, Name>,\n  ActionPayload extends Parameters\u003CActions[ActionKey]>[1],\n  Action extends { type: ScopedActionType, payload: ActionPayload },\n>({\n    name,\n    actions,\n    defaultState,\n    selectors,\n  }: CreateSliceProps\u003CName, State, Actions, Selectors>) => {\n  const actionKeys = Object.keys(actions) as ActionKey[];\n  const actionTypeByActionKey = actionKeys.reduce((acc, action) => {\n    const scopedActionType = `${name}/${action}` as ScopedActionType;\n    acc[scopedActionType] = action;\n    return acc;\n  }, {} as Record\u003CScopedActionType, ActionKey>);\n\n  const reducer = (state: State = defaultState, action: Action) => {\n    const nextState = produce(state, draft => {\n      const actionType = actionTypeByActionKey[action.type];\n      actions[actionType]?.(draft as State, action.payload);\n    });\n    return nextState;\n  };\n\n  const sliceActions = actionKeys.reduce((acc, curr) => {\n    acc[curr] = (payload) => {\n      const scopedActionType = `${name}/${curr}` as ScopedActionType;\n\n      return {\n        type: scopedActionType,\n        payload,\n      };\n    };\n    return acc;\n  }, {} as {\n    [ActionKey in Extract\u003Ckeyof Actions, string>]: (payload: Parameters\u003CActions[ActionKey]>[1]) => { type: Scoped\u003CActionKey, Name>, payload: P }\n  });\n\n  return {\n    actions: sliceActions,\n  };\n};\n",[20,1490,1491,1535,1539,1551,1561,1579,1601,1624,1643,1671,1700,1704,1708,1712,1716,1720,1750,1777,1809,1837,1847,1855,1876,1880,1914,1936,1948,1960,1965,1972,1976,1980,2008,2025,2049,2053,2060,2065,2070,2075,2080,2086,2094,2175,2180,2184,2190,2194,2198],{"__ignoreMap":82},[86,1492,1493,1495,1498,1500,1503,1505,1507,1509,1512,1514,1516,1518,1520,1523,1525,1528,1530,1533],{"class":88,"line":89},[86,1494,100],{"class":99},[86,1496,1497],{"class":103}," Scoped",[86,1499,217],{"class":110},[86,1501,1502],{"class":103},"String",[86,1504,797],{"class":99},[86,1506,125],{"class":124},[86,1508,27],{"class":110},[86,1510,1511],{"class":103},"Scope",[86,1513,797],{"class":99},[86,1515,125],{"class":124},[86,1517,669],{"class":110},[86,1519,305],{"class":99},[86,1521,1522],{"class":192}," `${",[86,1524,1511],{"class":103},[86,1526,1527],{"class":192},"}/${",[86,1529,1502],{"class":103},[86,1531,1532],{"class":192},"}`",[86,1534,128],{"class":110},[86,1536,1537],{"class":88,"line":96},[86,1538,93],{"emptyLinePlaceholder":92},[86,1540,1541,1543,1545,1547,1549],{"class":88,"line":114},[86,1542,169],{"class":99},[86,1544,172],{"class":99},[86,1546,180],{"class":103},[86,1548,107],{"class":99},[86,1550,948],{"class":110},[86,1552,1553,1555,1557,1559],{"class":88,"line":131},[86,1554,794],{"class":103},[86,1556,797],{"class":99},[86,1558,125],{"class":124},[86,1560,196],{"class":110},[86,1562,1563,1565,1567,1569,1571,1573,1575,1577],{"class":88,"line":143},[86,1564,806],{"class":103},[86,1566,797],{"class":99},[86,1568,214],{"class":103},[86,1570,217],{"class":110},[86,1572,220],{"class":124},[86,1574,27],{"class":110},[86,1576,819],{"class":124},[86,1578,228],{"class":110},[86,1580,1581,1583,1585,1587,1589,1591,1593,1595,1597,1599],{"class":88,"line":155},[86,1582,826],{"class":103},[86,1584,797],{"class":99},[86,1586,214],{"class":103},[86,1588,217],{"class":110},[86,1590,220],{"class":124},[86,1592,27],{"class":110},[86,1594,839],{"class":103},[86,1596,217],{"class":110},[86,1598,656],{"class":103},[86,1600,846],{"class":110},[86,1602,1603,1606,1608,1611,1613,1616,1618,1620,1622],{"class":88,"line":161},[86,1604,1605],{"class":103},"  ActionKey",[86,1607,797],{"class":99},[86,1609,1610],{"class":103}," Extract",[86,1612,217],{"class":110},[86,1614,1615],{"class":99},"keyof",[86,1617,901],{"class":103},[86,1619,27],{"class":110},[86,1621,220],{"class":124},[86,1623,228],{"class":110},[86,1625,1626,1629,1631,1633,1635,1637,1639,1641],{"class":88,"line":166},[86,1627,1628],{"class":103},"  ScopedActionType",[86,1630,797],{"class":99},[86,1632,1497],{"class":103},[86,1634,217],{"class":110},[86,1636,1466],{"class":103},[86,1638,27],{"class":110},[86,1640,1059],{"class":103},[86,1642,228],{"class":110},[86,1644,1645,1648,1650,1653,1655,1657,1660,1662,1665,1668],{"class":88,"line":186},[86,1646,1647],{"class":103},"  ActionPayload",[86,1649,797],{"class":99},[86,1651,1652],{"class":103}," Parameters",[86,1654,217],{"class":110},[86,1656,1068],{"class":103},[86,1658,1659],{"class":110},"[",[86,1661,1466],{"class":103},[86,1663,1664],{"class":110},"]>[",[86,1666,1667],{"class":124},"1",[86,1669,1670],{"class":110},"],\n",[86,1672,1673,1676,1678,1681,1683,1685,1688,1690,1692,1694,1697],{"class":88,"line":199},[86,1674,1675],{"class":103},"  Action",[86,1677,797],{"class":99},[86,1679,1680],{"class":110}," { ",[86,1682,100],{"class":117},[86,1684,121],{"class":99},[86,1686,1687],{"class":103}," ScopedActionType",[86,1689,27],{"class":110},[86,1691,1160],{"class":117},[86,1693,121],{"class":99},[86,1695,1696],{"class":103}," ActionPayload",[86,1698,1699],{"class":110}," },\n",[86,1701,1702],{"class":88,"line":205},[86,1703,1025],{"class":110},[86,1705,1706],{"class":88,"line":231},[86,1707,1030],{"class":110},[86,1709,1710],{"class":88,"line":251},[86,1711,1035],{"class":110},[86,1713,1714],{"class":88,"line":257},[86,1715,1040],{"class":110},[86,1717,1718],{"class":88,"line":263},[86,1719,1045],{"class":110},[86,1721,1722,1724,1726,1728,1730,1732,1734,1736,1738,1740,1742,1744,1746,1748],{"class":88,"line":292},[86,1723,1050],{"class":110},[86,1725,121],{"class":99},[86,1727,786],{"class":103},[86,1729,217],{"class":110},[86,1731,1059],{"class":103},[86,1733,27],{"class":110},[86,1735,656],{"class":103},[86,1737,27],{"class":110},[86,1739,1068],{"class":103},[86,1741,27],{"class":110},[86,1743,1073],{"class":103},[86,1745,1076],{"class":110},[86,1747,287],{"class":99},[86,1749,111],{"class":110},[86,1751,1752,1755,1758,1760,1763,1766,1769,1771,1774],{"class":88,"line":299},[86,1753,1754],{"class":99},"  const",[86,1756,1757],{"class":124}," actionKeys",[86,1759,107],{"class":99},[86,1761,1762],{"class":110}," Object.",[86,1764,1765],{"class":103},"keys",[86,1767,1768],{"class":110},"(actions) ",[86,1770,211],{"class":99},[86,1772,1773],{"class":103}," ActionKey",[86,1775,1776],{"class":110},"[];\n",[86,1778,1779,1781,1784,1786,1789,1792,1795,1798,1800,1803,1805,1807],{"class":88,"line":311},[86,1780,1754],{"class":99},[86,1782,1783],{"class":124}," actionTypeByActionKey",[86,1785,107],{"class":99},[86,1787,1788],{"class":110}," actionKeys.",[86,1790,1791],{"class":103},"reduce",[86,1793,1794],{"class":110},"((",[86,1796,1797],{"class":117},"acc",[86,1799,27],{"class":110},[86,1801,1802],{"class":117},"action",[86,1804,284],{"class":110},[86,1806,287],{"class":99},[86,1808,111],{"class":110},[86,1810,1811,1814,1817,1819,1821,1824,1826,1828,1830,1833,1835],{"class":88,"line":322},[86,1812,1813],{"class":99},"    const",[86,1815,1816],{"class":124}," scopedActionType",[86,1818,107],{"class":99},[86,1820,1522],{"class":192},[86,1822,1823],{"class":110},"name",[86,1825,1527],{"class":192},[86,1827,1802],{"class":110},[86,1829,1532],{"class":192},[86,1831,1832],{"class":99}," as",[86,1834,1687],{"class":103},[86,1836,128],{"class":110},[86,1838,1839,1842,1844],{"class":88,"line":328},[86,1840,1841],{"class":110},"    acc[scopedActionType] ",[86,1843,305],{"class":99},[86,1845,1846],{"class":110}," action;\n",[86,1848,1849,1852],{"class":88,"line":353},[86,1850,1851],{"class":99},"    return",[86,1853,1854],{"class":110}," acc;\n",[86,1856,1857,1860,1862,1864,1866,1869,1871,1873],{"class":88,"line":367},[86,1858,1859],{"class":110},"  }, {} ",[86,1861,211],{"class":99},[86,1863,214],{"class":103},[86,1865,217],{"class":110},[86,1867,1868],{"class":103},"ScopedActionType",[86,1870,27],{"class":110},[86,1872,1466],{"class":103},[86,1874,1875],{"class":110},">);\n",[86,1877,1878],{"class":88,"line":376},[86,1879,93],{"emptyLinePlaceholder":92},[86,1881,1882,1884,1887,1889,1891,1893,1895,1897,1899,1902,1904,1906,1908,1910,1912],{"class":88,"line":383},[86,1883,1754],{"class":99},[86,1885,1886],{"class":103}," reducer",[86,1888,107],{"class":99},[86,1890,1381],{"class":110},[86,1892,272],{"class":117},[86,1894,121],{"class":99},[86,1896,684],{"class":103},[86,1898,107],{"class":99},[86,1900,1901],{"class":110}," defaultState, ",[86,1903,1802],{"class":117},[86,1905,121],{"class":99},[86,1907,1172],{"class":103},[86,1909,284],{"class":110},[86,1911,287],{"class":99},[86,1913,111],{"class":110},[86,1915,1916,1918,1921,1923,1926,1929,1932,1934],{"class":88,"line":389},[86,1917,1813],{"class":99},[86,1919,1920],{"class":124}," nextState",[86,1922,107],{"class":99},[86,1924,1925],{"class":103}," produce",[86,1927,1928],{"class":110},"(state, ",[86,1930,1931],{"class":117},"draft",[86,1933,512],{"class":99},[86,1935,111],{"class":110},[86,1937,1938,1940,1943,1945],{"class":88,"line":394},[86,1939,356],{"class":99},[86,1941,1942],{"class":124}," actionType",[86,1944,107],{"class":99},[86,1946,1947],{"class":110}," actionTypeByActionKey[action.type];\n",[86,1949,1950,1953,1955,1957],{"class":88,"line":400},[86,1951,1952],{"class":110},"      actions[actionType]?.(draft ",[86,1954,211],{"class":99},[86,1956,684],{"class":103},[86,1958,1959],{"class":110},", action.payload);\n",[86,1961,1962],{"class":88,"line":426},[86,1963,1964],{"class":110},"    });\n",[86,1966,1967,1969],{"class":88,"line":432},[86,1968,1851],{"class":99},[86,1970,1971],{"class":110}," nextState;\n",[86,1973,1974],{"class":88,"line":438},[86,1975,1140],{"class":110},[86,1977,1978],{"class":88,"line":443},[86,1979,93],{"emptyLinePlaceholder":92},[86,1981,1982,1984,1987,1989,1991,1993,1995,1997,1999,2002,2004,2006],{"class":88,"line":452},[86,1983,1754],{"class":99},[86,1985,1986],{"class":124}," sliceActions",[86,1988,107],{"class":99},[86,1990,1788],{"class":110},[86,1992,1791],{"class":103},[86,1994,1794],{"class":110},[86,1996,1797],{"class":117},[86,1998,27],{"class":110},[86,2000,2001],{"class":117},"curr",[86,2003,284],{"class":110},[86,2005,287],{"class":99},[86,2007,111],{"class":110},[86,2009,2010,2013,2015,2017,2019,2021,2023],{"class":88,"line":461},[86,2011,2012],{"class":110},"    acc[curr] ",[86,2014,305],{"class":99},[86,2016,1381],{"class":110},[86,2018,1160],{"class":117},[86,2020,284],{"class":110},[86,2022,287],{"class":99},[86,2024,111],{"class":110},[86,2026,2027,2029,2031,2033,2035,2037,2039,2041,2043,2045,2047],{"class":88,"line":466},[86,2028,356],{"class":99},[86,2030,1816],{"class":124},[86,2032,107],{"class":99},[86,2034,1522],{"class":192},[86,2036,1823],{"class":110},[86,2038,1527],{"class":192},[86,2040,2001],{"class":110},[86,2042,1532],{"class":192},[86,2044,1832],{"class":99},[86,2046,1687],{"class":103},[86,2048,128],{"class":110},[86,2050,2051],{"class":88,"line":472},[86,2052,93],{"emptyLinePlaceholder":92},[86,2054,2055,2058],{"class":88,"line":477},[86,2056,2057],{"class":99},"      return",[86,2059,111],{"class":110},[86,2061,2062],{"class":88,"line":483},[86,2063,2064],{"class":110},"        type: scopedActionType,\n",[86,2066,2067],{"class":88,"line":488},[86,2068,2069],{"class":110},"        payload,\n",[86,2071,2072],{"class":88,"line":494},[86,2073,2074],{"class":110},"      };\n",[86,2076,2077],{"class":88,"line":530},[86,2078,2079],{"class":110},"    };\n",[86,2081,2082,2084],{"class":88,"line":535},[86,2083,1851],{"class":99},[86,2085,1854],{"class":110},[86,2087,2088,2090,2092],{"class":88,"line":555},[86,2089,1859],{"class":110},[86,2091,211],{"class":99},[86,2093,111],{"class":110},[86,2095,2096,2099,2101,2104,2106,2108,2110,2112,2114,2116,2119,2121,2123,2125,2127,2129,2131,2133,2135,2137,2139,2141,2144,2146,2148,2150,2152,2154,2156,2158,2160,2162,2165,2167,2169,2172],{"class":88,"line":564},[86,2097,2098],{"class":110},"    [",[86,2100,1466],{"class":103},[86,2102,2103],{"class":99}," in",[86,2105,1610],{"class":103},[86,2107,217],{"class":110},[86,2109,1615],{"class":99},[86,2111,901],{"class":103},[86,2113,27],{"class":110},[86,2115,220],{"class":124},[86,2117,2118],{"class":110},">]",[86,2120,121],{"class":99},[86,2122,1381],{"class":110},[86,2124,1160],{"class":117},[86,2126,121],{"class":99},[86,2128,1652],{"class":103},[86,2130,217],{"class":110},[86,2132,1068],{"class":103},[86,2134,1659],{"class":110},[86,2136,1466],{"class":103},[86,2138,1664],{"class":110},[86,2140,1667],{"class":124},[86,2142,2143],{"class":110},"]) ",[86,2145,287],{"class":99},[86,2147,1680],{"class":110},[86,2149,100],{"class":117},[86,2151,121],{"class":99},[86,2153,1497],{"class":103},[86,2155,217],{"class":110},[86,2157,1466],{"class":103},[86,2159,27],{"class":110},[86,2161,1059],{"class":103},[86,2163,2164],{"class":110},">, ",[86,2166,1160],{"class":117},[86,2168,121],{"class":99},[86,2170,2171],{"class":103}," P",[86,2173,2174],{"class":110}," }\n",[86,2176,2177],{"class":88,"line":570},[86,2178,2179],{"class":110},"  });\n",[86,2181,2182],{"class":88,"line":581},[86,2183,93],{"emptyLinePlaceholder":92},[86,2185,2186,2188],{"class":88,"line":592},[86,2187,1118],{"class":99},[86,2189,111],{"class":110},[86,2191,2192],{"class":88,"line":603},[86,2193,1135],{"class":110},[86,2195,2196],{"class":88,"line":614},[86,2197,1140],{"class":110},[86,2199,2200],{"class":88,"line":620},[86,2201,931],{"class":110},[16,2203,2204],{},"Остановлюсь на некоторых аспектах типизации чуть подробнее",[16,2206,2207,2208,2210,2211],{},"должен быть генериком, который будет на лету подхватывать ключи из переданного объекта ",[20,2209,1068],{},".\nУ объекта в качестве ключа помимо строки может быть число или символ.\nЧтобы избежать проблем с типизацией, нужно достать только строки при помощи  ",[20,2212,2213],{},"Extract\u003Ckeyof Actions, string>",[16,2215,2216,2217,2219,2220,2223,2224,2227,2228,2230,2231],{},"Чтобы сгенерировать экшены с правильным payload (чтобы у ",[20,2218,576],{}," была поддержка типизации и аргументом был именно ",[20,2221,2222],{},"user: User","),\nнужно достать второй аргумент из переданного коллбека. Для этого воспользуемся хелпером ",[20,2225,2226],{},"Parameters","\nи укажем нужный ",[20,2229,1466],{},"-  ",[20,2232,2233],{},"Parameters\u003CActions[ActionType]>[1]",[16,2235,2236],{},"Проверим, что все работает правильно:",[76,2238,2240],{"className":78,"code":2239,"language":81,"meta":82,"style":82},"export const usersSlice = createSlice({\n  name: 'users',\n  defaultState: {\n    userById: {} as Record\u003Cstring, User>,\n    usernameById: {} as Record\u003Cstring, string>,\n  },\n  actions: {\n    addUser: (state, user: User) => {\n      // state должен иметь тот же тип, что и defaultState\n      state.userById[user.id] = user;\n      state.usernameById[user.username] = user.id;\n    },\n    deleteUser: (state, userId: string) => {\n      const user = state.userById[userId];\n      delete state.usernameById[user.username];\n      delete state.userById[userId];\n    }\n  },\n  selectors: {\n    selectUserByUsername: (state, username: string) => state.userById[state.usernameById[username]],\n  }\n});\n\nusersSlice.actions; // можно навести на actions и увидеть его тип\n",[20,2241,2242,2256,2264,2268,2286,2304,2308,2312,2334,2338,2346,2354,2358,2380,2390,2396,2402,2406,2410,2414,2436,2440,2444,2448],{"__ignoreMap":82},[86,2243,2244,2246,2248,2250,2252,2254],{"class":88,"line":89},[86,2245,169],{"class":99},[86,2247,172],{"class":99},[86,2249,175],{"class":124},[86,2251,107],{"class":99},[86,2253,180],{"class":103},[86,2255,183],{"class":110},[86,2257,2258,2260,2262],{"class":88,"line":96},[86,2259,189],{"class":110},[86,2261,193],{"class":192},[86,2263,196],{"class":110},[86,2265,2266],{"class":88,"line":114},[86,2267,202],{"class":110},[86,2269,2270,2272,2274,2276,2278,2280,2282,2284],{"class":88,"line":131},[86,2271,208],{"class":110},[86,2273,211],{"class":99},[86,2275,214],{"class":103},[86,2277,217],{"class":110},[86,2279,220],{"class":124},[86,2281,27],{"class":110},[86,2283,225],{"class":103},[86,2285,228],{"class":110},[86,2287,2288,2290,2292,2294,2296,2298,2300,2302],{"class":88,"line":143},[86,2289,234],{"class":110},[86,2291,211],{"class":99},[86,2293,214],{"class":103},[86,2295,217],{"class":110},[86,2297,220],{"class":124},[86,2299,27],{"class":110},[86,2301,220],{"class":124},[86,2303,228],{"class":110},[86,2305,2306],{"class":88,"line":155},[86,2307,254],{"class":110},[86,2309,2310],{"class":88,"line":161},[86,2311,260],{"class":110},[86,2313,2314,2316,2318,2320,2322,2324,2326,2328,2330,2332],{"class":88,"line":166},[86,2315,266],{"class":103},[86,2317,269],{"class":110},[86,2319,272],{"class":117},[86,2321,27],{"class":110},[86,2323,277],{"class":117},[86,2325,121],{"class":99},[86,2327,104],{"class":103},[86,2329,284],{"class":110},[86,2331,287],{"class":99},[86,2333,111],{"class":110},[86,2335,2336],{"class":88,"line":186},[86,2337,296],{"class":295},[86,2339,2340,2342,2344],{"class":88,"line":199},[86,2341,302],{"class":110},[86,2343,305],{"class":99},[86,2345,308],{"class":110},[86,2347,2348,2350,2352],{"class":88,"line":205},[86,2349,314],{"class":110},[86,2351,305],{"class":99},[86,2353,319],{"class":110},[86,2355,2356],{"class":88,"line":231},[86,2357,325],{"class":110},[86,2359,2360,2362,2364,2366,2368,2370,2372,2374,2376,2378],{"class":88,"line":251},[86,2361,331],{"class":103},[86,2363,269],{"class":110},[86,2365,272],{"class":117},[86,2367,27],{"class":110},[86,2369,340],{"class":117},[86,2371,121],{"class":99},[86,2373,125],{"class":124},[86,2375,284],{"class":110},[86,2377,287],{"class":99},[86,2379,111],{"class":110},[86,2381,2382,2384,2386,2388],{"class":88,"line":257},[86,2383,356],{"class":99},[86,2385,359],{"class":124},[86,2387,107],{"class":99},[86,2389,364],{"class":110},[86,2391,2392,2394],{"class":88,"line":263},[86,2393,370],{"class":99},[86,2395,373],{"class":110},[86,2397,2398,2400],{"class":88,"line":292},[86,2399,370],{"class":99},[86,2401,364],{"class":110},[86,2403,2404],{"class":88,"line":299},[86,2405,386],{"class":110},[86,2407,2408],{"class":88,"line":311},[86,2409,254],{"class":110},[86,2411,2412],{"class":88,"line":322},[86,2413,397],{"class":110},[86,2415,2416,2418,2420,2422,2424,2426,2428,2430,2432,2434],{"class":88,"line":328},[86,2417,403],{"class":103},[86,2419,269],{"class":110},[86,2421,272],{"class":117},[86,2423,27],{"class":110},[86,2425,412],{"class":117},[86,2427,121],{"class":99},[86,2429,125],{"class":124},[86,2431,284],{"class":110},[86,2433,287],{"class":99},[86,2435,423],{"class":110},[86,2437,2438],{"class":88,"line":353},[86,2439,429],{"class":110},[86,2441,2442],{"class":88,"line":367},[86,2443,435],{"class":110},[86,2445,2446],{"class":88,"line":376},[86,2447,93],{"emptyLinePlaceholder":92},[86,2449,2450,2453],{"class":88,"line":383},[86,2451,2452],{"class":110},"usersSlice.actions; ",[86,2454,2455],{"class":295},"// можно навести на actions и увидеть его тип\n",[16,2457,2458],{},[2459,2460],"img",{"alt":2461,"src":2462},"Подсказка в vs code","/images/actions-type-hightlight.png",[11,2464,2466],{"id":2465},"reducer","Редьюсер",[16,2468,2469,2470,1467,2472,2474,2475,2478],{},"По своей сути редьюсер - это чистая функция, которая принимает два аргумента - ",[20,2471,272],{},[20,2473,1802],{}," и возвращает ",[20,2476,2477],{},"nextState",".\nОчень важно при этом, чтобы стейт был иммутабельным, ради этого обычно используются страшные конструкции вроде",[76,2480,2482],{"className":78,"code":2481,"language":81,"meta":82,"style":82},"const nextState = {\n  ...state,\n  userById: {\n    ...state.userById,\n    [user.id]: user, \n  }\n};\n",[20,2483,2484,2494,2502,2507,2515,2520,2524],{"__ignoreMap":82},[86,2485,2486,2488,2490,2492],{"class":88,"line":89},[86,2487,497],{"class":99},[86,2489,1920],{"class":124},[86,2491,107],{"class":99},[86,2493,111],{"class":110},[86,2495,2496,2499],{"class":88,"line":96},[86,2497,2498],{"class":99},"  ...",[86,2500,2501],{"class":110},"state,\n",[86,2503,2504],{"class":88,"line":114},[86,2505,2506],{"class":110},"  userById: {\n",[86,2508,2509,2512],{"class":88,"line":131},[86,2510,2511],{"class":99},"    ...",[86,2513,2514],{"class":110},"state.userById,\n",[86,2516,2517],{"class":88,"line":143},[86,2518,2519],{"class":110},"    [user.id]: user, \n",[86,2521,2522],{"class":88,"line":155},[86,2523,429],{"class":110},[86,2525,2526],{"class":88,"line":161},[86,2527,931],{"class":110},[16,2529,2530,2531,2535,2536,2540,2541,2545],{},"Чтобы облегчить себе жизнь, для создания иммутабельного стейта предлагаю использовать\n",[43,2532,2533],{"href":2533,"rel":2534},"https://www.npmjs.com/package/immer",[47],"](",[43,2537,2538],{"href":2538,"rel":2539},"https://github.com/immerjs/immer",[47],"), в частности метод\nproduce](",[43,2542,2543],{"href":2543,"rel":2544},"https://immerjs.github.io/immer/produce",[47],")",[16,2547,2548,2549,2552],{},"таким образом все, что нам нужно - это вызвать внутри ",[20,2550,2551],{},"produce"," нужный коллбек (экшен), передав туда драфт стейта и payload экшена",[76,2554,2556],{"className":78,"code":2555,"language":81,"meta":82,"style":82},"const reducer = (state: State = defaultState, action: Action) => {\n  const nextState = produce(state, draft => {\n    actions[action.type]?.(draft as State, action.payload);\n  });\n  return nextState;\n};\n",[20,2557,2558,2590,2608,2619,2623,2629],{"__ignoreMap":82},[86,2559,2560,2562,2564,2566,2568,2570,2572,2574,2576,2578,2580,2582,2584,2586,2588],{"class":88,"line":89},[86,2561,497],{"class":99},[86,2563,1886],{"class":103},[86,2565,107],{"class":99},[86,2567,1381],{"class":110},[86,2569,272],{"class":117},[86,2571,121],{"class":99},[86,2573,684],{"class":103},[86,2575,107],{"class":99},[86,2577,1901],{"class":110},[86,2579,1802],{"class":117},[86,2581,121],{"class":99},[86,2583,1172],{"class":103},[86,2585,284],{"class":110},[86,2587,287],{"class":99},[86,2589,111],{"class":110},[86,2591,2592,2594,2596,2598,2600,2602,2604,2606],{"class":88,"line":96},[86,2593,1754],{"class":99},[86,2595,1920],{"class":124},[86,2597,107],{"class":99},[86,2599,1925],{"class":103},[86,2601,1928],{"class":110},[86,2603,1931],{"class":117},[86,2605,512],{"class":99},[86,2607,111],{"class":110},[86,2609,2610,2613,2615,2617],{"class":88,"line":114},[86,2611,2612],{"class":110},"    actions[action.type]?.(draft ",[86,2614,211],{"class":99},[86,2616,684],{"class":103},[86,2618,1959],{"class":110},[86,2620,2621],{"class":88,"line":131},[86,2622,2179],{"class":110},[86,2624,2625,2627],{"class":88,"line":143},[86,2626,1118],{"class":99},[86,2628,1971],{"class":110},[86,2630,2631],{"class":88,"line":155},[86,2632,931],{"class":110},[11,2634,2636],{"id":2635},"selectors","Селекторы",[16,2638,2639,2640,2643],{},"Для работы в связке с react + redux используется хук ",[20,2641,2642],{},"useSelector"," .",[16,2645,2646,2647,2545],{},"Чтобы реакт знал и мог реагировать (делать ререндер компонента) на изменения в стейте существует метод\nuseSyncExternalStore](",[43,2648,2649],{"href":2649,"rel":2650},"https://react.dev/reference/react/useSyncExternalStore",[47],[16,2652,2653],{},"Например, чтобы получить актуальный стейт, можно написать следующий код:",[76,2655,2657],{"className":78,"code":2656,"language":81,"meta":82,"style":82},"const useStore = () => {\n  const state = useSyncExternalStore(\n    myStore.subscribe,\n    myStore.getState,\n  );\n\n  return state;\n};\n",[20,2658,2659,2675,2689,2694,2699,2703,2707,2714],{"__ignoreMap":82},[86,2660,2661,2663,2666,2668,2671,2673],{"class":88,"line":89},[86,2662,497],{"class":99},[86,2664,2665],{"class":103}," useStore",[86,2667,107],{"class":99},[86,2669,2670],{"class":110}," () ",[86,2672,287],{"class":99},[86,2674,111],{"class":110},[86,2676,2677,2679,2682,2684,2687],{"class":88,"line":96},[86,2678,1754],{"class":99},[86,2680,2681],{"class":124}," state",[86,2683,107],{"class":99},[86,2685,2686],{"class":103}," useSyncExternalStore",[86,2688,561],{"class":110},[86,2690,2691],{"class":88,"line":114},[86,2692,2693],{"class":110},"    myStore.subscribe,\n",[86,2695,2696],{"class":88,"line":131},[86,2697,2698],{"class":110},"    myStore.getState,\n",[86,2700,2701],{"class":88,"line":143},[86,2702,623],{"class":110},[86,2704,2705],{"class":88,"line":155},[86,2706,93],{"emptyLinePlaceholder":92},[86,2708,2709,2711],{"class":88,"line":161},[86,2710,1118],{"class":99},[86,2712,2713],{"class":110}," state;\n",[86,2715,2716],{"class":88,"line":166},[86,2717,931],{"class":110},[16,2719,2720,2721,2724],{},"Мы могли бы даже использовать селектор, чтобы достать из стора нужные нам данные,\nоднако такая реализация будет реагировать на ",[52,2722,2723],{},"любые"," изменения в стейте.",[16,2726,2727],{},"Мы же хотим, чтобы наш useSelector реагировал только на изменения результата селектора, а не всего стейта.\nТ.е. чтобы селектор",[76,2729,2731],{"className":78,"code":2730,"language":81,"meta":82,"style":82},"const username = useSelector(state => state.users.usersById['some-id'].username);\n",[20,2732,2733],{"__ignoreMap":82},[86,2734,2735,2737,2740,2742,2744,2746,2748,2750,2753,2756],{"class":88,"line":89},[86,2736,497],{"class":99},[86,2738,2739],{"class":124}," username",[86,2741,107],{"class":99},[86,2743,504],{"class":103},[86,2745,507],{"class":110},[86,2747,272],{"class":117},[86,2749,512],{"class":99},[86,2751,2752],{"class":110}," state.users.usersById[",[86,2754,2755],{"class":192},"'some-id'",[86,2757,2758],{"class":110},"].username);\n",[16,2760,2761],{},"реагировал только на изменение username конкретного юзера (с id = “some-id”).",[16,2763,2764,2765,2768,2769,2772],{},"Предлагаю не писать велосипед и использовать ",[20,2766,2767],{},"useSyncExternalStoreWithSelector",".\nЭто модифицированная версия ",[20,2770,2771],{},"useSyncExternalStore"," c поддержкой селекторов и мемоизацией.",[16,2774,2775,2776,2778],{},"Таким образом хелпер для создания ",[20,2777,2642],{}," будет выглядеть следующим образом:",[76,2780,2782],{"className":78,"code":2781,"language":81,"meta":82,"style":82},"import type { Store as ReduxStore } from 'redux';\nimport { useSyncExternalStoreWithSelector } from 'use-sync-external-store/with-selector';\n\nexport const createUseSelector = \u003C\n  Store extends ReduxStore,\n  State extends ReturnType\u003CStore['getState']>,\n>(store: Store) => {\n  const useSelector = \u003CSelector extends (state: State) => unknown>(selector: Selector) => {\n    return useSyncExternalStoreWithSelector(\n      store.subscribe,\n      store.getState,\n      store.getState,\n      selector\n    ) as ReturnType\u003CSelector>;\n  };\n\n  return useSelector;\n};\n",[20,2783,2784,2808,2822,2826,2839,2851,2873,2892,2938,2947,2952,2957,2961,2966,2982,2986,2990,2997],{"__ignoreMap":82},[86,2785,2786,2789,2792,2795,2797,2800,2803,2806],{"class":88,"line":89},[86,2787,2788],{"class":99},"import",[86,2790,2791],{"class":99}," type",[86,2793,2794],{"class":110}," { Store ",[86,2796,211],{"class":99},[86,2798,2799],{"class":110}," ReduxStore } ",[86,2801,2802],{"class":99},"from",[86,2804,2805],{"class":192}," 'redux'",[86,2807,128],{"class":110},[86,2809,2810,2812,2815,2817,2820],{"class":88,"line":96},[86,2811,2788],{"class":99},[86,2813,2814],{"class":110}," { useSyncExternalStoreWithSelector } ",[86,2816,2802],{"class":99},[86,2818,2819],{"class":192}," 'use-sync-external-store/with-selector'",[86,2821,128],{"class":110},[86,2823,2824],{"class":88,"line":114},[86,2825,93],{"emptyLinePlaceholder":92},[86,2827,2828,2830,2832,2835,2837],{"class":88,"line":131},[86,2829,169],{"class":99},[86,2831,172],{"class":99},[86,2833,2834],{"class":103}," createUseSelector",[86,2836,107],{"class":99},[86,2838,948],{"class":110},[86,2840,2841,2844,2846,2849],{"class":88,"line":143},[86,2842,2843],{"class":103},"  Store",[86,2845,797],{"class":99},[86,2847,2848],{"class":103}," ReduxStore",[86,2850,196],{"class":110},[86,2852,2853,2855,2857,2860,2862,2865,2867,2870],{"class":88,"line":155},[86,2854,806],{"class":103},[86,2856,797],{"class":99},[86,2858,2859],{"class":103}," ReturnType",[86,2861,217],{"class":110},[86,2863,2864],{"class":103},"Store",[86,2866,1659],{"class":110},[86,2868,2869],{"class":192},"'getState'",[86,2871,2872],{"class":110},"]>,\n",[86,2874,2875,2878,2881,2883,2886,2888,2890],{"class":88,"line":161},[86,2876,2877],{"class":110},">(",[86,2879,2880],{"class":117},"store",[86,2882,121],{"class":99},[86,2884,2885],{"class":103}," Store",[86,2887,284],{"class":110},[86,2889,287],{"class":99},[86,2891,111],{"class":110},[86,2893,2894,2896,2898,2900,2903,2906,2908,2910,2912,2914,2916,2918,2920,2922,2924,2927,2929,2932,2934,2936],{"class":88,"line":166},[86,2895,1754],{"class":99},[86,2897,504],{"class":103},[86,2899,107],{"class":99},[86,2901,2902],{"class":110}," \u003C",[86,2904,2905],{"class":103},"Selector",[86,2907,797],{"class":99},[86,2909,1381],{"class":110},[86,2911,272],{"class":117},[86,2913,121],{"class":99},[86,2915,684],{"class":103},[86,2917,284],{"class":110},[86,2919,287],{"class":99},[86,2921,731],{"class":124},[86,2923,2877],{"class":110},[86,2925,2926],{"class":117},"selector",[86,2928,121],{"class":99},[86,2930,2931],{"class":103}," Selector",[86,2933,284],{"class":110},[86,2935,287],{"class":99},[86,2937,111],{"class":110},[86,2939,2940,2942,2945],{"class":88,"line":186},[86,2941,1851],{"class":99},[86,2943,2944],{"class":103}," useSyncExternalStoreWithSelector",[86,2946,561],{"class":110},[86,2948,2949],{"class":88,"line":199},[86,2950,2951],{"class":110},"      store.subscribe,\n",[86,2953,2954],{"class":88,"line":205},[86,2955,2956],{"class":110},"      store.getState,\n",[86,2958,2959],{"class":88,"line":231},[86,2960,2956],{"class":110},[86,2962,2963],{"class":88,"line":251},[86,2964,2965],{"class":110},"      selector\n",[86,2967,2968,2971,2973,2975,2977,2979],{"class":88,"line":257},[86,2969,2970],{"class":110},"    ) ",[86,2972,211],{"class":99},[86,2974,2859],{"class":103},[86,2976,217],{"class":110},[86,2978,2905],{"class":103},[86,2980,2981],{"class":110},">;\n",[86,2983,2984],{"class":88,"line":263},[86,2985,1140],{"class":110},[86,2987,2988],{"class":88,"line":292},[86,2989,93],{"emptyLinePlaceholder":92},[86,2991,2992,2994],{"class":88,"line":299},[86,2993,1118],{"class":99},[86,2995,2996],{"class":110}," useSelector;\n",[86,2998,2999],{"class":88,"line":311},[86,3000,931],{"class":110},[11,3002,3004],{"id":3003},"global-store","Глобальный стор",[16,3006,3007,3008,3011],{},"В redux-toolkit есть метод ",[20,3009,3010],{},"configureStore"," для создания глобального стора.\nПредлагаю написать минималистичную версию, которая лишь объединяет редьюсеры и создает store",[76,3013,3015],{"className":78,"code":3014,"language":81,"meta":82,"style":82},"import type { Reducer } from 'redux';\n\ntype SliceAction\u003CType extends string = string, Payload = unknown> = {\n  type: Type,\n  payload: Payload,\n}\n\ntype SimpleSlice\u003CName extends string, ReducerType extends Reducer\u003Cany, any>> = {\n  name: Name;\n  reducer: ReducerType,\n}\n\ntype TypesFromSlices\u003CT> = T extends readonly { name: infer Name extends string, reducer: Reducer\u003Cinfer State, infer Action> }[]\n  ? Action extends SliceAction\u003Cinfer Type, infer Payload>\n  ? {\n    action: SliceAction\u003CType, Payload>,\n    state: { [P in Name]: State }\n  } : never : never\n\nexport const configureStore = \u003C\n  Slice extends SimpleSlice\u003Cstring, Reducer\u003Cany, any, any>>,\n  State extends TypesFromSlices\u003CSlice[]>['state'],\n  Action extends TypesFromSlices\u003CSlice[]>['action'],\n>(slices: Slice[]) => {\n  const reducersByName = slices.reduce((acc, current) => {\n    acc[current.name] = current.reducer;\n    return acc;\n  }, {} as Record\u003Cstring, Reducer>);\n\n  const reducer = combineReducers(reducersByName) as Reducer\u003CState, Action>;\n\n  const store = createStore(reducer);\n\n  return {\n    store,\n  };\n};\n",[20,3016,3017,3032,3036,3069,3079,3089,3093,3097,3138,3148,3160,3164,3168,3231,3257,3263,3282,3308,3324,3328,3341,3373,3394,3413,3432,3461,3471,3477,3495,3499,3528,3532,3547,3551,3557,3562,3566],{"__ignoreMap":82},[86,3018,3019,3021,3023,3026,3028,3030],{"class":88,"line":89},[86,3020,2788],{"class":99},[86,3022,2791],{"class":99},[86,3024,3025],{"class":110}," { Reducer } ",[86,3027,2802],{"class":99},[86,3029,2805],{"class":192},[86,3031,128],{"class":110},[86,3033,3034],{"class":88,"line":96},[86,3035,93],{"emptyLinePlaceholder":92},[86,3037,3038,3040,3043,3045,3047,3049,3051,3053,3055,3057,3059,3061,3063,3065,3067],{"class":88,"line":114},[86,3039,100],{"class":99},[86,3041,3042],{"class":103}," SliceAction",[86,3044,217],{"class":110},[86,3046,1177],{"class":103},[86,3048,797],{"class":99},[86,3050,125],{"class":124},[86,3052,107],{"class":99},[86,3054,125],{"class":124},[86,3056,27],{"class":110},[86,3058,661],{"class":103},[86,3060,107],{"class":99},[86,3062,731],{"class":124},[86,3064,669],{"class":110},[86,3066,305],{"class":99},[86,3068,111],{"class":110},[86,3070,3071,3073,3075,3077],{"class":88,"line":131},[86,3072,1204],{"class":117},[86,3074,121],{"class":99},[86,3076,1209],{"class":103},[86,3078,196],{"class":110},[86,3080,3081,3083,3085,3087],{"class":88,"line":143},[86,3082,691],{"class":117},[86,3084,121],{"class":99},[86,3086,1221],{"class":103},[86,3088,196],{"class":110},[86,3090,3091],{"class":88,"line":155},[86,3092,158],{"class":110},[86,3094,3095],{"class":88,"line":161},[86,3096,93],{"emptyLinePlaceholder":92},[86,3098,3099,3101,3104,3106,3108,3110,3112,3114,3117,3119,3122,3124,3127,3129,3131,3134,3136],{"class":88,"line":166},[86,3100,100],{"class":99},[86,3102,3103],{"class":103}," SimpleSlice",[86,3105,217],{"class":110},[86,3107,1059],{"class":103},[86,3109,797],{"class":99},[86,3111,125],{"class":124},[86,3113,27],{"class":110},[86,3115,3116],{"class":103},"ReducerType",[86,3118,797],{"class":99},[86,3120,3121],{"class":103}," Reducer",[86,3123,217],{"class":110},[86,3125,3126],{"class":124},"any",[86,3128,27],{"class":110},[86,3130,3126],{"class":124},[86,3132,3133],{"class":110},">> ",[86,3135,305],{"class":99},[86,3137,111],{"class":110},[86,3139,3140,3142,3144,3146],{"class":88,"line":186},[86,3141,884],{"class":117},[86,3143,121],{"class":99},[86,3145,889],{"class":103},[86,3147,128],{"class":110},[86,3149,3150,3153,3155,3158],{"class":88,"line":199},[86,3151,3152],{"class":117},"  reducer",[86,3154,121],{"class":99},[86,3156,3157],{"class":103}," ReducerType",[86,3159,196],{"class":110},[86,3161,3162],{"class":88,"line":205},[86,3163,158],{"class":110},[86,3165,3166],{"class":88,"line":231},[86,3167,93],{"emptyLinePlaceholder":92},[86,3169,3170,3172,3175,3177,3180,3182,3184,3187,3189,3192,3194,3196,3198,3201,3203,3205,3207,3209,3211,3213,3215,3217,3220,3222,3224,3226,3228],{"class":88,"line":251},[86,3171,100],{"class":99},[86,3173,3174],{"class":103}," TypesFromSlices",[86,3176,217],{"class":110},[86,3178,3179],{"class":103},"T",[86,3181,669],{"class":110},[86,3183,305],{"class":99},[86,3185,3186],{"class":103}," T",[86,3188,797],{"class":99},[86,3190,3191],{"class":99}," readonly",[86,3193,1680],{"class":110},[86,3195,1823],{"class":117},[86,3197,121],{"class":99},[86,3199,3200],{"class":99}," infer",[86,3202,889],{"class":103},[86,3204,797],{"class":99},[86,3206,125],{"class":124},[86,3208,27],{"class":110},[86,3210,2465],{"class":117},[86,3212,121],{"class":99},[86,3214,3121],{"class":103},[86,3216,217],{"class":110},[86,3218,3219],{"class":99},"infer",[86,3221,684],{"class":103},[86,3223,27],{"class":110},[86,3225,3219],{"class":99},[86,3227,1172],{"class":103},[86,3229,3230],{"class":110},"> }[]\n",[86,3232,3233,3236,3238,3240,3242,3244,3246,3248,3250,3252,3254],{"class":88,"line":257},[86,3234,3235],{"class":99},"  ?",[86,3237,1172],{"class":103},[86,3239,797],{"class":99},[86,3241,3042],{"class":103},[86,3243,217],{"class":110},[86,3245,3219],{"class":99},[86,3247,1209],{"class":103},[86,3249,27],{"class":110},[86,3251,3219],{"class":99},[86,3253,1221],{"class":103},[86,3255,3256],{"class":110},">\n",[86,3258,3259,3261],{"class":88,"line":263},[86,3260,3235],{"class":99},[86,3262,111],{"class":110},[86,3264,3265,3268,3270,3272,3274,3276,3278,3280],{"class":88,"line":292},[86,3266,3267],{"class":117},"    action",[86,3269,121],{"class":99},[86,3271,3042],{"class":103},[86,3273,217],{"class":110},[86,3275,1177],{"class":103},[86,3277,27],{"class":110},[86,3279,661],{"class":103},[86,3281,228],{"class":110},[86,3283,3284,3287,3289,3292,3295,3297,3299,3302,3304,3306],{"class":88,"line":299},[86,3285,3286],{"class":117},"    state",[86,3288,121],{"class":99},[86,3290,3291],{"class":110}," { [",[86,3293,3294],{"class":103},"P",[86,3296,2103],{"class":99},[86,3298,889],{"class":103},[86,3300,3301],{"class":110},"]",[86,3303,121],{"class":99},[86,3305,684],{"class":103},[86,3307,2174],{"class":110},[86,3309,3310,3313,3315,3318,3321],{"class":88,"line":311},[86,3311,3312],{"class":110},"  } ",[86,3314,121],{"class":99},[86,3316,3317],{"class":124}," never",[86,3319,3320],{"class":99}," :",[86,3322,3323],{"class":124}," never\n",[86,3325,3326],{"class":88,"line":322},[86,3327,93],{"emptyLinePlaceholder":92},[86,3329,3330,3332,3334,3337,3339],{"class":88,"line":328},[86,3331,169],{"class":99},[86,3333,172],{"class":99},[86,3335,3336],{"class":103}," configureStore",[86,3338,107],{"class":99},[86,3340,948],{"class":110},[86,3342,3343,3346,3348,3350,3352,3354,3356,3359,3361,3363,3365,3367,3369,3371],{"class":88,"line":353},[86,3344,3345],{"class":103},"  Slice",[86,3347,797],{"class":99},[86,3349,3103],{"class":103},[86,3351,217],{"class":110},[86,3353,220],{"class":124},[86,3355,27],{"class":110},[86,3357,3358],{"class":103},"Reducer",[86,3360,217],{"class":110},[86,3362,3126],{"class":124},[86,3364,27],{"class":110},[86,3366,3126],{"class":124},[86,3368,27],{"class":110},[86,3370,3126],{"class":124},[86,3372,846],{"class":110},[86,3374,3375,3377,3379,3381,3383,3386,3389,3392],{"class":88,"line":367},[86,3376,806],{"class":103},[86,3378,797],{"class":99},[86,3380,3174],{"class":103},[86,3382,217],{"class":110},[86,3384,3385],{"class":103},"Slice",[86,3387,3388],{"class":110},"[]>[",[86,3390,3391],{"class":192},"'state'",[86,3393,1670],{"class":110},[86,3395,3396,3398,3400,3402,3404,3406,3408,3411],{"class":88,"line":376},[86,3397,1675],{"class":103},[86,3399,797],{"class":99},[86,3401,3174],{"class":103},[86,3403,217],{"class":110},[86,3405,3385],{"class":103},[86,3407,3388],{"class":110},[86,3409,3410],{"class":192},"'action'",[86,3412,1670],{"class":110},[86,3414,3415,3417,3420,3422,3425,3428,3430],{"class":88,"line":383},[86,3416,2877],{"class":110},[86,3418,3419],{"class":117},"slices",[86,3421,121],{"class":99},[86,3423,3424],{"class":103}," Slice",[86,3426,3427],{"class":110},"[]) ",[86,3429,287],{"class":99},[86,3431,111],{"class":110},[86,3433,3434,3436,3439,3441,3444,3446,3448,3450,3452,3455,3457,3459],{"class":88,"line":389},[86,3435,1754],{"class":99},[86,3437,3438],{"class":124}," reducersByName",[86,3440,107],{"class":99},[86,3442,3443],{"class":110}," slices.",[86,3445,1791],{"class":103},[86,3447,1794],{"class":110},[86,3449,1797],{"class":117},[86,3451,27],{"class":110},[86,3453,3454],{"class":117},"current",[86,3456,284],{"class":110},[86,3458,287],{"class":99},[86,3460,111],{"class":110},[86,3462,3463,3466,3468],{"class":88,"line":394},[86,3464,3465],{"class":110},"    acc[current.name] ",[86,3467,305],{"class":99},[86,3469,3470],{"class":110}," current.reducer;\n",[86,3472,3473,3475],{"class":88,"line":400},[86,3474,1851],{"class":99},[86,3476,1854],{"class":110},[86,3478,3479,3481,3483,3485,3487,3489,3491,3493],{"class":88,"line":426},[86,3480,1859],{"class":110},[86,3482,211],{"class":99},[86,3484,214],{"class":103},[86,3486,217],{"class":110},[86,3488,220],{"class":124},[86,3490,27],{"class":110},[86,3492,3358],{"class":103},[86,3494,1875],{"class":110},[86,3496,3497],{"class":88,"line":432},[86,3498,93],{"emptyLinePlaceholder":92},[86,3500,3501,3503,3505,3507,3510,3513,3515,3517,3519,3521,3523,3526],{"class":88,"line":438},[86,3502,1754],{"class":99},[86,3504,1886],{"class":124},[86,3506,107],{"class":99},[86,3508,3509],{"class":103}," combineReducers",[86,3511,3512],{"class":110},"(reducersByName) ",[86,3514,211],{"class":99},[86,3516,3121],{"class":103},[86,3518,217],{"class":110},[86,3520,656],{"class":103},[86,3522,27],{"class":110},[86,3524,3525],{"class":103},"Action",[86,3527,2981],{"class":110},[86,3529,3530],{"class":88,"line":443},[86,3531,93],{"emptyLinePlaceholder":92},[86,3533,3534,3536,3539,3541,3544],{"class":88,"line":452},[86,3535,1754],{"class":99},[86,3537,3538],{"class":124}," store",[86,3540,107],{"class":99},[86,3542,3543],{"class":103}," createStore",[86,3545,3546],{"class":110},"(reducer);\n",[86,3548,3549],{"class":88,"line":461},[86,3550,93],{"emptyLinePlaceholder":92},[86,3552,3553,3555],{"class":88,"line":466},[86,3554,1118],{"class":99},[86,3556,111],{"class":110},[86,3558,3559],{"class":88,"line":472},[86,3560,3561],{"class":110},"    store,\n",[86,3563,3564],{"class":88,"line":477},[86,3565,1140],{"class":110},[86,3567,3568],{"class":88,"line":483},[86,3569,931],{"class":110},[16,3571,3572,3573,3576,3577,3579,3580,3583,3584,3586,3587,1467,3589,3591,3592,3594,3595,3597,3598,1467,3600,3602,3603,3605,3606,1467,3608,3610,3611,1467,3613],{},"Чтобы правильно типизировать созданный стор, нужно указать стейт и экшены редьюсера,\nкоторый будет создан при помощи ",[20,3574,3575],{},"combineReducers",".\nМы можем извлечь стейт и экшены из редьюсеров при помощи ",[20,3578,3219],{},".\nВ хелпере ",[20,3581,3582],{},"TypesFromSlices"," мы постепенно проверяем сначала, что ",[20,3585,3179],{}," расширяет массив объектов,\nгде есть два интересующих нас поля - ",[20,3588,1823],{},[20,3590,2465],{},". Мы можем вытащить типы этих полей при помощи ",[20,3593,3219],{},".\nПохожим образом при помощи ",[20,3596,3219],{}," можно вытащить типы ",[20,3599,656],{},[20,3601,3525],{},".\nИз ",[20,3604,3525],{}," в свою очередь можно достать ",[20,3607,1177],{},[20,3609,661],{},".\nПосле этого мы можем вернуть извлеченные типы для ",[20,3612,1802],{},[20,3614,272],{},[11,3616,3618],{"id":3617},"bring-all-together","Собираем все вместе",[76,3620,3623],{"className":78,"code":3621,"filename":3622,"language":81,"meta":82,"style":82},"\nimport { createStore, combineReducers } from 'redux';\nimport type { Store as ReduxStore, Reducer } from 'redux';\nimport { produce } from 'immer';\nimport { useSyncExternalStoreWithSelector } from 'use-sync-external-store/with-selector';\n\ntype SliceActionCreator\u003CState, Payload = any> = (state: State, payload: Payload) => void\n\ntype SliceSelector\u003CState, Payload = any> = (state: State, payload: Payload) => void\n\ntype Scoped\u003CString extends string, Scope extends string> = `${Scope}/${String}`;\n\ntype CreateSliceProps\u003C\n  Name extends string,\n  State extends Record\u003Cstring, unknown>,\n  Actions extends Record\u003Cstring, SliceActionCreator\u003CState>>,\n  Selectors extends Record\u003Cstring, SliceSelector\u003CState>>\n> = {\n  name: Name\n  actions: Actions\n  defaultState: State\n  selectors: Selectors\n}\n\nexport const createSlice = \u003C\n  Name extends string,\n  State extends Record\u003Cstring, unknown>,\n  Actions extends Record\u003Cstring, SliceActionCreator\u003CState>>,\n  ActionKey extends Extract\u003Ckeyof Actions, string>,\n  ScopedActionType extends Scoped\u003CActionKey, Name>,\n  Selectors extends Record\u003Cstring, SliceSelector\u003CState>>,\n  ActionPayload extends Parameters\u003CActions[ActionKey]>[1],\n  Action extends { type: ScopedActionType, payload: ActionPayload },\n>({\n    name,\n    actions,\n    defaultState,\n    selectors,\n  }: CreateSliceProps\u003CName, State, Actions, Selectors>) => {\n  const actionKeys = Object.keys(actions) as ActionKey[];\n  const actionTypeByActionKey = actionKeys.reduce((acc, action) => {\n    const scopedActionType = `${name}/${action}` as ScopedActionType;\n    acc[scopedActionType] = action;\n    return acc;\n  }, {} as Record\u003CScopedActionType, ActionKey>);\n\n  const reducer = (state: State = defaultState, action: Action) => {\n    const nextState = produce(state, draft => {\n      const actionType = actionTypeByActionKey[action.type];\n      actions[actionType]?.(draft as State, action.payload);\n    });\n    return nextState;\n  };\n\n  const sliceActions = actionKeys.reduce((acc, curr) => {\n    acc[curr] = (payload) => {\n      const scopedActionType = `${name}/${curr}` as ScopedActionType;\n\n      return {\n        type: scopedActionType,\n        payload,\n      };\n    };\n    return acc;\n  }, {} as {\n    [ActionKey in Extract\u003Ckeyof Actions, string>]: \u003CP extends Parameters\u003CActions[ActionKey]>[1]>(payload: P) => { type: Scoped\u003CActionKey, Name>, payload: P }\n  });\n\n  return {\n    name,\n    reducer,\n    actions: sliceActions,\n    selectors: selectors,\n  };\n};\n\ntype SliceAction\u003CType extends string = string, Payload = unknown> = {\n  type: Type,\n  payload: Payload,\n}\n\ntype SimpleSlice\u003CName extends string, ReducerType extends Reducer\u003Cany, any>> = {\n  name: Name;\n  reducer: ReducerType,\n}\n\ntype TypesFromSlices\u003CT> = T extends { name: infer Name extends string, reducer: Reducer\u003Cinfer State, infer Action> }[]\n  ? Action extends SliceAction\u003Cinfer Type, infer Payload>\n  ? {\n    action: SliceAction\u003CType, Payload>,\n    state: { [P in Name]: State }\n  } : never : never\n\nexport const configureStore = \u003C\n  Slice extends SimpleSlice\u003Cstring, Reducer\u003Cany, any, any>>,\n  State extends TypesFromSlices\u003CSlice[]>['state'],\n  Action extends TypesFromSlices\u003CSlice[]>['action'],\n>(slices: Slice[]) => {\n  const reducersByName = slices.reduce((acc, current) => {\n    acc[current.name] = current.reducer;\n    return acc;\n  }, {} as Record\u003Cstring, Reducer>);\n\n  const reducer = combineReducers(reducersByName) as Reducer\u003CState, Action>;\n\n  const store = createStore(reducer);\n\n  return {\n    store,\n  };\n};\n\nexport const createUseSelector = \u003C\n  Store extends ReduxStore,\n  State extends ReturnType\u003CStore['getState']>,\n>(store: Store) => {\n  const useSelector = \u003CSelector extends (state: State) => unknown>(selector: Selector) => {\n    return useSyncExternalStoreWithSelector(\n      store.subscribe,\n      store.getState,\n      store.getState,\n      selector\n    ) as ReturnType\u003CSelector>;\n  };\n\n  return useSelector;\n};\n\n","myReduxToolkit.ts",[20,3624,3625,3629,3642,3661,3675,3687,3691,3736,3740,3784,3788,3826,3830,3838,3848,3866,3888,3910,3918,3927,3936,3945,3954,3958,3962,3974,3984,4002,4024,4044,4062,4084,4106,4130,4134,4138,4142,4146,4150,4180,4200,4226,4250,4258,4264,4282,4286,4318,4336,4346,4356,4361,4368,4373,4378,4405,4422,4447,4452,4459,4464,4469,4474,4479,4486,4495,4579,4584,4589,4596,4601,4606,4611,4617,4622,4627,4632,4665,4676,4687,4692,4697,4734,4745,4756,4761,4766,4821,4846,4853,4872,4895,4908,4913,4926,4957,4976,4995,5012,5039,5048,5055,5074,5079,5106,5111,5124,5129,5136,5141,5146,5151,5156,5169,5180,5199,5216,5259,5268,5273,5278,5283,5288,5303,5308,5313,5320],{"__ignoreMap":82},[86,3626,3627],{"class":88,"line":89},[86,3628,93],{"emptyLinePlaceholder":92},[86,3630,3631,3633,3636,3638,3640],{"class":88,"line":96},[86,3632,2788],{"class":99},[86,3634,3635],{"class":110}," { createStore, combineReducers } ",[86,3637,2802],{"class":99},[86,3639,2805],{"class":192},[86,3641,128],{"class":110},[86,3643,3644,3646,3648,3650,3652,3655,3657,3659],{"class":88,"line":114},[86,3645,2788],{"class":99},[86,3647,2791],{"class":99},[86,3649,2794],{"class":110},[86,3651,211],{"class":99},[86,3653,3654],{"class":110}," ReduxStore, Reducer } ",[86,3656,2802],{"class":99},[86,3658,2805],{"class":192},[86,3660,128],{"class":110},[86,3662,3663,3665,3668,3670,3673],{"class":88,"line":131},[86,3664,2788],{"class":99},[86,3666,3667],{"class":110}," { produce } ",[86,3669,2802],{"class":99},[86,3671,3672],{"class":192}," 'immer'",[86,3674,128],{"class":110},[86,3676,3677,3679,3681,3683,3685],{"class":88,"line":143},[86,3678,2788],{"class":99},[86,3680,2814],{"class":110},[86,3682,2802],{"class":99},[86,3684,2819],{"class":192},[86,3686,128],{"class":110},[86,3688,3689],{"class":88,"line":155},[86,3690,93],{"emptyLinePlaceholder":92},[86,3692,3693,3695,3697,3699,3701,3703,3705,3707,3709,3711,3713,3715,3717,3719,3721,3723,3725,3727,3729,3731,3733],{"class":88,"line":161},[86,3694,100],{"class":99},[86,3696,651],{"class":103},[86,3698,217],{"class":110},[86,3700,656],{"class":103},[86,3702,27],{"class":110},[86,3704,661],{"class":103},[86,3706,107],{"class":99},[86,3708,666],{"class":124},[86,3710,669],{"class":110},[86,3712,305],{"class":99},[86,3714,1381],{"class":110},[86,3716,272],{"class":117},[86,3718,121],{"class":99},[86,3720,684],{"class":103},[86,3722,27],{"class":110},[86,3724,1160],{"class":117},[86,3726,121],{"class":99},[86,3728,1221],{"class":103},[86,3730,284],{"class":110},[86,3732,287],{"class":99},[86,3734,3735],{"class":124}," void\n",[86,3737,3738],{"class":88,"line":166},[86,3739,93],{"emptyLinePlaceholder":92},[86,3741,3742,3744,3746,3748,3750,3752,3754,3756,3758,3760,3762,3764,3766,3768,3770,3772,3774,3776,3778,3780,3782],{"class":88,"line":186},[86,3743,100],{"class":99},[86,3745,718],{"class":103},[86,3747,217],{"class":110},[86,3749,656],{"class":103},[86,3751,27],{"class":110},[86,3753,661],{"class":103},[86,3755,107],{"class":99},[86,3757,666],{"class":124},[86,3759,669],{"class":110},[86,3761,305],{"class":99},[86,3763,1381],{"class":110},[86,3765,272],{"class":117},[86,3767,121],{"class":99},[86,3769,684],{"class":103},[86,3771,27],{"class":110},[86,3773,1160],{"class":117},[86,3775,121],{"class":99},[86,3777,1221],{"class":103},[86,3779,284],{"class":110},[86,3781,287],{"class":99},[86,3783,3735],{"class":124},[86,3785,3786],{"class":88,"line":199},[86,3787,93],{"emptyLinePlaceholder":92},[86,3789,3790,3792,3794,3796,3798,3800,3802,3804,3806,3808,3810,3812,3814,3816,3818,3820,3822,3824],{"class":88,"line":205},[86,3791,100],{"class":99},[86,3793,1497],{"class":103},[86,3795,217],{"class":110},[86,3797,1502],{"class":103},[86,3799,797],{"class":99},[86,3801,125],{"class":124},[86,3803,27],{"class":110},[86,3805,1511],{"class":103},[86,3807,797],{"class":99},[86,3809,125],{"class":124},[86,3811,669],{"class":110},[86,3813,305],{"class":99},[86,3815,1522],{"class":192},[86,3817,1511],{"class":103},[86,3819,1527],{"class":192},[86,3821,1502],{"class":103},[86,3823,1532],{"class":192},[86,3825,128],{"class":110},[86,3827,3828],{"class":88,"line":231},[86,3829,93],{"emptyLinePlaceholder":92},[86,3831,3832,3834,3836],{"class":88,"line":251},[86,3833,100],{"class":99},[86,3835,786],{"class":103},[86,3837,789],{"class":110},[86,3839,3840,3842,3844,3846],{"class":88,"line":257},[86,3841,794],{"class":103},[86,3843,797],{"class":99},[86,3845,125],{"class":124},[86,3847,196],{"class":110},[86,3849,3850,3852,3854,3856,3858,3860,3862,3864],{"class":88,"line":263},[86,3851,806],{"class":103},[86,3853,797],{"class":99},[86,3855,214],{"class":103},[86,3857,217],{"class":110},[86,3859,220],{"class":124},[86,3861,27],{"class":110},[86,3863,819],{"class":124},[86,3865,228],{"class":110},[86,3867,3868,3870,3872,3874,3876,3878,3880,3882,3884,3886],{"class":88,"line":292},[86,3869,826],{"class":103},[86,3871,797],{"class":99},[86,3873,214],{"class":103},[86,3875,217],{"class":110},[86,3877,220],{"class":124},[86,3879,27],{"class":110},[86,3881,839],{"class":103},[86,3883,217],{"class":110},[86,3885,656],{"class":103},[86,3887,846],{"class":110},[86,3889,3890,3892,3894,3896,3898,3900,3902,3904,3906,3908],{"class":88,"line":299},[86,3891,851],{"class":103},[86,3893,797],{"class":99},[86,3895,214],{"class":103},[86,3897,217],{"class":110},[86,3899,220],{"class":124},[86,3901,27],{"class":110},[86,3903,864],{"class":103},[86,3905,217],{"class":110},[86,3907,656],{"class":103},[86,3909,871],{"class":110},[86,3911,3912,3914,3916],{"class":88,"line":311},[86,3913,669],{"class":110},[86,3915,305],{"class":99},[86,3917,111],{"class":110},[86,3919,3920,3922,3924],{"class":88,"line":322},[86,3921,884],{"class":117},[86,3923,121],{"class":99},[86,3925,3926],{"class":103}," Name\n",[86,3928,3929,3931,3933],{"class":88,"line":328},[86,3930,896],{"class":117},[86,3932,121],{"class":99},[86,3934,3935],{"class":103}," Actions\n",[86,3937,3938,3940,3942],{"class":88,"line":353},[86,3939,908],{"class":117},[86,3941,121],{"class":99},[86,3943,3944],{"class":103}," State\n",[86,3946,3947,3949,3951],{"class":88,"line":367},[86,3948,919],{"class":117},[86,3950,121],{"class":99},[86,3952,3953],{"class":103}," Selectors\n",[86,3955,3956],{"class":88,"line":376},[86,3957,158],{"class":110},[86,3959,3960],{"class":88,"line":383},[86,3961,93],{"emptyLinePlaceholder":92},[86,3963,3964,3966,3968,3970,3972],{"class":88,"line":389},[86,3965,169],{"class":99},[86,3967,172],{"class":99},[86,3969,180],{"class":103},[86,3971,107],{"class":99},[86,3973,948],{"class":110},[86,3975,3976,3978,3980,3982],{"class":88,"line":394},[86,3977,794],{"class":103},[86,3979,797],{"class":99},[86,3981,125],{"class":124},[86,3983,196],{"class":110},[86,3985,3986,3988,3990,3992,3994,3996,3998,4000],{"class":88,"line":400},[86,3987,806],{"class":103},[86,3989,797],{"class":99},[86,3991,214],{"class":103},[86,3993,217],{"class":110},[86,3995,220],{"class":124},[86,3997,27],{"class":110},[86,3999,819],{"class":124},[86,4001,228],{"class":110},[86,4003,4004,4006,4008,4010,4012,4014,4016,4018,4020,4022],{"class":88,"line":426},[86,4005,826],{"class":103},[86,4007,797],{"class":99},[86,4009,214],{"class":103},[86,4011,217],{"class":110},[86,4013,220],{"class":124},[86,4015,27],{"class":110},[86,4017,839],{"class":103},[86,4019,217],{"class":110},[86,4021,656],{"class":103},[86,4023,846],{"class":110},[86,4025,4026,4028,4030,4032,4034,4036,4038,4040,4042],{"class":88,"line":432},[86,4027,1605],{"class":103},[86,4029,797],{"class":99},[86,4031,1610],{"class":103},[86,4033,217],{"class":110},[86,4035,1615],{"class":99},[86,4037,901],{"class":103},[86,4039,27],{"class":110},[86,4041,220],{"class":124},[86,4043,228],{"class":110},[86,4045,4046,4048,4050,4052,4054,4056,4058,4060],{"class":88,"line":438},[86,4047,1628],{"class":103},[86,4049,797],{"class":99},[86,4051,1497],{"class":103},[86,4053,217],{"class":110},[86,4055,1466],{"class":103},[86,4057,27],{"class":110},[86,4059,1059],{"class":103},[86,4061,228],{"class":110},[86,4063,4064,4066,4068,4070,4072,4074,4076,4078,4080,4082],{"class":88,"line":443},[86,4065,851],{"class":103},[86,4067,797],{"class":99},[86,4069,214],{"class":103},[86,4071,217],{"class":110},[86,4073,220],{"class":124},[86,4075,27],{"class":110},[86,4077,864],{"class":103},[86,4079,217],{"class":110},[86,4081,656],{"class":103},[86,4083,846],{"class":110},[86,4085,4086,4088,4090,4092,4094,4096,4098,4100,4102,4104],{"class":88,"line":452},[86,4087,1647],{"class":103},[86,4089,797],{"class":99},[86,4091,1652],{"class":103},[86,4093,217],{"class":110},[86,4095,1068],{"class":103},[86,4097,1659],{"class":110},[86,4099,1466],{"class":103},[86,4101,1664],{"class":110},[86,4103,1667],{"class":124},[86,4105,1670],{"class":110},[86,4107,4108,4110,4112,4114,4116,4118,4120,4122,4124,4126,4128],{"class":88,"line":461},[86,4109,1675],{"class":103},[86,4111,797],{"class":99},[86,4113,1680],{"class":110},[86,4115,100],{"class":117},[86,4117,121],{"class":99},[86,4119,1687],{"class":103},[86,4121,27],{"class":110},[86,4123,1160],{"class":117},[86,4125,121],{"class":99},[86,4127,1696],{"class":103},[86,4129,1699],{"class":110},[86,4131,4132],{"class":88,"line":466},[86,4133,1025],{"class":110},[86,4135,4136],{"class":88,"line":472},[86,4137,1030],{"class":110},[86,4139,4140],{"class":88,"line":477},[86,4141,1035],{"class":110},[86,4143,4144],{"class":88,"line":483},[86,4145,1040],{"class":110},[86,4147,4148],{"class":88,"line":488},[86,4149,1045],{"class":110},[86,4151,4152,4154,4156,4158,4160,4162,4164,4166,4168,4170,4172,4174,4176,4178],{"class":88,"line":494},[86,4153,1050],{"class":110},[86,4155,121],{"class":99},[86,4157,786],{"class":103},[86,4159,217],{"class":110},[86,4161,1059],{"class":103},[86,4163,27],{"class":110},[86,4165,656],{"class":103},[86,4167,27],{"class":110},[86,4169,1068],{"class":103},[86,4171,27],{"class":110},[86,4173,1073],{"class":103},[86,4175,1076],{"class":110},[86,4177,287],{"class":99},[86,4179,111],{"class":110},[86,4181,4182,4184,4186,4188,4190,4192,4194,4196,4198],{"class":88,"line":530},[86,4183,1754],{"class":99},[86,4185,1757],{"class":124},[86,4187,107],{"class":99},[86,4189,1762],{"class":110},[86,4191,1765],{"class":103},[86,4193,1768],{"class":110},[86,4195,211],{"class":99},[86,4197,1773],{"class":103},[86,4199,1776],{"class":110},[86,4201,4202,4204,4206,4208,4210,4212,4214,4216,4218,4220,4222,4224],{"class":88,"line":535},[86,4203,1754],{"class":99},[86,4205,1783],{"class":124},[86,4207,107],{"class":99},[86,4209,1788],{"class":110},[86,4211,1791],{"class":103},[86,4213,1794],{"class":110},[86,4215,1797],{"class":117},[86,4217,27],{"class":110},[86,4219,1802],{"class":117},[86,4221,284],{"class":110},[86,4223,287],{"class":99},[86,4225,111],{"class":110},[86,4227,4228,4230,4232,4234,4236,4238,4240,4242,4244,4246,4248],{"class":88,"line":555},[86,4229,1813],{"class":99},[86,4231,1816],{"class":124},[86,4233,107],{"class":99},[86,4235,1522],{"class":192},[86,4237,1823],{"class":110},[86,4239,1527],{"class":192},[86,4241,1802],{"class":110},[86,4243,1532],{"class":192},[86,4245,1832],{"class":99},[86,4247,1687],{"class":103},[86,4249,128],{"class":110},[86,4251,4252,4254,4256],{"class":88,"line":564},[86,4253,1841],{"class":110},[86,4255,305],{"class":99},[86,4257,1846],{"class":110},[86,4259,4260,4262],{"class":88,"line":570},[86,4261,1851],{"class":99},[86,4263,1854],{"class":110},[86,4265,4266,4268,4270,4272,4274,4276,4278,4280],{"class":88,"line":581},[86,4267,1859],{"class":110},[86,4269,211],{"class":99},[86,4271,214],{"class":103},[86,4273,217],{"class":110},[86,4275,1868],{"class":103},[86,4277,27],{"class":110},[86,4279,1466],{"class":103},[86,4281,1875],{"class":110},[86,4283,4284],{"class":88,"line":592},[86,4285,93],{"emptyLinePlaceholder":92},[86,4287,4288,4290,4292,4294,4296,4298,4300,4302,4304,4306,4308,4310,4312,4314,4316],{"class":88,"line":603},[86,4289,1754],{"class":99},[86,4291,1886],{"class":103},[86,4293,107],{"class":99},[86,4295,1381],{"class":110},[86,4297,272],{"class":117},[86,4299,121],{"class":99},[86,4301,684],{"class":103},[86,4303,107],{"class":99},[86,4305,1901],{"class":110},[86,4307,1802],{"class":117},[86,4309,121],{"class":99},[86,4311,1172],{"class":103},[86,4313,284],{"class":110},[86,4315,287],{"class":99},[86,4317,111],{"class":110},[86,4319,4320,4322,4324,4326,4328,4330,4332,4334],{"class":88,"line":614},[86,4321,1813],{"class":99},[86,4323,1920],{"class":124},[86,4325,107],{"class":99},[86,4327,1925],{"class":103},[86,4329,1928],{"class":110},[86,4331,1931],{"class":117},[86,4333,512],{"class":99},[86,4335,111],{"class":110},[86,4337,4338,4340,4342,4344],{"class":88,"line":620},[86,4339,356],{"class":99},[86,4341,1942],{"class":124},[86,4343,107],{"class":99},[86,4345,1947],{"class":110},[86,4347,4348,4350,4352,4354],{"class":88,"line":626},[86,4349,1952],{"class":110},[86,4351,211],{"class":99},[86,4353,684],{"class":103},[86,4355,1959],{"class":110},[86,4357,4359],{"class":88,"line":4358},51,[86,4360,1964],{"class":110},[86,4362,4364,4366],{"class":88,"line":4363},52,[86,4365,1851],{"class":99},[86,4367,1971],{"class":110},[86,4369,4371],{"class":88,"line":4370},53,[86,4372,1140],{"class":110},[86,4374,4376],{"class":88,"line":4375},54,[86,4377,93],{"emptyLinePlaceholder":92},[86,4379,4381,4383,4385,4387,4389,4391,4393,4395,4397,4399,4401,4403],{"class":88,"line":4380},55,[86,4382,1754],{"class":99},[86,4384,1986],{"class":124},[86,4386,107],{"class":99},[86,4388,1788],{"class":110},[86,4390,1791],{"class":103},[86,4392,1794],{"class":110},[86,4394,1797],{"class":117},[86,4396,27],{"class":110},[86,4398,2001],{"class":117},[86,4400,284],{"class":110},[86,4402,287],{"class":99},[86,4404,111],{"class":110},[86,4406,4408,4410,4412,4414,4416,4418,4420],{"class":88,"line":4407},56,[86,4409,2012],{"class":110},[86,4411,305],{"class":99},[86,4413,1381],{"class":110},[86,4415,1160],{"class":117},[86,4417,284],{"class":110},[86,4419,287],{"class":99},[86,4421,111],{"class":110},[86,4423,4425,4427,4429,4431,4433,4435,4437,4439,4441,4443,4445],{"class":88,"line":4424},57,[86,4426,356],{"class":99},[86,4428,1816],{"class":124},[86,4430,107],{"class":99},[86,4432,1522],{"class":192},[86,4434,1823],{"class":110},[86,4436,1527],{"class":192},[86,4438,2001],{"class":110},[86,4440,1532],{"class":192},[86,4442,1832],{"class":99},[86,4444,1687],{"class":103},[86,4446,128],{"class":110},[86,4448,4450],{"class":88,"line":4449},58,[86,4451,93],{"emptyLinePlaceholder":92},[86,4453,4455,4457],{"class":88,"line":4454},59,[86,4456,2057],{"class":99},[86,4458,111],{"class":110},[86,4460,4462],{"class":88,"line":4461},60,[86,4463,2064],{"class":110},[86,4465,4467],{"class":88,"line":4466},61,[86,4468,2069],{"class":110},[86,4470,4472],{"class":88,"line":4471},62,[86,4473,2074],{"class":110},[86,4475,4477],{"class":88,"line":4476},63,[86,4478,2079],{"class":110},[86,4480,4482,4484],{"class":88,"line":4481},64,[86,4483,1851],{"class":99},[86,4485,1854],{"class":110},[86,4487,4489,4491,4493],{"class":88,"line":4488},65,[86,4490,1859],{"class":110},[86,4492,211],{"class":99},[86,4494,111],{"class":110},[86,4496,4498,4500,4502,4504,4506,4508,4510,4512,4514,4516,4518,4520,4522,4524,4526,4528,4530,4532,4534,4536,4538,4540,4543,4545,4547,4549,4551,4553,4555,4557,4559,4561,4563,4565,4567,4569,4571,4573,4575,4577],{"class":88,"line":4497},66,[86,4499,2098],{"class":110},[86,4501,1466],{"class":103},[86,4503,2103],{"class":99},[86,4505,1610],{"class":103},[86,4507,217],{"class":110},[86,4509,1615],{"class":99},[86,4511,901],{"class":103},[86,4513,27],{"class":110},[86,4515,220],{"class":124},[86,4517,2118],{"class":110},[86,4519,121],{"class":99},[86,4521,2902],{"class":110},[86,4523,3294],{"class":103},[86,4525,797],{"class":99},[86,4527,1652],{"class":103},[86,4529,217],{"class":110},[86,4531,1068],{"class":103},[86,4533,1659],{"class":110},[86,4535,1466],{"class":103},[86,4537,1664],{"class":110},[86,4539,1667],{"class":124},[86,4541,4542],{"class":110},"]>(",[86,4544,1160],{"class":117},[86,4546,121],{"class":99},[86,4548,2171],{"class":103},[86,4550,284],{"class":110},[86,4552,287],{"class":99},[86,4554,1680],{"class":110},[86,4556,100],{"class":117},[86,4558,121],{"class":99},[86,4560,1497],{"class":103},[86,4562,217],{"class":110},[86,4564,1466],{"class":103},[86,4566,27],{"class":110},[86,4568,1059],{"class":103},[86,4570,2164],{"class":110},[86,4572,1160],{"class":117},[86,4574,121],{"class":99},[86,4576,2171],{"class":103},[86,4578,2174],{"class":110},[86,4580,4582],{"class":88,"line":4581},67,[86,4583,2179],{"class":110},[86,4585,4587],{"class":88,"line":4586},68,[86,4588,93],{"emptyLinePlaceholder":92},[86,4590,4592,4594],{"class":88,"line":4591},69,[86,4593,1118],{"class":99},[86,4595,111],{"class":110},[86,4597,4599],{"class":88,"line":4598},70,[86,4600,1030],{"class":110},[86,4602,4604],{"class":88,"line":4603},71,[86,4605,1125],{"class":110},[86,4607,4609],{"class":88,"line":4608},72,[86,4610,1135],{"class":110},[86,4612,4614],{"class":88,"line":4613},73,[86,4615,4616],{"class":110},"    selectors: selectors,\n",[86,4618,4620],{"class":88,"line":4619},74,[86,4621,1140],{"class":110},[86,4623,4625],{"class":88,"line":4624},75,[86,4626,931],{"class":110},[86,4628,4630],{"class":88,"line":4629},76,[86,4631,93],{"emptyLinePlaceholder":92},[86,4633,4635,4637,4639,4641,4643,4645,4647,4649,4651,4653,4655,4657,4659,4661,4663],{"class":88,"line":4634},77,[86,4636,100],{"class":99},[86,4638,3042],{"class":103},[86,4640,217],{"class":110},[86,4642,1177],{"class":103},[86,4644,797],{"class":99},[86,4646,125],{"class":124},[86,4648,107],{"class":99},[86,4650,125],{"class":124},[86,4652,27],{"class":110},[86,4654,661],{"class":103},[86,4656,107],{"class":99},[86,4658,731],{"class":124},[86,4660,669],{"class":110},[86,4662,305],{"class":99},[86,4664,111],{"class":110},[86,4666,4668,4670,4672,4674],{"class":88,"line":4667},78,[86,4669,1204],{"class":117},[86,4671,121],{"class":99},[86,4673,1209],{"class":103},[86,4675,196],{"class":110},[86,4677,4679,4681,4683,4685],{"class":88,"line":4678},79,[86,4680,691],{"class":117},[86,4682,121],{"class":99},[86,4684,1221],{"class":103},[86,4686,196],{"class":110},[86,4688,4690],{"class":88,"line":4689},80,[86,4691,158],{"class":110},[86,4693,4695],{"class":88,"line":4694},81,[86,4696,93],{"emptyLinePlaceholder":92},[86,4698,4700,4702,4704,4706,4708,4710,4712,4714,4716,4718,4720,4722,4724,4726,4728,4730,4732],{"class":88,"line":4699},82,[86,4701,100],{"class":99},[86,4703,3103],{"class":103},[86,4705,217],{"class":110},[86,4707,1059],{"class":103},[86,4709,797],{"class":99},[86,4711,125],{"class":124},[86,4713,27],{"class":110},[86,4715,3116],{"class":103},[86,4717,797],{"class":99},[86,4719,3121],{"class":103},[86,4721,217],{"class":110},[86,4723,3126],{"class":124},[86,4725,27],{"class":110},[86,4727,3126],{"class":124},[86,4729,3133],{"class":110},[86,4731,305],{"class":99},[86,4733,111],{"class":110},[86,4735,4737,4739,4741,4743],{"class":88,"line":4736},83,[86,4738,884],{"class":117},[86,4740,121],{"class":99},[86,4742,889],{"class":103},[86,4744,128],{"class":110},[86,4746,4748,4750,4752,4754],{"class":88,"line":4747},84,[86,4749,3152],{"class":117},[86,4751,121],{"class":99},[86,4753,3157],{"class":103},[86,4755,196],{"class":110},[86,4757,4759],{"class":88,"line":4758},85,[86,4760,158],{"class":110},[86,4762,4764],{"class":88,"line":4763},86,[86,4765,93],{"emptyLinePlaceholder":92},[86,4767,4769,4771,4773,4775,4777,4779,4781,4783,4785,4787,4789,4791,4793,4795,4797,4799,4801,4803,4805,4807,4809,4811,4813,4815,4817,4819],{"class":88,"line":4768},87,[86,4770,100],{"class":99},[86,4772,3174],{"class":103},[86,4774,217],{"class":110},[86,4776,3179],{"class":103},[86,4778,669],{"class":110},[86,4780,305],{"class":99},[86,4782,3186],{"class":103},[86,4784,797],{"class":99},[86,4786,1680],{"class":110},[86,4788,1823],{"class":117},[86,4790,121],{"class":99},[86,4792,3200],{"class":99},[86,4794,889],{"class":103},[86,4796,797],{"class":99},[86,4798,125],{"class":124},[86,4800,27],{"class":110},[86,4802,2465],{"class":117},[86,4804,121],{"class":99},[86,4806,3121],{"class":103},[86,4808,217],{"class":110},[86,4810,3219],{"class":99},[86,4812,684],{"class":103},[86,4814,27],{"class":110},[86,4816,3219],{"class":99},[86,4818,1172],{"class":103},[86,4820,3230],{"class":110},[86,4822,4824,4826,4828,4830,4832,4834,4836,4838,4840,4842,4844],{"class":88,"line":4823},88,[86,4825,3235],{"class":99},[86,4827,1172],{"class":103},[86,4829,797],{"class":99},[86,4831,3042],{"class":103},[86,4833,217],{"class":110},[86,4835,3219],{"class":99},[86,4837,1209],{"class":103},[86,4839,27],{"class":110},[86,4841,3219],{"class":99},[86,4843,1221],{"class":103},[86,4845,3256],{"class":110},[86,4847,4849,4851],{"class":88,"line":4848},89,[86,4850,3235],{"class":99},[86,4852,111],{"class":110},[86,4854,4856,4858,4860,4862,4864,4866,4868,4870],{"class":88,"line":4855},90,[86,4857,3267],{"class":117},[86,4859,121],{"class":99},[86,4861,3042],{"class":103},[86,4863,217],{"class":110},[86,4865,1177],{"class":103},[86,4867,27],{"class":110},[86,4869,661],{"class":103},[86,4871,228],{"class":110},[86,4873,4875,4877,4879,4881,4883,4885,4887,4889,4891,4893],{"class":88,"line":4874},91,[86,4876,3286],{"class":117},[86,4878,121],{"class":99},[86,4880,3291],{"class":110},[86,4882,3294],{"class":103},[86,4884,2103],{"class":99},[86,4886,889],{"class":103},[86,4888,3301],{"class":110},[86,4890,121],{"class":99},[86,4892,684],{"class":103},[86,4894,2174],{"class":110},[86,4896,4898,4900,4902,4904,4906],{"class":88,"line":4897},92,[86,4899,3312],{"class":110},[86,4901,121],{"class":99},[86,4903,3317],{"class":124},[86,4905,3320],{"class":99},[86,4907,3323],{"class":124},[86,4909,4911],{"class":88,"line":4910},93,[86,4912,93],{"emptyLinePlaceholder":92},[86,4914,4916,4918,4920,4922,4924],{"class":88,"line":4915},94,[86,4917,169],{"class":99},[86,4919,172],{"class":99},[86,4921,3336],{"class":103},[86,4923,107],{"class":99},[86,4925,948],{"class":110},[86,4927,4929,4931,4933,4935,4937,4939,4941,4943,4945,4947,4949,4951,4953,4955],{"class":88,"line":4928},95,[86,4930,3345],{"class":103},[86,4932,797],{"class":99},[86,4934,3103],{"class":103},[86,4936,217],{"class":110},[86,4938,220],{"class":124},[86,4940,27],{"class":110},[86,4942,3358],{"class":103},[86,4944,217],{"class":110},[86,4946,3126],{"class":124},[86,4948,27],{"class":110},[86,4950,3126],{"class":124},[86,4952,27],{"class":110},[86,4954,3126],{"class":124},[86,4956,846],{"class":110},[86,4958,4960,4962,4964,4966,4968,4970,4972,4974],{"class":88,"line":4959},96,[86,4961,806],{"class":103},[86,4963,797],{"class":99},[86,4965,3174],{"class":103},[86,4967,217],{"class":110},[86,4969,3385],{"class":103},[86,4971,3388],{"class":110},[86,4973,3391],{"class":192},[86,4975,1670],{"class":110},[86,4977,4979,4981,4983,4985,4987,4989,4991,4993],{"class":88,"line":4978},97,[86,4980,1675],{"class":103},[86,4982,797],{"class":99},[86,4984,3174],{"class":103},[86,4986,217],{"class":110},[86,4988,3385],{"class":103},[86,4990,3388],{"class":110},[86,4992,3410],{"class":192},[86,4994,1670],{"class":110},[86,4996,4998,5000,5002,5004,5006,5008,5010],{"class":88,"line":4997},98,[86,4999,2877],{"class":110},[86,5001,3419],{"class":117},[86,5003,121],{"class":99},[86,5005,3424],{"class":103},[86,5007,3427],{"class":110},[86,5009,287],{"class":99},[86,5011,111],{"class":110},[86,5013,5015,5017,5019,5021,5023,5025,5027,5029,5031,5033,5035,5037],{"class":88,"line":5014},99,[86,5016,1754],{"class":99},[86,5018,3438],{"class":124},[86,5020,107],{"class":99},[86,5022,3443],{"class":110},[86,5024,1791],{"class":103},[86,5026,1794],{"class":110},[86,5028,1797],{"class":117},[86,5030,27],{"class":110},[86,5032,3454],{"class":117},[86,5034,284],{"class":110},[86,5036,287],{"class":99},[86,5038,111],{"class":110},[86,5040,5042,5044,5046],{"class":88,"line":5041},100,[86,5043,3465],{"class":110},[86,5045,305],{"class":99},[86,5047,3470],{"class":110},[86,5049,5051,5053],{"class":88,"line":5050},101,[86,5052,1851],{"class":99},[86,5054,1854],{"class":110},[86,5056,5058,5060,5062,5064,5066,5068,5070,5072],{"class":88,"line":5057},102,[86,5059,1859],{"class":110},[86,5061,211],{"class":99},[86,5063,214],{"class":103},[86,5065,217],{"class":110},[86,5067,220],{"class":124},[86,5069,27],{"class":110},[86,5071,3358],{"class":103},[86,5073,1875],{"class":110},[86,5075,5077],{"class":88,"line":5076},103,[86,5078,93],{"emptyLinePlaceholder":92},[86,5080,5082,5084,5086,5088,5090,5092,5094,5096,5098,5100,5102,5104],{"class":88,"line":5081},104,[86,5083,1754],{"class":99},[86,5085,1886],{"class":124},[86,5087,107],{"class":99},[86,5089,3509],{"class":103},[86,5091,3512],{"class":110},[86,5093,211],{"class":99},[86,5095,3121],{"class":103},[86,5097,217],{"class":110},[86,5099,656],{"class":103},[86,5101,27],{"class":110},[86,5103,3525],{"class":103},[86,5105,2981],{"class":110},[86,5107,5109],{"class":88,"line":5108},105,[86,5110,93],{"emptyLinePlaceholder":92},[86,5112,5114,5116,5118,5120,5122],{"class":88,"line":5113},106,[86,5115,1754],{"class":99},[86,5117,3538],{"class":124},[86,5119,107],{"class":99},[86,5121,3543],{"class":103},[86,5123,3546],{"class":110},[86,5125,5127],{"class":88,"line":5126},107,[86,5128,93],{"emptyLinePlaceholder":92},[86,5130,5132,5134],{"class":88,"line":5131},108,[86,5133,1118],{"class":99},[86,5135,111],{"class":110},[86,5137,5139],{"class":88,"line":5138},109,[86,5140,3561],{"class":110},[86,5142,5144],{"class":88,"line":5143},110,[86,5145,1140],{"class":110},[86,5147,5149],{"class":88,"line":5148},111,[86,5150,931],{"class":110},[86,5152,5154],{"class":88,"line":5153},112,[86,5155,93],{"emptyLinePlaceholder":92},[86,5157,5159,5161,5163,5165,5167],{"class":88,"line":5158},113,[86,5160,169],{"class":99},[86,5162,172],{"class":99},[86,5164,2834],{"class":103},[86,5166,107],{"class":99},[86,5168,948],{"class":110},[86,5170,5172,5174,5176,5178],{"class":88,"line":5171},114,[86,5173,2843],{"class":103},[86,5175,797],{"class":99},[86,5177,2848],{"class":103},[86,5179,196],{"class":110},[86,5181,5183,5185,5187,5189,5191,5193,5195,5197],{"class":88,"line":5182},115,[86,5184,806],{"class":103},[86,5186,797],{"class":99},[86,5188,2859],{"class":103},[86,5190,217],{"class":110},[86,5192,2864],{"class":103},[86,5194,1659],{"class":110},[86,5196,2869],{"class":192},[86,5198,2872],{"class":110},[86,5200,5202,5204,5206,5208,5210,5212,5214],{"class":88,"line":5201},116,[86,5203,2877],{"class":110},[86,5205,2880],{"class":117},[86,5207,121],{"class":99},[86,5209,2885],{"class":103},[86,5211,284],{"class":110},[86,5213,287],{"class":99},[86,5215,111],{"class":110},[86,5217,5219,5221,5223,5225,5227,5229,5231,5233,5235,5237,5239,5241,5243,5245,5247,5249,5251,5253,5255,5257],{"class":88,"line":5218},117,[86,5220,1754],{"class":99},[86,5222,504],{"class":103},[86,5224,107],{"class":99},[86,5226,2902],{"class":110},[86,5228,2905],{"class":103},[86,5230,797],{"class":99},[86,5232,1381],{"class":110},[86,5234,272],{"class":117},[86,5236,121],{"class":99},[86,5238,684],{"class":103},[86,5240,284],{"class":110},[86,5242,287],{"class":99},[86,5244,731],{"class":124},[86,5246,2877],{"class":110},[86,5248,2926],{"class":117},[86,5250,121],{"class":99},[86,5252,2931],{"class":103},[86,5254,284],{"class":110},[86,5256,287],{"class":99},[86,5258,111],{"class":110},[86,5260,5262,5264,5266],{"class":88,"line":5261},118,[86,5263,1851],{"class":99},[86,5265,2944],{"class":103},[86,5267,561],{"class":110},[86,5269,5271],{"class":88,"line":5270},119,[86,5272,2951],{"class":110},[86,5274,5276],{"class":88,"line":5275},120,[86,5277,2956],{"class":110},[86,5279,5281],{"class":88,"line":5280},121,[86,5282,2956],{"class":110},[86,5284,5286],{"class":88,"line":5285},122,[86,5287,2965],{"class":110},[86,5289,5291,5293,5295,5297,5299,5301],{"class":88,"line":5290},123,[86,5292,2970],{"class":110},[86,5294,211],{"class":99},[86,5296,2859],{"class":103},[86,5298,217],{"class":110},[86,5300,2905],{"class":103},[86,5302,2981],{"class":110},[86,5304,5306],{"class":88,"line":5305},124,[86,5307,1140],{"class":110},[86,5309,5311],{"class":88,"line":5310},125,[86,5312,93],{"emptyLinePlaceholder":92},[86,5314,5316,5318],{"class":88,"line":5315},126,[86,5317,1118],{"class":99},[86,5319,2996],{"class":110},[86,5321,5323],{"class":88,"line":5322},127,[86,5324,931],{"class":110},[76,5326,5329],{"className":78,"code":5327,"filename":5328,"language":81,"meta":82,"style":82},"import { createSlice } from \"@/myReduxToolkit\";\n\ntype User = {\n  id: string;\n  username: string;\n  displayName: string;\n}\n\nexport const usersSlice = createSlice({\n  name: 'users',\n  defaultState: {\n    userById: {} as Record\u003Cstring, User>,\n    usernameById: {} as Record\u003Cstring, string>,\n  },\n  actions: {\n    addUser: (state, user: User) => {\n      state.userById[user.id] = user;\n      state.usernameById[user.username] = user.id;\n    },\n    deleteUser: (state, userId: string) => {\n      const user = state.userById[userId];\n      delete state.usernameById[user.username];\n      delete state.userById[userId];\n    }\n  },\n  selectors: {\n    selectUserByUsername: (state, username: string) => state.userById[state.usernameById[username]],\n    selectAllUsers: (state) => Object.values(state.userById),\n  }\n});\n\n","store/users/slice.ts",[20,5330,5331,5345,5349,5359,5369,5379,5389,5393,5397,5411,5419,5423,5441,5459,5463,5467,5489,5497,5505,5509,5531,5541,5547,5553,5557,5561,5565,5587,5608,5612],{"__ignoreMap":82},[86,5332,5333,5335,5338,5340,5343],{"class":88,"line":89},[86,5334,2788],{"class":99},[86,5336,5337],{"class":110}," { createSlice } ",[86,5339,2802],{"class":99},[86,5341,5342],{"class":192}," \"@/myReduxToolkit\"",[86,5344,128],{"class":110},[86,5346,5347],{"class":88,"line":96},[86,5348,93],{"emptyLinePlaceholder":92},[86,5350,5351,5353,5355,5357],{"class":88,"line":114},[86,5352,100],{"class":99},[86,5354,104],{"class":103},[86,5356,107],{"class":99},[86,5358,111],{"class":110},[86,5360,5361,5363,5365,5367],{"class":88,"line":131},[86,5362,118],{"class":117},[86,5364,121],{"class":99},[86,5366,125],{"class":124},[86,5368,128],{"class":110},[86,5370,5371,5373,5375,5377],{"class":88,"line":143},[86,5372,134],{"class":117},[86,5374,121],{"class":99},[86,5376,125],{"class":124},[86,5378,128],{"class":110},[86,5380,5381,5383,5385,5387],{"class":88,"line":155},[86,5382,146],{"class":117},[86,5384,121],{"class":99},[86,5386,125],{"class":124},[86,5388,128],{"class":110},[86,5390,5391],{"class":88,"line":161},[86,5392,158],{"class":110},[86,5394,5395],{"class":88,"line":166},[86,5396,93],{"emptyLinePlaceholder":92},[86,5398,5399,5401,5403,5405,5407,5409],{"class":88,"line":186},[86,5400,169],{"class":99},[86,5402,172],{"class":99},[86,5404,175],{"class":124},[86,5406,107],{"class":99},[86,5408,180],{"class":103},[86,5410,183],{"class":110},[86,5412,5413,5415,5417],{"class":88,"line":199},[86,5414,189],{"class":110},[86,5416,193],{"class":192},[86,5418,196],{"class":110},[86,5420,5421],{"class":88,"line":205},[86,5422,202],{"class":110},[86,5424,5425,5427,5429,5431,5433,5435,5437,5439],{"class":88,"line":231},[86,5426,208],{"class":110},[86,5428,211],{"class":99},[86,5430,214],{"class":103},[86,5432,217],{"class":110},[86,5434,220],{"class":124},[86,5436,27],{"class":110},[86,5438,225],{"class":103},[86,5440,228],{"class":110},[86,5442,5443,5445,5447,5449,5451,5453,5455,5457],{"class":88,"line":251},[86,5444,234],{"class":110},[86,5446,211],{"class":99},[86,5448,214],{"class":103},[86,5450,217],{"class":110},[86,5452,220],{"class":124},[86,5454,27],{"class":110},[86,5456,220],{"class":124},[86,5458,228],{"class":110},[86,5460,5461],{"class":88,"line":257},[86,5462,254],{"class":110},[86,5464,5465],{"class":88,"line":263},[86,5466,260],{"class":110},[86,5468,5469,5471,5473,5475,5477,5479,5481,5483,5485,5487],{"class":88,"line":292},[86,5470,266],{"class":103},[86,5472,269],{"class":110},[86,5474,272],{"class":117},[86,5476,27],{"class":110},[86,5478,277],{"class":117},[86,5480,121],{"class":99},[86,5482,104],{"class":103},[86,5484,284],{"class":110},[86,5486,287],{"class":99},[86,5488,111],{"class":110},[86,5490,5491,5493,5495],{"class":88,"line":299},[86,5492,302],{"class":110},[86,5494,305],{"class":99},[86,5496,308],{"class":110},[86,5498,5499,5501,5503],{"class":88,"line":311},[86,5500,314],{"class":110},[86,5502,305],{"class":99},[86,5504,319],{"class":110},[86,5506,5507],{"class":88,"line":322},[86,5508,325],{"class":110},[86,5510,5511,5513,5515,5517,5519,5521,5523,5525,5527,5529],{"class":88,"line":328},[86,5512,331],{"class":103},[86,5514,269],{"class":110},[86,5516,272],{"class":117},[86,5518,27],{"class":110},[86,5520,340],{"class":117},[86,5522,121],{"class":99},[86,5524,125],{"class":124},[86,5526,284],{"class":110},[86,5528,287],{"class":99},[86,5530,111],{"class":110},[86,5532,5533,5535,5537,5539],{"class":88,"line":353},[86,5534,356],{"class":99},[86,5536,359],{"class":124},[86,5538,107],{"class":99},[86,5540,364],{"class":110},[86,5542,5543,5545],{"class":88,"line":367},[86,5544,370],{"class":99},[86,5546,373],{"class":110},[86,5548,5549,5551],{"class":88,"line":376},[86,5550,370],{"class":99},[86,5552,364],{"class":110},[86,5554,5555],{"class":88,"line":383},[86,5556,386],{"class":110},[86,5558,5559],{"class":88,"line":389},[86,5560,254],{"class":110},[86,5562,5563],{"class":88,"line":394},[86,5564,397],{"class":110},[86,5566,5567,5569,5571,5573,5575,5577,5579,5581,5583,5585],{"class":88,"line":400},[86,5568,403],{"class":103},[86,5570,269],{"class":110},[86,5572,272],{"class":117},[86,5574,27],{"class":110},[86,5576,412],{"class":117},[86,5578,121],{"class":99},[86,5580,125],{"class":124},[86,5582,284],{"class":110},[86,5584,287],{"class":99},[86,5586,423],{"class":110},[86,5588,5589,5592,5594,5596,5598,5600,5602,5605],{"class":88,"line":426},[86,5590,5591],{"class":103},"    selectAllUsers",[86,5593,269],{"class":110},[86,5595,272],{"class":117},[86,5597,284],{"class":110},[86,5599,287],{"class":99},[86,5601,1762],{"class":110},[86,5603,5604],{"class":103},"values",[86,5606,5607],{"class":110},"(state.userById),\n",[86,5609,5610],{"class":88,"line":432},[86,5611,429],{"class":110},[86,5613,5614],{"class":88,"line":438},[86,5615,435],{"class":110},[76,5617,5620],{"className":78,"code":5618,"filename":5619,"language":81,"meta":82,"style":82},"import { configureStore, createUseSelector } from '@/myReduxToolkit';\nimport { usersSlice } from './users/slice';\n\nexport const { store } = configureStore([usersSlice]);\n\nexport const useSelector = createUseSelector(store);\n\n","store/index.ts",[20,5621,5622,5636,5650,5654,5674,5678],{"__ignoreMap":82},[86,5623,5624,5626,5629,5631,5634],{"class":88,"line":89},[86,5625,2788],{"class":99},[86,5627,5628],{"class":110}," { configureStore, createUseSelector } ",[86,5630,2802],{"class":99},[86,5632,5633],{"class":192}," '@/myReduxToolkit'",[86,5635,128],{"class":110},[86,5637,5638,5640,5643,5645,5648],{"class":88,"line":96},[86,5639,2788],{"class":99},[86,5641,5642],{"class":110}," { usersSlice } ",[86,5644,2802],{"class":99},[86,5646,5647],{"class":192}," './users/slice'",[86,5649,128],{"class":110},[86,5651,5652],{"class":88,"line":114},[86,5653,93],{"emptyLinePlaceholder":92},[86,5655,5656,5658,5660,5662,5664,5667,5669,5671],{"class":88,"line":131},[86,5657,169],{"class":99},[86,5659,172],{"class":99},[86,5661,1680],{"class":110},[86,5663,2880],{"class":124},[86,5665,5666],{"class":110}," } ",[86,5668,305],{"class":99},[86,5670,3336],{"class":103},[86,5672,5673],{"class":110},"([usersSlice]);\n",[86,5675,5676],{"class":88,"line":143},[86,5677,93],{"emptyLinePlaceholder":92},[86,5679,5680,5682,5684,5686,5688,5690],{"class":88,"line":155},[86,5681,169],{"class":99},[86,5683,172],{"class":99},[86,5685,504],{"class":124},[86,5687,107],{"class":99},[86,5689,2834],{"class":103},[86,5691,5692],{"class":110},"(store);\n",[76,5694,5699],{"className":5695,"code":5696,"filename":5697,"language":5698,"meta":82,"style":82},"language-tsx shiki shiki-themes github-light github-dark","const Test = () => {\n  const allUsers = useSelector(state => usersSlice.selectors.selectAllUsers(state.users));\n\n  console.log({\n    allUsers\n  });\n\n  return \u003Cdiv>\n    \u003Cbutton onClick={() => {\n      console.log(usersSlice.actions);\n      store.dispatch(usersSlice.actions.addUser({\n        displayName: String(Math.random()),\n        id: String(Math.random()),\n        username: String(Math.random()),\n      }));\n      console.log(store.getState());\n    }}>Add new user\u003C/button>\n\n    {allUsers.map((user) => \u003Cdiv key={user.username}>\n      \u003Cp>{user.displayName}\u003C/p>\n      \u003Cp>@{user.username}\u003C/p>\n    \u003C/div>)}\n  \u003C/div>;\n};\n","components/SomeComponent.tsx","tsx",[20,5700,5701,5716,5742,5746,5756,5761,5765,5769,5781,5801,5811,5826,5842,5855,5868,5873,5888,5897,5901,5929,5943,5956,5966,5975],{"__ignoreMap":82},[86,5702,5703,5705,5708,5710,5712,5714],{"class":88,"line":89},[86,5704,497],{"class":99},[86,5706,5707],{"class":103}," Test",[86,5709,107],{"class":99},[86,5711,2670],{"class":110},[86,5713,287],{"class":99},[86,5715,111],{"class":110},[86,5717,5718,5720,5723,5725,5727,5729,5731,5733,5736,5739],{"class":88,"line":96},[86,5719,1754],{"class":99},[86,5721,5722],{"class":124}," allUsers",[86,5724,107],{"class":99},[86,5726,504],{"class":103},[86,5728,507],{"class":110},[86,5730,272],{"class":117},[86,5732,512],{"class":99},[86,5734,5735],{"class":110}," usersSlice.selectors.",[86,5737,5738],{"class":103},"selectAllUsers",[86,5740,5741],{"class":110},"(state.users));\n",[86,5743,5744],{"class":88,"line":114},[86,5745,93],{"emptyLinePlaceholder":92},[86,5747,5748,5751,5754],{"class":88,"line":131},[86,5749,5750],{"class":110},"  console.",[86,5752,5753],{"class":103},"log",[86,5755,183],{"class":110},[86,5757,5758],{"class":88,"line":143},[86,5759,5760],{"class":110},"    allUsers\n",[86,5762,5763],{"class":88,"line":155},[86,5764,2179],{"class":110},[86,5766,5767],{"class":88,"line":161},[86,5768,93],{"emptyLinePlaceholder":92},[86,5770,5771,5773,5775,5779],{"class":88,"line":166},[86,5772,1118],{"class":99},[86,5774,2902],{"class":110},[86,5776,5778],{"class":5777},"s9eBZ","div",[86,5780,3256],{"class":110},[86,5782,5783,5786,5789,5792,5794,5797,5799],{"class":88,"line":186},[86,5784,5785],{"class":110},"    \u003C",[86,5787,5788],{"class":5777},"button",[86,5790,5791],{"class":103}," onClick",[86,5793,305],{"class":99},[86,5795,5796],{"class":110},"{() ",[86,5798,287],{"class":99},[86,5800,111],{"class":110},[86,5802,5803,5806,5808],{"class":88,"line":199},[86,5804,5805],{"class":110},"      console.",[86,5807,5753],{"class":103},[86,5809,5810],{"class":110},"(usersSlice.actions);\n",[86,5812,5813,5816,5819,5822,5824],{"class":88,"line":205},[86,5814,5815],{"class":110},"      store.",[86,5817,5818],{"class":103},"dispatch",[86,5820,5821],{"class":110},"(usersSlice.actions.",[86,5823,576],{"class":103},[86,5825,183],{"class":110},[86,5827,5828,5831,5833,5836,5839],{"class":88,"line":231},[86,5829,5830],{"class":110},"        displayName: ",[86,5832,1502],{"class":103},[86,5834,5835],{"class":110},"(Math.",[86,5837,5838],{"class":103},"random",[86,5840,5841],{"class":110},"()),\n",[86,5843,5844,5847,5849,5851,5853],{"class":88,"line":251},[86,5845,5846],{"class":110},"        id: ",[86,5848,1502],{"class":103},[86,5850,5835],{"class":110},[86,5852,5838],{"class":103},[86,5854,5841],{"class":110},[86,5856,5857,5860,5862,5864,5866],{"class":88,"line":257},[86,5858,5859],{"class":110},"        username: ",[86,5861,1502],{"class":103},[86,5863,5835],{"class":110},[86,5865,5838],{"class":103},[86,5867,5841],{"class":110},[86,5869,5870],{"class":88,"line":263},[86,5871,5872],{"class":110},"      }));\n",[86,5874,5875,5877,5879,5882,5885],{"class":88,"line":292},[86,5876,5805],{"class":110},[86,5878,5753],{"class":103},[86,5880,5881],{"class":110},"(store.",[86,5883,5884],{"class":103},"getState",[86,5886,5887],{"class":110},"());\n",[86,5889,5890,5893,5895],{"class":88,"line":299},[86,5891,5892],{"class":110},"    }}>Add new user\u003C/",[86,5894,5788],{"class":5777},[86,5896,3256],{"class":110},[86,5898,5899],{"class":88,"line":311},[86,5900,93],{"emptyLinePlaceholder":92},[86,5902,5903,5906,5909,5911,5913,5915,5917,5919,5921,5924,5926],{"class":88,"line":322},[86,5904,5905],{"class":110},"    {allUsers.",[86,5907,5908],{"class":103},"map",[86,5910,1794],{"class":110},[86,5912,277],{"class":117},[86,5914,284],{"class":110},[86,5916,287],{"class":99},[86,5918,2902],{"class":110},[86,5920,5778],{"class":5777},[86,5922,5923],{"class":103}," key",[86,5925,305],{"class":99},[86,5927,5928],{"class":110},"{user.username}>\n",[86,5930,5931,5934,5936,5939,5941],{"class":88,"line":328},[86,5932,5933],{"class":110},"      \u003C",[86,5935,16],{"class":5777},[86,5937,5938],{"class":110},">{user.displayName}\u003C/",[86,5940,16],{"class":5777},[86,5942,3256],{"class":110},[86,5944,5945,5947,5949,5952,5954],{"class":88,"line":353},[86,5946,5933],{"class":110},[86,5948,16],{"class":5777},[86,5950,5951],{"class":110},">@{user.username}\u003C/",[86,5953,16],{"class":5777},[86,5955,3256],{"class":110},[86,5957,5958,5961,5963],{"class":88,"line":367},[86,5959,5960],{"class":110},"    \u003C/",[86,5962,5778],{"class":5777},[86,5964,5965],{"class":110},">)}\n",[86,5967,5968,5971,5973],{"class":88,"line":376},[86,5969,5970],{"class":110},"  \u003C/",[86,5972,5778],{"class":5777},[86,5974,2981],{"class":110},[86,5976,5977],{"class":88,"line":383},[86,5978,931],{"class":110},[5980,5981,5982],"style",{},"html pre.shiki code .szBVR, html code.shiki .szBVR{--shiki-default:#D73A49;--shiki-dark:#F97583}html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sVt8B, html code.shiki .sVt8B{--shiki-default:#24292E;--shiki-dark:#E1E4E8}html pre.shiki code .s4XuR, html code.shiki .s4XuR{--shiki-default:#E36209;--shiki-dark:#FFAB70}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html pre.shiki code .sJ8bj, html code.shiki .sJ8bj{--shiki-default:#6A737D;--shiki-dark:#6A737D}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .s9eBZ, html code.shiki .s9eBZ{--shiki-default:#22863A;--shiki-dark:#85E89D}",{"title":82,"searchDepth":96,"depth":96,"links":5984},[5985,5986,5987,5988,5989,5990,5991,5992],{"id":13,"depth":96,"text":14},{"id":70,"depth":96,"text":71},{"id":632,"depth":96,"text":633},{"id":1150,"depth":96,"text":1151},{"id":2465,"depth":96,"text":2466},{"id":2635,"depth":96,"text":2636},{"id":3003,"depth":96,"text":3004},{"id":3617,"depth":96,"text":3618},"2024-02-12","Как работает @reduxjs/toolkit, реализация его упрощенной версии","md",{},"/blog/implementing-own-redux-toolkit","/images/own-redux-preview.webp",{"title":6,"description":5994},"blog/implementing-own-redux-toolkit",[6002,6003,6004,6005],"react","redux","typescript","state-manager","OkJLGUCANe-AwCcFZCoF38kZekYrjpczJ8LxZZaSDu8",1751114697170]